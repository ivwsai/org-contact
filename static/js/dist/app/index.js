function excelToJson(a){alert(a)}function excelToJsonStart(a){alert(a)}function excelToJsonError(a){alert(a)}function excelGetParam(){return _excelGetParam||"0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20"}function ControlVersion(){var a,b;try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),a=b.GetVariable("$version")}catch(c){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),a="WIN 6,0,21,0",b.AllowScriptAccess="always",a=b.GetVariable("$version")}catch(c){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),a=b.GetVariable("$version")}catch(c){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),a="WIN 3,0,18,0"}catch(c){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),a="WIN 2,0,0,11"}catch(c){a=-1}return a}function GetSwfVer(){var a=-1;if(null!=navigator.plugins&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var b=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",c=navigator.plugins["Shockwave Flash"+b].description,d=c.split(" "),e=d[2].split("."),f=e[0],g=e[1],h=d[3];""==h&&(h=d[4]),"d"==h[0]?h=h.substring(1):"r"==h[0]&&(h=h.substring(1),h.indexOf("d")>0&&(h=h.substring(0,h.indexOf("d"))));var a=f+"."+g+"."+h}}else-1!=navigator.userAgent.toLowerCase().indexOf("webtv/2.6")?a=4:-1!=navigator.userAgent.toLowerCase().indexOf("webtv/2.5")?a=3:-1!=navigator.userAgent.toLowerCase().indexOf("webtv")?a=2:isIE&&isWin&&!isOpera&&(a=ControlVersion());return a}function DetectFlashVer(a,b,c){if(versionStr=GetSwfVer(),-1==versionStr)return!1;if(0!=versionStr){isIE&&isWin&&!isOpera?(tempArray=versionStr.split(" "),tempString=tempArray[1],versionArray=tempString.split(",")):versionArray=versionStr.split(".");var d=versionArray[0],e=versionArray[1],f=versionArray[2];if(d>parseFloat(a))return!0;if(d==parseFloat(a)){if(e>parseFloat(b))return!0;if(e==parseFloat(b)&&f>=parseFloat(c))return!0}return!1}}function AC_AddExtension(a,b){return-1!=a.indexOf("?")?a.replace(/\?/,b+"?"):a+b}function AC_Generateobj(a,b,c,d){var e="";if(isIE&&isWin&&!isOpera){e+="<object ";for(var f in a)e+=f+'="'+a[f]+'" ';e+=">";for(var f in b)e+='<param name="'+f+'" value="'+b[f]+'" /> ';e+="</object>"}else{e+="<embed ";for(var f in c)e+=f+'="'+c[f]+'" ';e+="> </embed>"}d?document.getElementById(d).innerHTML=e:document.write(e)}function AC_FL_RunContent(){var a=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(a.objAttrs,a.params,a.embedAttrs,a.container)}function AC_GetArgs(a,b,c,d,e){var f=new Object;f.embedAttrs=new Object,f.params=new Object,f.objAttrs=new Object;for(var g=0;g<a.length;g+=2){var h=a[g].toLowerCase();switch(h){case"classid":break;case"pluginspage":f.embedAttrs[a[g]]=a[g+1];break;case"src":case"movie":a[g+1]=AC_AddExtension(a[g+1],b),f.embedAttrs.src=a[g+1],f.params[c]=a[g+1];break;case"container":f.container=a[g+1];case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":f.objAttrs[a[g]]=a[g+1];break;case"id":case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":f.embedAttrs[a[g]]=f.objAttrs[a[g]]=a[g+1];break;default:f.embedAttrs[a[g]]=f.params[a[g]]=a[g+1]}}return f.objAttrs.classid=d,e&&(f.embedAttrs.type=e),f}define("dist/app/index",["$","./show-info","./common/controller","./common/ajax","./common/_ajax","../lib/util/event","../lib/util/json","./common/dialog/singleton","../lib/cmp/dialog/confirm-box","../lib/cmp/dialog/dialog","../lib/cmp/overlay","../lib/util/dom/position","../lib/util/bom/browser","../lib/util/dom/iframe-shim","../lib/cmp/widget","../lib/util/base","../lib/util/class","../lib/util/aspect","../lib/util/attribute","../lib/cmp/daparser","../lib/cmp/auto-render","../lib/cmp/mask","../lib/util/dom/sticky","../lib/util/dom/scroll","../lib/util/dom/wheel","../lib/cmp/dialog/tpl/dialog","../lib/cmp/dialog/tpl/button","../lib/cmp/tree/ztree/ztree","./get-staff","./page","./common/pagenation","../lib/cmp/pagination/pagination","../lib/util/ajax","./tpl/staff-list","./ctrl-table","./operate-tree","./tpl/operate-tree","./common/action/action","../lib/util/dom/action","../lib/util/dom/placeholder","../lib/util/dom/inputor","../lib/util/timer","./common/dialog/add-node","./common/dialog/tpl/add","./common/dialog/counselor","./common/dialog/tpl/search","./common/dialog/edit-node","./common/dialog/tpl/edit","./common/dialog/del-node","./common/dialog/add-staff","../lib/util/date","../lib/cmp/calendar/calendar","../lib/cmp/calendar/date-panel","../lib/cmp/calendar/month-panel","../lib/cmp/calendar/year-panel","../lib/cmp/calendar/time-panel","../lib/cmp/calendar/tpl/time","../lib/cmp/calendar/tpl/calendar","../lib/cmp/calendar/tpl/bar","./common/dialog/tpl/add-staff","./common/dialog/checker","../lib/cmp/validator/validator","../lib/cmp/validator/core","../lib/cmp/validator/async","../lib/cmp/validator/utils","../lib/cmp/validator/rule","../lib/cmp/validator/item","./common/dialog/idcard-done","./common/fresh","./common/dialog/edit-staff","./common/dialog/tpl/edit-staff","./common/dialog/tpl/select-dept","./common/dialog/tpl/reset-pwd","./common/dialog/del-staff","./common/dialog/xls-import","./common/dialog/tpl/ag_empl_import2","./import/excelToJson","./import/import","./common/dialog/tpl/import-list","./common/dialog/xls-outport","./common/dialog/tpl/xls-outport","./search","./common/dialog/set-pwd","./common/dialog/tpl/set-pwd"],function(a){var b=a("$"),c=a("./show-info"),d=a("../lib/util/dom/placeholder");a("./common/dialog/add-node"),a("./common/dialog/edit-node"),a("./common/dialog/del-node"),a("./common/dialog/add-staff"),a("./common/dialog/edit-staff"),a("./common/dialog/del-staff"),a("./common/dialog/xls-import"),a("./common/dialog/xls-outport"),a("./search"),a("./common/dialog/set-pwd"),b(".person_msg").html(Global.unitname),c.init(),d.render()}),define("dist/app/show-info",["$","./common/controller","./common/ajax","./common/_ajax","../lib/util/event","../lib/util/json","./common/dialog/singleton","../lib/cmp/dialog/confirm-box","../lib/cmp/dialog/dialog","../lib/cmp/overlay","../lib/util/dom/position","../lib/util/bom/browser","../lib/util/dom/iframe-shim","../lib/cmp/widget","../lib/util/base","../lib/util/class","../lib/util/aspect","../lib/util/attribute","../lib/cmp/daparser","../lib/cmp/auto-render","../lib/cmp/mask","../lib/util/dom/sticky","../lib/util/dom/scroll","../lib/util/dom/wheel","../lib/cmp/dialog/tpl/dialog","../lib/cmp/dialog/tpl/button","../lib/cmp/tree/ztree/ztree","./get-staff","./page","./common/pagenation","../lib/cmp/pagination/pagination","../lib/util/ajax","./tpl/staff-list","./ctrl-table","./operate-tree","./tpl/operate-tree","./common/action/action","../lib/util/dom/action"],function(a,b,c){var d=a("$"),e=a("./common/controller");a("../lib/cmp/tree/ztree/ztree");var f=a("./get-staff"),g=a("./operate-tree"),h=a("./common/action/action"),i=[],j={init:function(){e.orgManager.getDepts(function(a){function b(a,b,c){var d=c.getParentNode();if(d&&d.dropInner===!1)return!1;for(var e=0,f=s.length;f>e;e++){var g=s[e].getParentNode();if(g&&g!==c.getParentNode()&&g.childOuter===!1)return!1}return!0}function c(a,b,c){if(c&&c.dropInner===!1)return!1;for(var d=0,e=s.length;e>d;d++){if(!c&&s[d].dropRoot===!1)return!1;if(s[d].parentTId&&s[d].getParentNode()!==c&&s[d].getParentNode().childOuter===!1)return!1}return!0}function i(a,b,c){var d=c.getParentNode();if(d&&d.dropInner===!1)return!1;for(var e=0,f=s.length;f>e;e++){var g=s[e].getParentNode();if(g&&g!==c.getParentNode()&&g.childOuter===!1)return!1}return!0}function k(a,b){v="dark"===v?"":"dark",q("[ "+r()+" beforeDrag ]&nbsp;&nbsp;&nbsp;&nbsp; drag: "+b.length+" nodes.");for(var c=0,d=b.length;d>c;c++){if(b[c].drag===!1)return s=null,!1;if(b[c].parentTId&&b[c].getParentNode().childDrag===!1)return s=null,!1}return s=b,!0}function l(a,b){return t=b,!0}function m(a,b,c,d,e){return v="dark"===v?"":"dark",q("[ "+r()+" beforeDrop ]&nbsp;&nbsp;&nbsp;&nbsp; moveType:"+d),q("target: "+(c?c.name:"root")+"  -- is "+(null==e?"cancel":e?"copy":"move")),!0}function n(a,b,c){v="dark"===v?"":"dark",q("[ "+r()+" onDrag ]&nbsp;&nbsp;&nbsp;&nbsp; drag: "+c.length+" nodes.")}function o(a,b,c,f,g,h){if(v="dark"===v?"":"dark",q("[ "+r()+" onDrop ]&nbsp;&nbsp;&nbsp;&nbsp; moveType:"+g),q("target: "+(f?f.name:"root")+"  -- is "+(null==h?"cancel":h?"copy":"move")),null!==h){q("[ "+r()+" onDrop ]&nbsp;&nbsp;&nbsp;&nbsp;pid="+f.id+",pid="+c[0].id),d.fn.zTree.consts.move.TYPE_PREV===g?c[0].seq=f.seq-1<0?0:f.seq:d.fn.zTree.consts.move.TYPE_NEXT===g&&(c[0].seq=f.seq+1);var i={dept_id:c[0].id,parent_id:+c[0].pId,seq:c[0].seq};e.orgManager.edit(i)}}function p(a,b,c){c===t&&(v="dark"===v?"":"dark",q("[ "+r()+" onExpand ]&nbsp;&nbsp;&nbsp;&nbsp;"+c.name))}function q(){}function r(){var a=new Date,b=a.getHours(),c=a.getMinutes(),d=a.getSeconds(),e=a.getMilliseconds();return b+":"+c+":"+d+" "+e}var s,t,u={edit:{drag:{autoExpandTrigger:!0,prev:b,inner:c,next:i},enable:!0,showRemoveBtn:!1,showRenameBtn:!1},data:{simpleData:{enable:!0}},callback:{beforeDrag:k,beforeDrop:m,beforeDragOpen:l,onDrag:n,onDrop:o,onExpand:p}},v="dark",w=j.mapData(a);w[0]&&(w[0].open=!0),Global.treeObj=d.fn.zTree.init(d("#classTree"),u,w),d("#companyName").addClass("curSelected"),f.staffList(d("#companyName"),-1),g.init(),h.treeStyle(d("#classTree a"))})},mapData:function(a){for(var b=0;b<a.length;b++){var c={};c.id=a[b].dept_id,c.pId=a[b].parent_id,c.name=a[b].name,c.seq=a[b].seq,i.push(c),a[b].sub&&arguments.callee(a[b].sub)}return i}};c.exports=j}),define("dist/app/common/controller",["./ajax","./_ajax","../../lib/util/event","$","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button"],function(a,b,c){function d(a,b,c,d){return e({url:a,method:b,data:d}).done(function(a){c&&c(a)}).error(function(a){return this.on("error",a),this})}var e=a("./ajax"),f={orgManager:{getDepts:function(a){var b="/dept/all";return d(b,"GET",a)},getStaffList:function(a,b){var c="/staff/list?getsub=1&dept_id="+a;return d(c,"GET",b)},add:function(a,b){var c="/dept/add";return d(c,"POST",b,a)},del:function(a,b){var c="/dept/delete";return d(c,"POST",b,a)},edit:function(a,b){var c="/dept/edit";return d(c,"POST",b,a)},getSingleInfo:function(a,b){var c="/staff/info?user_id="+a;return d(c,"GET",b)},deptInfo:function(a,b){var c="/dept/info?dept_id="+a;return d(c,"GET",b)}},staff:{add:function(a,b){var c="/staff/add";return d(c,"POST",b,a)},del:function(a,b){var c="/staff/delete";return d(c,"POST",b,a)},edit:function(a,b){var c="/staff/edit";return d(c,"POST",b,a)},search:function(a,b){var c="/staff/list?search="+a;return d(c,"GET",b)},resetPwd:function(a,b){var c="/staff/resetpwd";return d(c,"POST",b,a)},setPwd:function(a,b){var c="/staff/setpwd";return d(c,"POST",b,a)},setStaffPwd:function(a,b){var c="/staff/setInitialpwd";return d(c,"POST",b,a)}}};c.exports=f}),define("dist/app/common/ajax",["./_ajax","../../lib/util/event","$","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button"],function(a,b,c){function d(a,b){var c=h.extend({},i);if(a instanceof Array){var d=f.stringify(a);c=h.extend(c,{method:"POST",url:"/adapter/m",data:d});var g=h.map(a,function(a,b){return b=h.extend(b,i),e(b,!0)}),j=e(h.extend(c,{success:function(a,b,c){return this.trigger("done",a,b,c),this}}));return j.on("done",function(a){h.each(g,function(b,c){c.success(a[b])})}),g}c=h.extend(c,a),a.method&&"GET"===a.method.toUpperCase()?c.method="GET":(c.method="POST","DELETE"===a.method.toUpperCase()&&(a.data=a.data||{},a.data.method="delete"),c.data=f.stringify(a.data),c.contentType="application/json; charset=UTF-8");var k=a.url;return h.isFunction(k)&&(k=k()),c.url=Global.req_url+k,e(c,b)}var e=a("./_ajax"),f=a("../../lib/util/json"),g=a("./dialog/singleton"),h=a("$"),i={success:function(a,b,c){return this.trigger("done",a,b,c),this},error:function(a,b,c){return a.status<500?this.trigger("params-error",a,b,c):this.trigger("fail",a,b,c),this},dataType:"json",defaults:{"not-allowed":function(a){g.show({title:"请求非法",content:a&&a.data&&a.data.msg||"请求非法",buttons:[{text:"确定",action:"redirect",className:"btn"}],className:"commonDialog",hasMask:{hideOnClick:!0}}).on("redirect",function(){window.location="/login?ret="+window.location})},timeout:function(){var a=this;setTimeout(function(){a.resend()},5e3)},"no-found":function(){g.show({title:"404",content:"请求资源不存在",buttons:[{text:"确定",action:"close",className:"btn"}],className:"commonDialog",hasMask:{hideOnClick:!0}})},"no-permission":function(a){g.show({title:"操作失败",content:a&&a.responseJSON&&a.responseJSON.msg,buttons:[{text:"确定",action:"close",className:"btn"}],className:"commonDialog",hasMask:{hideOnClick:!0}})},fail:function(a){g.show({title:"请求异常",content:'<p class="del_text">'+(a&&a.responseJSON&&a.responseJSON.msg||"请求异常")+"</p>",width:470,height:300,buttons:[{text:"确定",action:"close",className:"btn"}],className:"commonDialog",hasMask:{hideOnClick:!0}})},"params-error":function(a){g.show({title:"参数错误",content:'<p class="del_text">'+(a&&a.responseJSON&&a.responseJSON.msg||"请求异常")+"</p>",width:470,height:300,buttons:[{text:"确定",action:"close",className:"btn"}],className:"commonDialog"})},"logic-error":function(a){g.show({title:"错误",content:a&&a.responseJSON&&a.responseJSON.msg,buttons:[{text:"确定",action:"close",className:"btn"}],className:"commonDialog",hasMask:{hideOnClick:!0}})},"server-error":function(){g.show({title:"服务器内部错误",content:"服务器内部错误",buttons:[{text:"确定",action:"close",className:"btn"}],className:"commonDialog",hasMask:{hideOnClick:!0}})}}};c.exports=d}),define("dist/app/common/_ajax",["../../lib/util/event","$"],function(a,b,c){function d(a,b){function c(){var b=d.ajax||{};return b.abort&&b.abort(),d.ajax=f.ajax(a),d.abort=function(){return d.ajax.abort()},d}var d=new e;return f.extend(d,{done:function(a){return this.on("done",a),this},fail:function(a){return this.on("fail",a),this},error:function(a){return this.on("error",a),this},then:function(a){return this.on("always",a),this}}),a.timeout=a.timeout||6e4,a.success=a.success||function(a,b,c){return this.trigger("done",a,b,c),this},a.success=f.proxy(a.success,d),a.error=a.error||function(a,b,c){if(0===a.readyState&&("timeout"===b?this.trigger("timeout",a,b,c):this.trigger("disconnect",a,b,c)),4===a.readyState){var d=a.status;switch(d){case 400:this.trigger("params-error",a,b,c);case 401:this.trigger("not-allowed",a,b,c);break;case 403:this.trigger("no-permission",a,b,c);break;case 404:this.trigger("no-found",a,b,c);break;case 405:this.trigger("params-error",a,b,c);break;case 406:this.trigger("logic-error",a,b,c);break;case 500:this.trigger("server-error",a,b,c)}}return this.trigger("error",a,b,c),this},a.error=f.proxy(a.error,d),a.complete=a.complete||function(a,b){return this.trigger("always",a,b),this},a.complete=f.proxy(a.complete,d),a.defaults&&f.each(a.defaults,function(a,b){d.on(a,b,d)}),b?f.extend(d,{success:a.success,resend:function(){},abort:function(){}}):(d.resend=c,d=c())}var e=a("../../lib/util/event"),f=a("$");c.exports=d}),define("dist/lib/util/event",[],function(a,b,c){function d(){}function e(a,b,c,d){var e;if(a)for(var f=0,g=a.length;g>f;f+=2)e=a[f].apply(a[f+1]||c,b),e===!1&&d.status&&(d.status=!1)}var f=/\s+/;c.exports=d,d.prototype.on=function(a,b,c){var d,e,g;if(!b)return this;for(d=this.__events||(this.__events={}),a=a.split(f);e=a.shift();)g=d[e]||(d[e]=[]),g.push(b,c);return this},d.prototype.off=function(a,b,c){var d,e,h,i;if(!(d=this.__events))return this;if(!(a||b||c))return delete this.__events,this;for(a=a?a.split(f):g(d);e=a.shift();)if(h=d[e])if(b||c)for(i=h.length-2;i>=0;i-=2)b&&h[i]!==b||c&&h[i+1]!==c||h.splice(i,2);else delete d[e];return this},d.prototype.trigger=function(a){var b,c,d,g,h,i,j=[],k={status:!0};if(!(b=this.__events))return this;for(a=a.split(f),h=1,i=arguments.length;i>h;h++)j[h-1]=arguments[h];for(;c=a.shift();)(d=b.all)&&(d=d.slice()),(g=b[c])&&(g=g.slice()),e(g,j,this,k),e(d,[c].concat(j),this,k);return k.status},d.mixTo=function(a){a=a.prototype||a;var b=d.prototype;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};var g=Object.keys;g||(g=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b})}),define("dist/lib/util/json",[],function(require,exports,module){"object"!=typeof JSON&&(JSON={}),function(){function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","        ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),module.exports=window.JSON}),define("dist/app/common/dialog/singleton",["$","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button"],function(a,b,c){var d,e=(a("$"),a("../../../lib/cmp/dialog/confirm-box")),f=e.extend({show:function(a){return this.get("visible")&&this.hide(),f.superclass.show.call(this,a),this}});f.show=function(a){return d||(d=new f(a)),d.show(a)},c.exports=f}),define("dist/lib/cmp/dialog/confirm-box",["$","./dialog","../overlay","../../util/dom/position","../../util/bom/browser","../../util/dom/iframe-shim","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","../mask","../../util/dom/sticky","../../util/dom/scroll","../../util/dom/wheel","./tpl/dialog","./tpl/button"],function(a,b,c){var d=a("$"),e=a("./dialog"),f=a("./tpl/button"),g=0,h={title:"",content:"",width:375,height:275,buttons:[{text:"关闭",className:"btn",action:"close"}]},i=e.extend({attrs:{title:h.title,content:h.content,width:h.width,height:h.height,hasMask:{hideOnClick:!1},buttons:[]},setup:function(){i.superclass.setup.call(this);for(var a=this.get("buttons"),b=[],c=0,d=a.length;d>c;c++){var e=a[c],h="string"==typeof e.action?e.action:"click_"+ ++g;b.push(f.render({className:e.className,action:h,text:e.text})),"close"!==h&&"confirm"!==h&&this.delegateEvents('click [data-action="'+h+'"]',function(a){return function(b){b.preventDefault(),this.trigger(a)}}(h))}this.$("[data-role=buttons]").eq(0).html(b.join(""))},events:{"click [data-action=close]":function(a){a.preventDefault(),this.hide()},"click [data-action=confirm]":function(a){a.preventDefault(),this.trigger("confirm")}},_onChangeContent:function(a){this.$("[data-role=content]").html(a)},_onChangeTitle:function(a){this.$("[data-role=title]").html(a)}});i.alert=function(a){return a=a||{},a=d.extend(!0,{},h,a),1!==a.buttons.length&&(a.buttons=[a.buttons[0]]),new i(a).show().after("hide",function(){this.destroy()})},i.confirm=function(a){return a=a||{},a=d.extend(!0,{buttons:[{text:"确认",className:"btn",action:"confirm"},{text:"取消",className:"btn",action:"close"}]},h,a),a.buttons=a.buttons.slice(0,2),new i(a).show().after("hide",function(){this.destroy()})},i.show=function(a){return a=a||{},a=d.extend({},h,a),new i(a).show().after("hide",function(){this.destroy()})},c.exports=i}),define("dist/lib/cmp/dialog/dialog",["$","../overlay","../../util/dom/position","../../util/bom/browser","../../util/dom/iframe-shim","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","../mask","../../util/dom/sticky","../../util/dom/scroll","../../util/dom/wheel","./tpl/dialog"],function(a,b,c){function d(a){null==a.attr("tabindex")&&a.attr("tabindex","-1"),a.css("outline","none").attr("hidefocus","true")}function e(a){var b,c=a[0].contentWindow.document;return c.body.scrollHeight&&c.documentElement.scrollHeight?b=Math.min(c.body.scrollHeight,c.documentElement.scrollHeight):c.documentElement.scrollHeight?b=c.documentElement.scrollHeight:c.body.scrollHeight&&(b=c.body.scrollHeight),b}var f=a("$"),g=a("../overlay"),h=a("../mask"),i=a("../../util/event"),j=a("../../util/dom/sticky"),k=a("../../util/dom/scroll"),l=a("./tpl/dialog"),m=300,n=98,o=g.extend({attrs:{template:l.render(),title:"对话框",content:{value:null,setter:function(a){return this._type=/^(https?:\/\/|\/|\.\/|\.\.\/)/.test(a)?"iframe":"",a}},hasMask:{value:!0,hideOnClick:!1},width:500,height:null,zIndex:n,fixed:!0,autoFit:!0,effect:"none",align:{selfXY:["50%","50%"],baseXY:["50%","50%"]}},events:{"click [data-action=close]":function(){return this.hide(),!1}},parseElement:function(){o.superclass.parseElement.call(this),this.contentElement=this.$('[data-role="content"]'),this.contentElement.css({background:"#fff",height:"100%",zoom:1})},setup:function(){o.superclass.setup.call(this),this._setupMask(),this._setupKeyEvents(),this._setupFocus(),d(this.element),this.get("fixed")!==!1&&j.fix(this.element),k.prevent(this.element)},_onRenderVisible:function(a){var b=this.get("effect");a?f.isFunction(b)?b.call(this,this.element):this.element.show():this.element.hide()},show:function(a){if(o.superclass.show.call(this),"iframe"===this._type?(this.get("height")||this.element.height(m),this._showIframe()):this.get("height")&&this.$(".main").height(this.get("height")-this.$(".header").outerHeight()-this.$(".footer").outerHeight()),a)for(var b in a)this.set(b,a[b]);return this},hide:function(){return"iframe"===this._type&&this.iframe&&(this.iframe.attr({src:"about:blank"}),this.iframe.remove(),this.iframe=null,this._errCount=0),o.superclass.hide.call(this),clearInterval(this._interval),delete this._interval,this},destroy:function(){return this.element.remove(),clearInterval(this._interval),o.superclass.destroy.call(this)},_onRenderHeader:function(a){this.$(".header")[a?"show":"hide"]()},_onRenderFooter:function(a){this.$(".footer")[a?"show":"hide"]()},_onRenderTitle:function(a){this.$("[data-role=title]").eq(0).html(a)},_onRenderClosable:function(a){this.$("[data-role=close]").eq(0)[a===!1?"hide":"show"]()},_onRenderContent:function(a){if("iframe"!==this._type){var b;try{b=f(a)}catch(c){b=[]}b[0]?this.contentElement.empty().append(b):this.contentElement.empty().html(a)}},_setupMask:function(){var a=this,b=function(){a.hide()};this.before("show",function(){this.set("zIndex",n),n+=2;var a=parseInt(this.get("zIndex"),10),c=this.get("hasMask");c&&(h.set("zIndex",a-1).show(),c.hideOnClick&&h.element.one("click",b))}),this.after("hide",function(){var a=this.get("hasMask");a&&(h.hide(),a.hideOnClick&&h.element.off("click",b))})},_setupFocus:function(){this.after("show",function(){this.element.focus()})},_setupKeyEvents:function(){this.delegateEvents(f(document),"keyup",function(a){27===a.keyCode&&this.get("visible")&&this.hide()})},_showIframe:function(){var a=this;this.iframe||this._createIframe(),this.iframe.attr({src:this._fixUrl(),name:"dialog-iframe"+(new Date).getTime()}),this.iframe.one("load",function(){a.get("visible")&&(a.get("autoFit")&&(clearInterval(a._interval),a._interval=setInterval(function(){a._syncHeight()},300)),a._syncHeight(),a.trigger("complete:show"))})},_fixUrl:function(){var a=this.get("content").match(/([^?#]*)(\?[^#]*)?(#.*)?/);return a.shift(),a[1]=(a[1]&&"?"!==a[1]?a[1]+"&":"?")+"t="+(new Date).getTime(),a.join("")},_createIframe:function(){var a=this;this.contentElement.empty(),this.iframe=f("<iframe>",{src:"about:blank",scrolling:"no",frameborder:"no",allowTransparency:"true",css:{border:"none",width:"100%",display:"block",height:"100%",overflow:"hidden"}}).appendTo(this.contentElement),this._errCount=0,i.mixTo(this.iframe[0]),this.iframe[0].on("close",function(){a.hide()})},_syncHeight:function(){var a;if(this.get("height"))clearInterval(this._interval),delete this._interval;else{try{a=e(this.iframe)+"px"}catch(b){this._errCount=(this._errCount||0)+1,this._errCount>=6&&(a=m,clearInterval(this._interval),delete this._interval)}this.element.css("height",a),this._setPosition(),this.element[0].className=this.element[0].className}}});c.exports=o}),define("dist/lib/cmp/overlay",["$","../util/dom/position","../util/bom/browser","../util/dom/iframe-shim","./widget","../util/base","../util/class","../util/event","../util/aspect","../util/attribute","./daparser","./auto-render"],function(a,b,c){function d(a){return g.contains(document.documentElement,a)}function e(a){g(k.blurOverlays).each(function(b,c){if(c&&c.get("visible")){for(var d=0;d<c._relativeElements.length;d++){var e=g(c._relativeElements[d])[0];if(e===a.target||g.contains(e,a.target))return}c.hide()}})}function f(a,b){for(var c=0;c<b.length;c++)if(a===b[c])return b.splice(c,1),b}var g=a("$"),h=a("../util/dom/position"),i=a("../util/dom/iframe-shim"),j=a("./widget"),k=j.extend({attrs:{width:null,height:null,zIndex:99,visible:!1,repositionOnResize:!0,align:{selfXY:[0,0],baseElement:h.VIEWPORT,baseXY:[0,0]},parentNode:document.body},show:function(){return this.rendered||this.render(),this.set("visible",!0),this},hide:function(){return this.set("visible",!1),this},setup:function(){var a=this;this._setupShim(),this.get("repositionOnResize")&&this._setupResize(),this.after("show",function(){a._setPosition()})},destroy:function(){return f(this,k.allOverlays),f(this,k.blurOverlays),k.superclass.destroy.call(this)},_setPosition:function(a){if(d(this.element[0])&&(a||(a=this.get("align")),a)){var b="none"===this.element.css("display");return b&&this.element.css({visibility:"hidden",display:"block"}),h.pin({element:this.element,x:a.selfXY[0],y:a.selfXY[1]},{element:a.baseElement,x:a.baseXY[0],y:a.baseXY[1]}),b&&this.element.css({visibility:"",display:"none"}),this}},_setupShim:function(){var a=new i(this.element);this.after("hide _setPosition",a.sync,a);var b=["width","height"];for(var c in b)b.hasOwnProperty(c)&&this.on("change:"+c,a.sync,a);this.before("destroy",a.destroy,a)},_setupResize:function(){k.allOverlays.push(this)},_blurHide:function(a){a=g.makeArray(a),a.push(this.element),this._relativeElements=a,k.blurOverlays.push(this)},_onRenderWidth:function(a){this.element.css("width",a)},_onRenderHeight:function(a){this.element.css("height",a)},_onRenderZIndex:function(a){this.element.css("zIndex",a)},_onRenderAlign:function(a){this._setPosition(a)},_onRenderVisible:function(a){this.element[a?"show":"hide"]()}});k.blurOverlays=[],g(document).on("mousedown",function(a){e(a)});var l,m=g(window).width(),n=g(window).height();k.allOverlays=[],g(window).resize(function(){var a=g(window).width(),b=g(window).height();(m!==a||n!==b)&&(l&&clearTimeout(l),l=setTimeout(function(){g(k.allOverlays).each(function(a,b){b&&b.get("visible")&&b._setPosition()})},80)),m=a,n=b}),c.exports=k}),define("dist/lib/util/dom/position",["$","../bom/browser"],function(a,b){function c(a){a=h(a)||{},a.nodeType&&(a={element:a});var b=h(a.element)||j;if(1!==b.nodeType)throw new Error("posObject.element is invalid.");var c={element:b,x:a.x||0,y:a.y||0},d=b===j||"VIEWPORT"===b._id;return c.offset=function(){return m?{left:0,top:0}:d?{left:k(document).scrollLeft(),top:k(document).scrollTop()}:k(b).offset()},c.size=function(){var a=k(d?window:b);return{width:a.outerWidth(),height:a.outerHeight()}},c}function d(a){a.x=e(a.x,a,"width"),a.y=e(a.y,a,"height")}function e(a,b,c){if(a+="",a=a.replace(/px/gi,""),/\D/.test(a)&&(a=a.replace(/(?:top|left)/gi,"0%").replace(/center/gi,"50%").replace(/(?:bottom|right)/gi,"100%")),-1!==a.indexOf("%")&&(a=a.replace(/(\d+(?:\.\d+)?)%/gi,function(a,d){return b.size()[c]*(d/100)
})),/[+\-*\/]/.test(a))try{a=new Function("return "+a)()}catch(d){throw new Error("Invalid position value: "+a)}return g(a)}function f(a){var b=a.offsetParent();b[0]===document.documentElement&&(b=k(document.body)),n&&b.css("zoom",1);var c=b[0]===document.body?{left:0,top:0}:b.offset();return c.top+=g(b.css("border-top-width")),c.left+=g(b.css("border-left-width")),c}function g(a){return parseFloat(a,10)||0}function h(a){return k(a)[0]}var i=b,j={_id:"VIEWPORT",nodeType:1},k=a("$"),l=a("../bom/browser"),m=!1,n=l.ie6;i.pin=function(a,b){a=c(a),b=c(b);var e=k(a.element);"fixed"!==e.css("position")||n?(e.css("position","absolute"),m=!1):m=!0,d(a),d(b);var g=f(e),h=b.offset(),i=h.top+b.y-a.y-g.top,j=h.left+b.x-a.x-g.left;e.css({left:j,top:i})},i.center=function(a,b){i.pin({element:a,x:"50%",y:"50%"},{element:b,x:"50%",y:"50%"})},i.VIEWPORT=j}),define("dist/lib/util/bom/browser",[],function(a,b,c){c.exports=function(){var a=!!window.ActiveXObject,b=!!window.devicePixelRatio;return{ie:a,ie6:a&&!window.XMLHttpRequest,ie7:a&&"7."===navigator.appVersion.match(/7./i),ie8:!!window.XDomainRequest,ie9:a&&1,firefox:!!document.getBoxObjectFor||"mozInnerScreenX"in window,opera:b&&!!window.opera,safari:Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,chrome:b&&!!window.chrome}}()}),define("dist/lib/util/dom/iframe-shim",["$","./position","../bom/browser"],function(a,b,c){function d(a){this.target=f(a).eq(0)}function e(a){var b={display:"none",border:"none",opacity:0,position:"absolute"},c=a.css("zIndex");return c&&c>0&&(b.zIndex=c-1),f("<iframe>",{src:"about:blank",frameborder:0,css:b}).insertBefore(a)}var f=a("$"),g=a("./position"),h=-1!==(window.navigator.userAgent||"").toLowerCase().indexOf("msie 6");if(d.prototype.sync=function(){var a=this.target,b=this.iframe;if(!a.length)return this;var c=a.outerHeight(),d=a.outerWidth();return c&&d&&!a.is(":hidden")?(b||(b=this.iframe=e(a)),b.css({height:c,width:d}),g.pin(b[0],a[0]),b.show()):b&&b.hide(),this},d.prototype.destroy=function(){this.iframe&&(this.iframe.remove(),delete this.iframe),delete this.target},h)c.exports=d;else{var i=function(){};i.prototype.sync=function(){return this},i.prototype.destroy=i,c.exports=i}}),define("dist/lib/cmp/widget",["../util/base","../util/class","../util/event","../util/aspect","../util/attribute","$","./daparser","./auto-render"],function(a,b,c){function d(){return"widget-"+w++}function e(a){return"[object String]"===v.call(a)}function f(a){return"[object Function]"===v.call(a)}function g(a){return x(document.documentElement,a)}function h(a){return a.charAt(0).toUpperCase()+a.substring(1)}function i(a){return f(a.events)&&(a.events=a.events()),a.events}function j(a,b){var c=a.match(y),d=c[1]+q+b.cid,e=c[2]||void 0;return e&&e.indexOf("{{")>-1&&(e=k(e,b)),{type:d,selector:e}}function k(a,b){return a.replace(z,function(a,c){for(var d,f=c.split("."),g=b;d=f.shift();)g=g===b.attrs?b.get(d):g[d];return e(g)?g:A})}function l(a){return null==a||void 0===a}var m=a("../util/base"),n=a("$"),o=a("./daparser"),p=a("./auto-render"),q=".delegate-events-",r="_onRender",s="data-widget-cid",t={},u=m.extend({propsInAttrs:["initElement","element","events"],element:null,events:null,attrs:{id:null,className:null,style:null,template:"<div></div>",model:null,parentNode:document.body},initialize:function(a){this.cid=d();var b=this._parseDataAttrsConfig(a);u.superclass.initialize.call(this,a?n.extend(b,a):b),this.parseElement(),this.initProps(),this.delegateEvents(),this.setup(),this._stamp(),this._isTemplate=!(a&&a.element)},_parseDataAttrsConfig:function(a){var b,c;return a&&(b=n(a.initElement?a.initElement:a.element)),b&&b[0]&&!p.isDataApiOff(b)&&(c=o.parseElement(b)),c},parseElement:function(){var a=this.element;if(a?this.element=n(a):this.get("template")&&this.parseElementFromTemplate(),!this.element||!this.element[0])throw new Error("element is invalid")},parseElementFromTemplate:function(){this.element=n(this.get("template"))},initProps:function(){},delegateEvents:function(a,b,c){if(0===arguments.length?(b=i(this),a=this.element):1===arguments.length?(b=a,a=this.element):2===arguments.length?(c=b,b=a,a=this.element):(a||(a=this.element),this._delegateElements||(this._delegateElements=[]),this._delegateElements.push(n(a))),e(b)&&f(c)){var d={};d[b]=c,b=d}for(var g in b)if(b.hasOwnProperty(g)){var h=j(g,this),k=h.type,l=h.selector;!function(b,c){var d=function(a){return f(b)?b.call(c,a):c[b](a)};l?n(a).on(k,l,d):n(a).on(k,d)}(b[g],this)}return this},undelegateEvents:function(a,b){if(b||(b=a,a=null),0===arguments.length){var c=q+this.cid;if(this.element&&this.element.off(c),this._delegateElements)for(var d in this._delegateElements)this._delegateElements.hasOwnProperty(d)&&this._delegateElements[d].off(c)}else{var e=j(b,this);a?n(a).off(e.type,e.selector):this.element&&this.element.off(e.type,e.selector)}return this},setup:function(){},render:function(){this.rendered||(this._renderAndBindAttrs(),this.rendered=!0);var a=this.get("parentNode");if(a&&!g(this.element[0])){var b=this.constructor.outerBoxClass;if(b){var c=this._outerBox=n("<div></div>").addClass(b);c.append(this.element).appendTo(a)}else this.element.appendTo(a)}return this},_renderAndBindAttrs:function(){var a=this,b=a.attrs;for(var c in b)if(b.hasOwnProperty(c)){var d=r+h(c);if(this[d]){var e=this.get(c);l(e)||this[d](e,void 0,c),function(b){a.on("change:"+c,function(c,d,e){a[b](c,d,e)})}(d)}}},_onRenderId:function(a){this.element.attr("id",a)},_onRenderClassName:function(a){this.element.addClass(a)},_onRenderStyle:function(a){this.element.css(a)},_stamp:function(){var a=this.cid;(this.initElement||this.element).attr(s,a),t[a]=this},$:function(a){return this.element.find(a)},destroy:function(){this.undelegateEvents(),delete t[this.cid],this.element&&this._isTemplate&&(this.element.off(),this._outerBox?this._outerBox.remove():this.element.remove()),this.element=null,u.superclass.destroy.call(this)}});n(window).unload(function(){for(var a in t)t[a].destroy()}),u.query=function(a){var b,c=n(a).eq(0);return c&&(b=c.attr(s)),t[b]},u.autoRender=p.autoRender,u.autoRenderAll=p.autoRenderAll,u.StaticsWhiteList=["autoRender"],c.exports=u;var v=Object.prototype.toString,w=0,x=n.contains||function(a,b){return!!(16&a.compareDocumentPosition(b))},y=/^(\S+)\s*(.*)$/,z=/{{([^}]+)}}/g,A="INVALID_SELECTOR"}),define("dist/lib/util/base",["./class","./event","./aspect","./attribute"],function(a,b,c){function d(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d="_onChange"+e(c);a[d]&&a.on("change:"+c,a[d])}}function e(a){return a.charAt(0).toUpperCase()+a.substring(1)}var f=a("./class"),g=a("./event"),h=a("./aspect"),i=a("./attribute"),j=f.create({Implements:[g,h,i],initialize:function(a){this.initAttrs(a),d(this,this.attrs)},destroy:function(){this.off();for(var a in this)this.hasOwnProperty(a)&&delete this[a];this.destroy=function(){}}});c.exports=j}),define("dist/lib/util/class",[],function(a,b,c){function d(a){return this instanceof d||!l(a)?void 0:g(a)}function e(){}function f(a){var b,c;for(b in a)c=a[b],d.Mutators.hasOwnProperty(b)?d.Mutators[b].call(this,c):this.prototype[b]=c}function g(a){return a.extend=d.extend,a.implement=f,a}function h(a,b,c){for(var d in b)if(b.hasOwnProperty(d)){if(c&&-1===m(c,d))continue;"prototype"!==d&&(a[d]=b[d])}}c.exports=d,d.extend=function(a){return a||(a={}),a.Extends=this,d.create(a)},d.create=function(a,b){function c(){a.apply(this,arguments),this.constructor===c&&this.initialize&&this.initialize.apply(this,arguments)}return l(a)||(b=a,a=null),b||(b={}),a||(a=b.Extends||d),b.Extends=a,a!==d&&h(c,a,a.StaticsWhiteList),f.call(c,b),g(c)};var i=Object.__proto__?function(a){return{__proto__:a}}:function(a){return e.prototype=a,new e};d.Mutators={Extends:function(a){var b=this.prototype,c=i(a.prototype);h(c,b),c.constructor=this,this.prototype=c,this.superclass=a.prototype},Implements:function(a){k(a)||(a=[a]);for(var b,c=this.prototype;b=a.shift();)h(c,b.prototype||b)},Statics:function(a){h(this,a)}};var j=Object.prototype.toString,k=Array.isArray||function(a){return"[object Array]"===j.call(a)},l=function(a){return"[object Function]"===j.call(a)},m=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}}),define("dist/lib/util/aspect",[],function(a,b,c){function d(a,b,c,d){for(var g,i,j=b.split(h);g=j.shift();)i=e(this,g),i.__isAspected||f.call(this,g),this.on(a+":"+g,c,d);return this}function e(a,b){var c=a[b];if(!c)throw new Error("Invalid method name: "+b);return c}function f(a){var b=this[a];this[a]=function(){var c=Array.prototype.slice.call(arguments),d=["before:"+a].concat(c);if(this.trigger.apply(this,d)!==!1){var e=b.apply(this,arguments),f=["after:"+a,e].concat(c);return this.trigger.apply(this,f),e}},this[a].__isAspected=!0}var g={before:function(a,b,c){return d.call(this,"before",a,b,c)},after:function(a,b,c){return d.call(this,"after",a,b,c)}};c.exports=g;var h=/\s+/}),define("dist/lib/util/attribute",[],function(a,b,c){function d(a){return"[object String]"===u.call(a)}function e(a){return"[object Function]"===u.call(a)}function f(a){return null!==a&&a===a.window}function g(a){if(!a||"[object Object]"!==u.call(a)||a.nodeType||f(a))return!1;try{if(a.constructor&&!v.call(a,"constructor")&&!v.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}var c;if(t)for(c in a)return v.call(a,c);for(c in a);return void 0===c||v.call(a,c)}function h(a){if(!a||"[object Object]"!==u.call(a)||a.nodeType||f(a)||!a.hasOwnProperty)return!1;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function i(a,b){var c,d;for(c in b)if(b.hasOwnProperty(c)){if(d=b[c],w(d))d=d.slice();else if(g(d)){var e=a[c];g(e)||(e={}),d=i(e,d)}a[c]=d}return a}function j(a,b,c){for(var d=[],e=b.constructor.prototype;e;)e.hasOwnProperty("attrs")||(e.attrs={}),l(c,e.attrs,e),h(e.attrs)||d.unshift(e.attrs),e=e.constructor.superclass;for(var f=0,g=d.length;g>f;f++)i(a,p(d[f]))}function k(a,b){i(a,p(b,!0))}function l(a,b,c,d){for(var e=0,f=a.length;f>e;e++){var g=a[e];c.hasOwnProperty(g)&&(b[g]=d?b.get(g):c[g])}}function m(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d,f=b[c].value;e(f)&&(d=c.match(y))&&(a[d[1]](n(d[2]),f),delete b[c])}}function n(a){var b=a.match(z),c=b[1]?"change:":"";return c+=b[2].toLowerCase()+b[3]}function o(a,b,c){var d={silent:!0};a.__initializingAttrs=!0;for(var e in c)c.hasOwnProperty(e)&&b[e].setter&&a.set(e,c[e],d);delete a.__initializingAttrs}function p(a,b){var c={};for(var d in a){var e=a[d];c[d]=!b&&g(e)&&q(e,A)?e:{value:e}}return c}function q(a,b){for(var c=0,d=b.length;d>c;c++)if(a.hasOwnProperty(b[c]))return!0;return!1}function r(a){return null===a||(d(a)||w(a))&&0===a.length||h(a)}function s(a,b){if(a===b)return!0;if(r(a)&&r(b))return!0;var c=u.call(a);if(c!==u.call(b))return!1;switch(c){case"[object String]":return a===String(b);case"[object Number]":return a!==+a?b!==+b:0===a?1/a===1/b:a===+b;case"[object Date]":case"[object Boolean]":return+a===+b;case"[object RegExp]":return a.source===b.source&&a.global===b.global&&a.multiline===b.multiline&&a.ignoreCase===b.ignoreCase;case"[object Array]":var d=a.toString(),e=b.toString();return-1===d.indexOf("[object")&&-1===e.indexOf("[object")&&d===e}if("object"!=typeof a||"object"!=typeof b)return!1;if(g(a)&&g(b)){if(!s(x(a),x(b)))return!1;for(var f in a)if(a[f]!==b[f])return!1;return!0}return!1}var t,u=Object.prototype.toString,v=Object.prototype.hasOwnProperty;!function(){function a(){this.x=1}var b=[];a.prototype={valueOf:1,y:1};for(var c in new a)b.push(c);t="x"!==b[0]}();var w=Array.isArray||function(a){return"[object Array]"===u.call(a)},x=Object.keys;x||(x=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b});var y=/^(on|before|after)([A-Z].*)$/,z=/^(Change)?([A-Z])(.*)/,A=["value","getter","setter","readOnly"],B={initAttrs:function(a){var b=this.attrs={},c=this.propsInAttrs||[];j(b,this,c),a&&k(b,a),o(this,b,a),m(this,b),l(c,this,b,!0)},get:function(a){var b=this.attrs[a]||{},c=b.value;return b.getter?b.getter.call(this,c,a):c},set:function(a,b,c){var e={};d(a)?e[a]=b:(e=a,c=b),c||(c={});var f=c.silent,h=c.override,j=this.attrs,k=this.__changedAttrs||(this.__changedAttrs={});for(a in e)if(e.hasOwnProperty(a)){var l=j[a]||(j[a]={});if(b=e[a],l.readOnly)throw new Error("This attribute is readOnly: "+a);l.setter&&(b=l.setter.call(this,b,a));var m=this.get(a);!h&&g(m)&&g(b)&&(b=i(i({},m),b)),j[a].value=b,this.__initializingAttrs||s(m,b)||(f?k[a]=[b,m]:this.trigger("change:"+a,b,m,a))}return this},change:function(){var a=this.__changedAttrs;if(a){for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];this.trigger("change:"+b,c[0],c[1],b)}delete this.__changedAttrs}return this},_isPlainObject:g};c.exports=B}),define("dist/lib/cmp/daparser",["$"],function(a,b){function c(a){return a.toLowerCase().replace(g,function(a,b){return(b+"").toUpperCase()})}function d(a){for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];if("string"!=typeof c)continue;h.test(c)?(c=c.replace(/'/g,'"'),a[b]=d(i(c))):a[b]=e(c)}return a}function e(a){if("false"===a.toLowerCase())a=!1;else if("true"===a.toLowerCase())a=!0;else if(/\d/.test(a)&&/[^a-z]/i.test(a)){var b=parseFloat(a);b+""===a&&(a=b)}return a}var f=a("$");b.parseElement=function(a,b){a=f(a)[0];var e={};if(a.dataset)e=f.extend({},a.dataset);else for(var g=a.attributes,h=0,i=g.length;i>h;h++){var j=g[h],k=j.name;0===k.indexOf("data-")&&(k=c(k.substring(5)),e[k]=j.value)}return b===!0?e:d(e)};var g=/-([a-z])/g,h=/^\s*[\[{].*[\]}]\s*$/,i=this.JSON?JSON.parse:f.parseJSON}),define("dist/lib/cmp/auto-render",["$"],function(a,b){var c=a("$"),d="data-widget-auto-rendered";b.autoRender=function(a){return new this(a).render()},b.autoRenderAll=function(a,e){"function"==typeof a&&(e=a,a=null),a=c(a||document.body);var f=[],g=[];a.find("[data-widget]").each(function(a,c){b.isDataApiOff(c)||(f.push(c.getAttribute("data-widget").toLowerCase()),g.push(c))}),f.length&&seajs.use(f,function(){for(var a=0;a<arguments.length;a++){var b=arguments[a],f=c(g[a]);if(!f.attr(d)){var h={initElement:f,renderType:"auto"},i=f.attr("data-widget-role");h[i?i:"element"]=f,b.autoRender&&b.autoRender(h),f.attr(d,"true")}}e&&e()})};var e="off"===c(document.body).attr("data-api");b.isDataApiOff=function(a){var b=c(a).attr("data-api");return"off"===b||"on"!==b&&e}}),define("dist/lib/cmp/mask",["$","./overlay","../util/dom/position","../util/bom/browser","../util/dom/iframe-shim","./widget","../util/base","../util/class","../util/event","../util/aspect","../util/attribute","./daparser","./auto-render"],function(a,b,c){var d=a("$"),e=a("./overlay"),f=(window.navigator.userAgent||"").toLowerCase(),g=-1!==f.indexOf("msie 6"),h=d(document.body),i=d(document),j=[],k=e.extend({attrs:{width:g?i.outerWidth(!0):"100%",height:g?i.outerHeight(!0):"100%",className:"dialog-mask",opacity:.5,backgroundColor:"#000",style:{position:g?"absolute":"fixed",top:0,left:0},align:{baseElement:g?h:void 0}},show:function(){return g&&(this.set("width",i.outerWidth(!0)),this.set("height",i.outerHeight(!0))),k.superclass.show.call(this)},setup:function(){this._setupShim(),this.before("show",function(){j.push(this.get("zIndex"))})},hide:function(){return j.pop(),j.length>0?(this.set("zIndex",j[j.length-1]),this):k.superclass.hide.call(this)},_onRenderBackgroundColor:function(a){this.element.css("backgroundColor",a)},_onRenderOpacity:function(a){this.element.css("opacity",a)}});c.exports=new k}),define("dist/lib/util/dom/sticky",["$"],function(a,b,c){function d(a,b,c){return new g({element:a,marginTop:b||0,callback:c}).render()}function e(){return!n}function f(){if(m)return!1;var a=i[0].body;if(i[0].createElement&&a&&a.appendChild&&a.removeChild){var b,c=i[0].createElement("div"),d=function(a){return window.getComputedStyle?window.getComputedStyle(c).getPropertyValue(a):c.currentStyle.getAttribute(a)};a.appendChild(c);for(var e=0;e<j.length&&(c.style.cssText="position:"+j[e]+"sticky;visibility:hidden;",!(b=-1!==d("position").indexOf("sticky")));e++);return c.parentNode.removeChild(c),b}}function g(a){this.options=a||{},this.elem=h(this.options.element),this.callback=a.callback||function(){},this.marginTop=a.marginTop||0,this._stickyId=k++}var h=a("$"),i=h(document),j=["-webkit-","-ms-","-o-","-moz-",""],k=0,l=(window.navigator.userAgent||"").toLowerCase(),m=-1!==l.indexOf("msie"),n=-1!==l.indexOf("msie 6"),o=f(),p=e();d.stick=d,d.fix=function(a){return new g({element:a,marginTop:Number.MAX_VALUE}).render()},d.isPositionStickySupported=o,d.isPositionFixedSupported=p,g.prototype.render=function(){var a,b=this;if(this.elem.length&&!this.elem.data("bind-sticked")){this._originTop=this.elem.offset().top,this.marginTop===Number.MAX_VALUE&&(a=!0,this.marginTop=this._originTop),this._originStyles={position:null,top:null,left:null};for(var c in this._originStyles)this._originStyles.hasOwnProperty(c)&&(this._originStyles[c]=this.elem.css(c));var e;if(d.isPositionStickySupported&&!a){e=this._supportSticky;for(var f="",g=0;g<j.length;g++)f+="position:"+j[g]+"sticky;";this.elem[0].style.cssText+=f+"top: "+this.marginTop+"px;"}else d.isPositionFixedSupported?e=this._supportFixed:(e=this._supportAbsolute,h('<style type="text/css"> * html{ background:url(null) no-repeat fixed; } </style>').appendTo("head"));return e.call(this),h(window).on("scroll."+this._stickyId,function(){b.elem.is(":visible")&&e.call(b)}),this.elem.data("bind-sticked",!0),this}},g.prototype._supportFixed=function(){var a=this._originTop-i.scrollTop();!this.elem.data("sticked")&&a<=this.marginTop?(this._addPlaceholder(),this.elem.css({position:"fixed",top:this.marginTop,left:this.elem.offset().left}),this.elem.data("sticked",!0),this.callback.call(this,!0)):this.elem.data("sticked")&&a>this.marginTop&&this._restore()},g.prototype._supportAbsolute=function(){var a=this._originTop-i.scrollTop();a<=this.marginTop?(this.elem.data("sticked")||(this._addPlaceholder(),this.elem.data("sticked",!0),this.callback.call(this,!0)),this.elem.css({position:"absolute",top:this.marginTop+i.scrollTop()})):this.elem.data("sticked")&&a>this.marginTop&&this._restore()},g.prototype._supportSticky=function(){var a=this._originTop-i.scrollTop();!this.elem.data("sticked")&&a<=this.marginTop?(this.elem.data("sticked",!0),this.callback.call(this,!0)):this.elem.data("sticked")&&a>this.marginTop&&this.callback.call(this,!1)},g.prototype._restore=function(){this._removePlaceholder(),this.elem.css(this._originStyles),this.elem.data("sticked",!1),this.callback.call(this,!1)},g.prototype._addPlaceholder=function(){var a=!1,b=this.elem.css("position");("static"===b||"relative"===b)&&(a=!0),"block"!==this.elem.css("display")&&(a=!1),a&&(this._placeholder=h('<div style="visibility:hidden;margin:0;padding:0;"></div>'),this._placeholder.width(this.elem.outerWidth(!0)).height(this.elem.outerHeight(!0)).css("float",this.elem.css("float")).insertAfter(this.elem))},g.prototype._removePlaceholder=function(){this._placeholder&&this._placeholder.remove()},g.prototype.destroy=function(){this._restore(),this.elem.data("bind-sticked",!1),h(window).off("scroll."+this._stickyId)},c.exports=d}),define("dist/lib/util/dom/scroll",["$","./wheel","../bom/browser"],function(a,b,c){var d=a("$"),e=a("./wheel"),f={detect:function(a){var b,c,e;return a===window||a===document?(c=d(document).scrollTop(),a=document.documentElement):c=a.scrollTop,e=Math.ceil(a.clientHeight),0===c?b=a.scrollHeight>Math.ceil(e)?"top":"noscroll":c+Math.ceil(e)>=a.scrollHeight&&(b="bottom"),b}},g={to:function(a,b){(a===window||a===document||a===document.body)&&(a=document.documentElement),a=a[0]||a,"top"===b?b=0:"bottom"===b&&(b=a.scrollHeight),a.scrollTop=b},prevent:function(a,b){a=a[0]||a,e(a,function(c,d,e,g){var h=f.detect(a);a===c.target&&("ie"===g||"noscroll"===h||"top"===h&&"up"===d||"bottom"===h&&"down"===d)&&(e(),b&&b.call(a,c,h))})},listen:function(a,b,c){var e={},h=d(a).scrollTop(),i=function(c,g){if(g){var h=f.detect(a),i=d(a).scrollTop();e.bottom=(a===document?document.body:a).scrollHeight-parseFloat(a===document?document.documentElement.clientHeight:a.clientHeight),b.other&&b.other(c,i,g,e),h&&(b.top&&"top"===h&&"up"===g&&b.top(c,i,g,e),b.bottom&&"bottom"===h&&"down"===g&&b.bottom(c,i,g,e))}};a=a[0]||a,a=a===document||a===document.body?window:a,d(a).scroll(function(b){var c=d(a).scrollTop(),e=c>h?"down":h>c?"up":"";h=c,e&&i(b.originalEvent,e)}),a!==window&&c!==!1&&g.prevent(a)}};c.exports=g}),define("dist/lib/util/dom/wheel",["../bom/browser"],function(a,b,c){var d=a("../bom/browser");c.exports=function(a,b){a=a[0]||a,d.ie?a.attachEvent("onmousewheel",function(c){c=window.event;var d=function(){a.scrollTop+=c.wheelDelta>0?-60:60,c.returnValue=!1};b&&b.call(a,c,c.wheelDelta>0?"up":"down",d,"ie")}):d.firefox?a.addEventListener("DOMMouseScroll",function(c){b&&b.call(a,c,c.detail<0?"up":c.detail>0?"down":"",function(){c.preventDefault()},"firefox")},!1):a.addEventListener("mousewheel",function(c){b&&b.call(a,c,c.wheelDelta>=0?"up":c.wheelDelta<=0?"down":"",function(){c.returnValue=!1},"standard")},!1)}}),define("dist/lib/cmp/dialog/tpl/dialog",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="widget-dialog"> <a href="#" data-action="close" data-role="close" title="关闭" class="dialog-close">×</a> <div class="header"> <div class="title" data-role="title"></div> </div> <div class="main"> <div class="content" data-role="content"></div> </div> <div class="footer"> <div class="buttons" data-role="buttons"></div> </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/lib/cmp/dialog/tpl/button",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push(' <input type=\"button\" value=\"',text,'\" class=\"',className,'\" data-action=\"',action,'\"/>'); return _s;").apply(null,c).join("")}}}),define("dist/lib/cmp/tree/ztree/ztree",["$"],function(require,exports,module){var jQuery=require("$");!function($){var settings={},roots={},caches={},_consts={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(a){var b=data.getRoot(a);b||(b={},data.setRoot(a,b)),b[a.data.key.children]=[],b.expandTriggerFlag=!1,b.curSelectedList=[],b.noSelection=!0,b.createdNodes=[],b.zId=0,b._ver=(new Date).getTime()},_initCache=function(a){var b=data.getCache(a);b||(b={},data.setCache(a,b)),b.nodes=[],b.doms=[]},_bindEvent=function(a){var b=a.treeObj,c=consts.event;b.bind(c.NODECREATED,function(b,c,d){tools.apply(a.callback.onNodeCreated,[b,c,d])}),b.bind(c.CLICK,function(b,c,d,e,f){tools.apply(a.callback.onClick,[c,d,e,f])}),b.bind(c.EXPAND,function(b,c,d){tools.apply(a.callback.onExpand,[b,c,d])}),b.bind(c.COLLAPSE,function(b,c,d){tools.apply(a.callback.onCollapse,[b,c,d])}),b.bind(c.ASYNC_SUCCESS,function(b,c,d,e){tools.apply(a.callback.onAsyncSuccess,[b,c,d,e])}),b.bind(c.ASYNC_ERROR,function(b,c,d,e,f,g){tools.apply(a.callback.onAsyncError,[b,c,d,e,f,g])})},_unbindEvent=function(a){var b=a.treeObj,c=consts.event;b.unbind(c.NODECREATED).unbind(c.CLICK).unbind(c.EXPAND).unbind(c.COLLAPSE).unbind(c.ASYNC_SUCCESS).unbind(c.ASYNC_ERROR)},_eventProxy=function(a){var b=a.target,c=data.getSetting(a.data.treeId),d="",e=null,f="",g="",h=null,i=null,j=null;if(tools.eqs(a.type,"mousedown")?g="mousedown":tools.eqs(a.type,"mouseup")?g="mouseup":tools.eqs(a.type,"contextmenu")?g="contextmenu":tools.eqs(a.type,"click")?tools.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+consts.id.SWITCH)?(d=tools.getNodeMainDom(b).id,f="switchNode"):(j=tools.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),j&&(d=tools.getNodeMainDom(j).id,f="clickNode")):tools.eqs(a.type,"dblclick")&&(g="dblclick",j=tools.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),j&&(d=tools.getNodeMainDom(j).id,f="switchNode")),g.length>0&&0==d.length&&(j=tools.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),j&&(d=tools.getNodeMainDom(j).id)),d.length>0)switch(e=data.getNodeCache(c,d),f){case"switchNode":e.isParent&&(tools.eqs(a.type,"click")||tools.eqs(a.type,"dblclick")&&tools.apply(c.view.dblClickExpand,[c.treeId,e],c.view.dblClickExpand))?h=handler.onSwitchNode:f="";break;case"clickNode":h=handler.onClickNode}switch(g){case"mousedown":i=handler.onZTreeMousedown;break;case"mouseup":i=handler.onZTreeMouseup;break;case"dblclick":i=handler.onZTreeDblclick;break;case"contextmenu":i=handler.onZTreeContextmenu}var k={stop:!1,node:e,nodeEventType:f,nodeEventCallback:h,treeEventType:g,treeEventCallback:i};return k},_initNode=function(a,b,c,d,e,f){if(c){var g=data.getRoot(a),h=a.data.key.children;c.level=b,c.tId=a.treeId+"_"+ ++g.zId,c.parentTId=d?d.tId:null,c[h]&&c[h].length>0?("string"==typeof c.open&&(c.open=tools.eqs(c.open,"true")),c.open=!!c.open,c.isParent=!0,c.zAsync=!0):(c.open=!1,"string"==typeof c.isParent&&(c.isParent=tools.eqs(c.isParent,"true")),c.isParent=!!c.isParent,c.zAsync=!c.isParent),c.isFirstNode=e,c.isLastNode=f,c.getParentNode=function(){return data.getNodeCache(a,c.parentTId)},c.getPreNode=function(){return data.getPreNode(a,c)},c.getNextNode=function(){return data.getNextNode(a,c)},c.isAjaxing=!1,data.fixPIdKeyValue(a,c)}},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(a,b){data.getCache(a).nodes[data.getNodeCacheId(b.tId)]=b},getNodeCacheId:function(a){return a.substring(a.lastIndexOf("_")+1)},addAfterA:function(a){_init.afterA.push(a)},addBeforeA:function(a){_init.beforeA.push(a)},addInnerAfterA:function(a){_init.innerAfterA.push(a)},addInnerBeforeA:function(a){_init.innerBeforeA.push(a)},addInitBind:function(a){_init.bind.push(a)},addInitUnBind:function(a){_init.unbind.push(a)},addInitCache:function(a){_init.caches.push(a)},addInitNode:function(a){_init.nodes.push(a)},addInitProxy:function(a,b){b?_init.proxys.splice(0,0,a):_init.proxys.push(a)},addInitRoot:function(a){_init.roots.push(a)},addNodesData:function(a,b,c){var d=a.data.key.children;b[d]||(b[d]=[]),b[d].length>0&&(b[d][b[d].length-1].isLastNode=!1,view.setNodeLineIcos(a,b[d][b[d].length-1])),b.isParent=!0,b[d]=b[d].concat(c)},addSelectedNode:function(a,b){var c=data.getRoot(a);data.isSelectedNode(a,b)||c.curSelectedList.push(b)},addCreatedNode:function(a,b){if(a.callback.onNodeCreated||a.view.addDiyDom){var c=data.getRoot(a);c.createdNodes.push(b)}},addZTreeTools:function(a){_init.zTreeTools.push(a)},exSetting:function(a){$.extend(!0,_setting,a)},fixPIdKeyValue:function(a,b){a.data.simpleData.enable&&(b[a.data.simpleData.pIdKey]=b.parentTId?b.getParentNode()[a.data.simpleData.idKey]:a.data.simpleData.rootPId)},getAfterA:function(){for(var a=0,b=_init.afterA.length;b>a;a++)_init.afterA[a].apply(this,arguments)},getBeforeA:function(){for(var a=0,b=_init.beforeA.length;b>a;a++)_init.beforeA[a].apply(this,arguments)},getInnerAfterA:function(){for(var a=0,b=_init.innerAfterA.length;b>a;a++)_init.innerAfterA[a].apply(this,arguments)},getInnerBeforeA:function(){for(var a=0,b=_init.innerBeforeA.length;b>a;a++)_init.innerBeforeA[a].apply(this,arguments)},getCache:function(a){return caches[a.treeId]},getNextNode:function(a,b){if(!b)return null;for(var c=a.data.key.children,d=b.parentTId?b.getParentNode():data.getRoot(a),e=0,f=d[c].length-1;f>=e;e++)if(d[c][e]===b)return e==f?null:d[c][e+1];return null},getNodeByParam:function(a,b,c,d){if(!b||!c)return null;for(var e=a.data.key.children,f=0,g=b.length;g>f;f++){if(b[f][c]==d)return b[f];var h=data.getNodeByParam(a,b[f][e],c,d);if(h)return h}return null},getNodeCache:function(a,b){if(!b)return null;var c=caches[a.treeId].nodes[data.getNodeCacheId(b)];return c?c:null},getNodeName:function(a,b){var c=a.data.key.name;return""+b[c]},getNodeTitle:function(a,b){var c=""===a.data.key.title?a.data.key.name:a.data.key.title;return""+b[c]},getNodes:function(a){return data.getRoot(a)[a.data.key.children]},getNodesByParam:function(a,b,c,d){if(!b||!c)return[];for(var e=a.data.key.children,f=[],g=0,h=b.length;h>g;g++)b[g][c]==d&&f.push(b[g]),f=f.concat(data.getNodesByParam(a,b[g][e],c,d));return f},getNodesByParamFuzzy:function(a,b,c,d){if(!b||!c)return[];var e=a.data.key.children,f=[];d=d.toLowerCase();for(var g=0,h=b.length;h>g;g++)"string"==typeof b[g][c]&&b[g][c].toLowerCase().indexOf(d)>-1&&f.push(b[g]),f=f.concat(data.getNodesByParamFuzzy(a,b[g][e],c,d));return f},getNodesByFilter:function(a,b,c,d,e){if(!b)return d?null:[];for(var f=a.data.key.children,g=d?null:[],h=0,i=b.length;i>h;h++){if(tools.apply(c,[b[h],e],!1)){if(d)return b[h];g.push(b[h])}var j=data.getNodesByFilter(a,b[h][f],c,d,e);if(d&&j)return j;g=d?j:g.concat(j)}return g},getPreNode:function(a,b){if(!b)return null;for(var c=a.data.key.children,d=b.parentTId?b.getParentNode():data.getRoot(a),e=0,f=d[c].length;f>e;e++)if(d[c][e]===b)return 0==e?null:d[c][e-1];return null},getRoot:function(a){return a?roots[a.treeId]:null},getRoots:function(){return roots},getSetting:function(a){return settings[a]},getSettings:function(){return settings},getZTreeTools:function(a){var b=this.getRoot(this.getSetting(a));return b?b.treeTools:null},initCache:function(){for(var a=0,b=_init.caches.length;b>a;a++)_init.caches[a].apply(this,arguments)},initNode:function(){for(var a=0,b=_init.nodes.length;b>a;a++)_init.nodes[a].apply(this,arguments)},initRoot:function(){for(var a=0,b=_init.roots.length;b>a;a++)_init.roots[a].apply(this,arguments)},isSelectedNode:function(a,b){for(var c=data.getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)if(b===c.curSelectedList[d])return!0;return!1},removeNodeCache:function(a,b){var c=a.data.key.children;if(b[c])for(var d=0,e=b[c].length;e>d;d++)arguments.callee(a,b[c][d]);data.getCache(a).nodes[data.getNodeCacheId(b.tId)]=null},removeSelectedNode:function(a,b){for(var c=data.getRoot(a),d=0,e=c.curSelectedList.length;e>d;d++)b!==c.curSelectedList[d]&&data.getNodeCache(a,c.curSelectedList[d].tId)||(c.curSelectedList.splice(d,1),d--,e--)},setCache:function(a,b){caches[a.treeId]=b},setRoot:function(a,b){roots[a.treeId]=b},setZTreeTools:function(){for(var a=0,b=_init.zTreeTools.length;b>a;a++)_init.zTreeTools[a].apply(this,arguments)},transformToArrayFormat:function(a,b){if(!b)return[];var c=a.data.key.children,d=[];if(tools.isArray(b))for(var e=0,f=b.length;f>e;e++)d.push(b[e]),b[e][c]&&(d=d.concat(data.transformToArrayFormat(a,b[e][c])));else d.push(b),b[c]&&(d=d.concat(data.transformToArrayFormat(a,b[c])));return d},transformTozTreeFormat:function(a,b){var c,d,e=a.data.simpleData.idKey,f=a.data.simpleData.pIdKey,g=a.data.key.children;
if(!e||""==e||!b)return[];if(tools.isArray(b)){var h=[],i=[];for(c=0,d=b.length;d>c;c++)i[b[c][e]]=b[c];for(c=0,d=b.length;d>c;c++)i[b[c][f]]&&b[c][e]!=b[c][f]?(i[b[c][f]][g]||(i[b[c][f]][g]=[]),i[b[c][f]][g].push(b[c])):h.push(b[c]);return h}return[b]}},event={bindEvent:function(){for(var a=0,b=_init.bind.length;b>a;a++)_init.bind[a].apply(this,arguments)},unbindEvent:function(){for(var a=0,b=_init.unbind.length;b>a;a++)_init.unbind[a].apply(this,arguments)},bindTree:function(a){var b={treeId:a.treeId},c=a.treeObj;c.bind("selectstart",function(a){var b=a.originalEvent.srcElement.nodeName.toLowerCase();return"input"===b||"textarea"===b}).css({"-moz-user-select":"-moz-none"}),c.bind("click",b,event.proxy),c.bind("dblclick",b,event.proxy),c.bind("mouseover",b,event.proxy),c.bind("mouseout",b,event.proxy),c.bind("mousedown",b,event.proxy),c.bind("mouseup",b,event.proxy),c.bind("contextmenu",b,event.proxy)},unbindTree:function(a){var b=a.treeObj;b.unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(){for(var a=[],b=0,c=_init.proxys.length;c>b;b++){var d=_init.proxys[b].apply(this,arguments);if(a.push(d),d.stop)break}return a},proxy:function(a){var b=data.getSetting(a.data.treeId);if(!tools.uCanDo(b,a))return!0;for(var c=event.doProxy(a),d=!0,e=!1,f=0,g=c.length;g>f;f++){var h=c[f];h.nodeEventCallback&&(e=!0,d=h.nodeEventCallback.apply(h,[a,h.node])&&d),h.treeEventCallback&&(e=!0,d=h.treeEventCallback.apply(h,[a,h.node])&&d)}return d}},handler={onSwitchNode:function(a,b){var c=data.getSetting(a.data.treeId);if(b.open){if(0==tools.apply(c.callback.beforeCollapse,[c.treeId,b],!0))return!0;data.getRoot(c).expandTriggerFlag=!0,view.switchNode(c,b)}else{if(0==tools.apply(c.callback.beforeExpand,[c.treeId,b],!0))return!0;data.getRoot(c).expandTriggerFlag=!0,view.switchNode(c,b)}return!0},onClickNode:function(a,b){var c=data.getSetting(a.data.treeId),d=c.view.autoCancelSelected&&a.ctrlKey&&data.isSelectedNode(c,b)?0:c.view.autoCancelSelected&&a.ctrlKey&&c.view.selectedMulti?2:1;return 0==tools.apply(c.callback.beforeClick,[c.treeId,b,d],!0)?!0:(0===d?view.cancelPreSelectedNode(c,b):view.selectNode(c,b,2===d),c.treeObj.trigger(consts.event.CLICK,[a,c.treeId,b,d]),!0)},onZTreeMousedown:function(a,b){var c=data.getSetting(a.data.treeId);return tools.apply(c.callback.beforeMouseDown,[c.treeId,b],!0)&&tools.apply(c.callback.onMouseDown,[a,c.treeId,b]),!0},onZTreeMouseup:function(a,b){var c=data.getSetting(a.data.treeId);return tools.apply(c.callback.beforeMouseUp,[c.treeId,b],!0)&&tools.apply(c.callback.onMouseUp,[a,c.treeId,b]),!0},onZTreeDblclick:function(a,b){var c=data.getSetting(a.data.treeId);return tools.apply(c.callback.beforeDblClick,[c.treeId,b],!0)&&tools.apply(c.callback.onDblClick,[a,c.treeId,b]),!0},onZTreeContextmenu:function(a,b){var c=data.getSetting(a.data.treeId);return tools.apply(c.callback.beforeRightClick,[c.treeId,b],!0)&&tools.apply(c.callback.onRightClick,[a,c.treeId,b]),"function"!=typeof c.callback.onRightClick}},tools={apply:function(a,b,c){return"function"==typeof a?a.apply(zt,b?b:[]):c},canAsync:function(a,b){var c=a.data.key.children;return a.async.enable&&b&&b.isParent&&!(b.zAsync||b[c]&&b[c].length>0)},clone:function(a){if(null===a)return null;var b=tools.isArray(a)?[]:{};for(var c in a)b[c]=a[c]instanceof Date?new Date(a[c].getTime()):"object"==typeof a[c]?arguments.callee(a[c]):a[c];return b},eqs:function(a,b){return a.toLowerCase()===b.toLowerCase()},isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},$:function(a,b,c){return b&&"string"!=typeof b&&(c=b,b=""),"string"==typeof a?$(a,c?c.treeObj.get(0).ownerDocument:null):$("#"+a.tId+b,c?c.treeObj:null)},getMDom:function(a,b,c){if(!b)return null;for(;b&&b.id!==a.treeId;){for(var d=0,e=c.length;b.tagName&&e>d;d++)if(tools.eqs(b.tagName,c[d].tagName)&&null!==b.getAttribute(c[d].attrName))return b;b=b.parentNode}return null},getNodeMainDom:function(a){return $(a).parent("li").get(0)||$(a).parentsUntil("li").parent().get(0)},uCanDo:function(){return!0}},view={addNodes:function(a,b,c,d){if(!a.data.keep.leaf||!b||b.isParent)if(tools.isArray(c)||(c=[c]),a.data.simpleData.enable&&(c=data.transformTozTreeFormat(a,c)),b){var e=$$(b,consts.id.SWITCH,a),f=$$(b,consts.id.ICON,a),g=$$(b,consts.id.UL,a);b.open||(view.replaceSwitchClass(b,e,consts.folder.CLOSE),view.replaceIcoClass(b,f,consts.folder.CLOSE),b.open=!1,g.css({display:"none"})),data.addNodesData(a,b,c),view.createNodes(a,b.level+1,c,b),d||view.expandCollapseParentNode(a,b,!0)}else data.addNodesData(a,data.getRoot(a),c),view.createNodes(a,0,c,null)},appendNodes:function(a,b,c,d,e,f){if(!c)return[];for(var g=[],h=a.data.key.children,i=0,j=c.length;j>i;i++){var k=c[i];if(e){var l=d?d:data.getRoot(a),m=l[h],n=m.length==c.length&&0==i,o=i==c.length-1;data.initNode(a,b,k,d,n,o,f),data.addNodeCache(a,k)}var p=[];k[h]&&k[h].length>0&&(p=view.appendNodes(a,b+1,k[h],k,e,f&&k.open)),f&&(view.makeDOMNodeMainBefore(g,a,k),view.makeDOMNodeLine(g,a,k),data.getBeforeA(a,k,g),view.makeDOMNodeNameBefore(g,a,k),data.getInnerBeforeA(a,k,g),view.makeDOMNodeIcon(g,a,k),data.getInnerAfterA(a,k,g),view.makeDOMNodeNameAfter(g,a,k),data.getAfterA(a,k,g),k.isParent&&k.open&&view.makeUlHtml(a,k,g,p.join("")),view.makeDOMNodeMainAfter(g,a,k),data.addCreatedNode(a,k))}return g},appendParentULDom:function(a,b){var c=[],d=$$(b,a);!d.get(0)&&b.parentTId&&(view.appendParentULDom(a,b.getParentNode()),d=$$(b,a));var e=$$(b,consts.id.UL,a);e.get(0)&&e.remove();var f=a.data.key.children,g=view.appendNodes(a,b.level+1,b[f],b,!1,!0);view.makeUlHtml(a,b,c,g.join("")),d.append(c.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,l;if(node&&!node.isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(0==tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0))return tools.apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=$$(node,consts.id.ICON,setting);icoObj.attr({style:"","class":consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={};for(i=0,l=setting.async.autoParam.length;node&&l>i;i++){var pKey=setting.async.autoParam[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}if(tools.isArray(setting.async.otherParam))for(i=0,l=setting.async.otherParam.length;l>i;i+=2)tmpParam[setting.async.otherParam[i]]=setting.async.otherParam[i+1];else for(var p in setting.async.otherParam)tmpParam[p]=setting.async.otherParam[p];var _tmpV=data.getRoot(setting)._ver;return $.ajax({contentType:setting.async.contentType,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:tmpParam,dataType:setting.async.dataType,success:function(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&0!=msg.length?"string"==typeof msg?eval("("+msg+")"):msg:[]}catch(err){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),view.setNodeLineIcos(setting,node),newNodes&&""!==newNodes?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,newNodes?tools.clone(newNodes):[],!!isSilent)):view.addNodes(setting,node,[],!!isSilent),setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),tools.apply(callback)}},error:function(a,b,c){_tmpV==data.getRoot(setting)._ver&&(node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,a,b,c]))}}),!0},cancelPreSelectedNode:function(a,b){for(var c=data.getRoot(a).curSelectedList,d=0,e=c.length-1;e>=d;e--)if((!b||b===c[e])&&($$(c[e],consts.id.A,a).removeClass(consts.node.CURSELECTED),b)){data.removeSelectedNode(a,b);break}b||(data.getRoot(a).curSelectedList=[])},createNodeCallback:function(a){if(a.callback.onNodeCreated||a.view.addDiyDom)for(var b=data.getRoot(a);b.createdNodes.length>0;){var c=b.createdNodes.shift();tools.apply(a.view.addDiyDom,[a.treeId,c]),a.callback.onNodeCreated&&a.treeObj.trigger(consts.event.NODECREATED,[a.treeId,c])}},createNodes:function(a,b,c,d){if(c&&0!=c.length){var e=data.getRoot(a),f=a.data.key.children,g=!d||d.open||!!$$(d[f][0],a).get(0);e.createdNodes=[];var h=view.appendNodes(a,b,c,d,!0,g);if(d){var i=$$(d,consts.id.UL,a);i.get(0)&&i.append(h.join(""))}else a.treeObj.append(h.join(""));view.createNodeCallback(a)}},destroy:function(a){a&&(data.initCache(a),data.initRoot(a),event.unbindTree(a),event.unbindEvent(a),a.treeObj.empty())},expandCollapseNode:function(a,b,c,d,e){var f=data.getRoot(a),g=a.data.key.children;if(!b)return void tools.apply(e,[]);if(f.expandTriggerFlag){var h=e;e=function(){h&&h(),b.open?a.treeObj.trigger(consts.event.EXPAND,[a.treeId,b]):a.treeObj.trigger(consts.event.COLLAPSE,[a.treeId,b])},f.expandTriggerFlag=!1}if(!b.open&&b.isParent&&(!$$(b,consts.id.UL,a).get(0)||b[g]&&b[g].length>0&&!$$(b[g][0],a).get(0))&&(view.appendParentULDom(a,b),view.createNodeCallback(a)),b.open==c)return void tools.apply(e,[]);var i=$$(b,consts.id.UL,a),j=$$(b,consts.id.SWITCH,a),k=$$(b,consts.id.ICON,a);b.isParent?(b.open=!b.open,b.iconOpen&&b.iconClose&&k.attr("style",view.makeNodeIcoStyle(a,b)),b.open?(view.replaceSwitchClass(b,j,consts.folder.OPEN),view.replaceIcoClass(b,k,consts.folder.OPEN),0==d||""==a.view.expandSpeed?(i.show(),tools.apply(e,[])):b[g]&&b[g].length>0?i.slideDown(a.view.expandSpeed,e):(i.show(),tools.apply(e,[]))):(view.replaceSwitchClass(b,j,consts.folder.CLOSE),view.replaceIcoClass(b,k,consts.folder.CLOSE),0!=d&&""!=a.view.expandSpeed&&b[g]&&b[g].length>0?i.slideUp(a.view.expandSpeed,e):(i.hide(),tools.apply(e,[])))):tools.apply(e,[])},expandCollapseParentNode:function(a,b,c,d,e){if(b){if(!b.parentTId)return void view.expandCollapseNode(a,b,c,d,e);view.expandCollapseNode(a,b,c,d),b.parentTId&&view.expandCollapseParentNode(a,b.getParentNode(),c,d,e)}},expandCollapseSonNode:function(a,b,c,d,e){var f=data.getRoot(a),g=a.data.key.children,h=b?b[g]:f[g],i=b?!1:d,j=data.getRoot(a).expandTriggerFlag;if(data.getRoot(a).expandTriggerFlag=!1,h)for(var k=0,l=h.length;l>k;k++)h[k]&&view.expandCollapseSonNode(a,h[k],c,i);data.getRoot(a).expandTriggerFlag=j,view.expandCollapseNode(a,b,c,d,e)},makeDOMNodeIcon:function(a,b,c){var d=data.getNodeName(b,c),e=b.view.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");a.push("<span id='",c.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(b,c),"' style='",view.makeNodeIcoStyle(b,c),"'></span><span id='",c.tId,consts.id.SPAN,"'>",e,"</span>")},makeDOMNodeLine:function(a,b,c){a.push("<span id='",c.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(b,c),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(a){a.push("</li>")},makeDOMNodeMainBefore:function(a,b,c){a.push("<li id='",c.tId,"' class='",consts.className.LEVEL,c.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(a){a.push("</a>")},makeDOMNodeNameBefore:function(a,b,c){var d=data.getNodeTitle(b,c),e=view.makeNodeUrl(b,c),f=view.makeNodeFontCss(b,c),g=[];for(var h in f)g.push(h,":",f[h],";");a.push("<a id='",c.tId,consts.id.A,"' class='",consts.className.LEVEL,c.level,"' treeNode",consts.id.A,' onclick="',c.click||"",'" ',null!=e&&e.length>0?"href='"+e+"'":""," target='",view.makeNodeTarget(c),"' style='",g.join(""),"'"),tools.apply(b.view.showTitle,[b.treeId,c],b.view.showTitle)&&d&&a.push("title='",d.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),a.push(">")},makeNodeFontCss:function(a,b){var c=tools.apply(a.view.fontCss,[a.treeId,b],a.view.fontCss);return c&&"function"!=typeof c?c:{}},makeNodeIcoClass:function(a,b){var c=["ico"];return b.isAjaxing||(c[0]=(b.iconSkin?b.iconSkin+"_":"")+c[0],c.push(b.isParent?b.open?consts.folder.OPEN:consts.folder.CLOSE:consts.folder.DOCU)),consts.className.BUTTON+" "+c.join("_")},makeNodeIcoStyle:function(a,b){var c=[];if(!b.isAjaxing){var d=b.isParent&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b.icon;d&&c.push("background:url(",d,") 0 0 no-repeat;"),0!=a.view.showIcon&&tools.apply(a.view.showIcon,[a.treeId,b],!0)||c.push("width:0px;height:0px;")}return c.join("")},makeNodeLineClass:function(a,b){var c=[];return c.push(a.view.showLine?0==b.level&&b.isFirstNode&&b.isLastNode?consts.line.ROOT:0==b.level&&b.isFirstNode?consts.line.ROOTS:b.isLastNode?consts.line.BOTTOM:consts.line.CENTER:consts.line.NOLINE),c.push(b.isParent?b.open?consts.folder.OPEN:consts.folder.CLOSE:consts.folder.DOCU),view.makeNodeLineClassEx(b)+c.join("_")},makeNodeLineClassEx:function(a){return consts.className.BUTTON+" "+consts.className.LEVEL+a.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(a){return a.target||"_blank"},makeNodeUrl:function(a,b){var c=a.data.key.url;return b[c]?b[c]:null},makeUlHtml:function(a,b,c,d){c.push("<ul id='",b.tId,consts.id.UL,"' class='",consts.className.LEVEL,b.level," ",view.makeUlLineClass(a,b),"' style='display:",b.open?"block":"none","'>"),c.push(d),c.push("</ul>")},makeUlLineClass:function(a,b){return a.view.showLine&&!b.isLastNode?consts.line.LINE:""},removeChildNodes:function(a,b){if(b){var c=a.data.key.children,d=b[c];if(d){for(var e=0,f=d.length;f>e;e++)data.removeNodeCache(a,d[e]);if(data.removeSelectedNode(a),delete b[c],a.data.keep.parent)$$(b,consts.id.UL,a).empty();else{b.isParent=!1,b.open=!1;var g=$$(b,consts.id.SWITCH,a),h=$$(b,consts.id.ICON,a);view.replaceSwitchClass(b,g,consts.folder.DOCU),view.replaceIcoClass(b,h,consts.folder.DOCU),$$(b,consts.id.UL,a).remove()}}}},setFirstNode:function(a,b){var c=a.data.key.children,d=b[c].length;d>0&&(b[c][0].isFirstNode=!0)},setLastNode:function(a,b){var c=a.data.key.children,d=b[c].length;d>0&&(b[c][d-1].isLastNode=!0)},removeNode:function(a,b){var c=data.getRoot(a),d=a.data.key.children,e=b.parentTId?b.getParentNode():c;if(b.isFirstNode=!1,b.isLastNode=!1,b.getPreNode=function(){return null},b.getNextNode=function(){return null},data.getNodeCache(a,b.tId)){$$(b,a).remove(),data.removeNodeCache(a,b),data.removeSelectedNode(a,b);for(var f=0,g=e[d].length;g>f;f++)if(e[d][f].tId==b.tId){e[d].splice(f,1);break}view.setFirstNode(a,e),view.setLastNode(a,e);var h,i,j,k=e[d].length;if(a.data.keep.parent||0!=k){if(a.view.showLine&&k>0){var l=e[d][k-1];if(h=$$(l,consts.id.UL,a),i=$$(l,consts.id.SWITCH,a),j=$$(l,consts.id.ICON,a),e==c)if(1==e[d].length)view.replaceSwitchClass(l,i,consts.line.ROOT);else{var m=$$(e[d][0],consts.id.SWITCH,a);view.replaceSwitchClass(e[d][0],m,consts.line.ROOTS),view.replaceSwitchClass(l,i,consts.line.BOTTOM)}else view.replaceSwitchClass(l,i,consts.line.BOTTOM);h.removeClass(consts.line.LINE)}}else e.isParent=!1,e.open=!1,h=$$(e,consts.id.UL,a),i=$$(e,consts.id.SWITCH,a),j=$$(e,consts.id.ICON,a),view.replaceSwitchClass(e,i,consts.folder.DOCU),view.replaceIcoClass(e,j,consts.folder.DOCU),h.css("display","none")}},replaceIcoClass:function(a,b,c){if(b&&!a.isAjaxing){var d=b.attr("class");if(void 0!=d){var e=d.split("_");switch(c){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:e[e.length-1]=c}b.attr("class",e.join("_"))}}},replaceSwitchClass:function(a,b,c){if(b){var d=b.attr("class");if(void 0!=d){var e=d.split("_");switch(c){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:e[0]=view.makeNodeLineClassEx(a)+c;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:e[1]=c}b.attr("class",e.join("_")),c!==consts.folder.DOCU?b.removeAttr("disabled"):b.attr("disabled","disabled")}}},selectNode:function(a,b,c){c||view.cancelPreSelectedNode(a),$$(b,consts.id.A,a).addClass(consts.node.CURSELECTED),data.addSelectedNode(a,b)},setNodeFontCss:function(a,b){var c=$$(b,consts.id.A,a),d=view.makeNodeFontCss(a,b);d&&c.css(d)},setNodeLineIcos:function(a,b){if(b){var c=$$(b,consts.id.SWITCH,a),d=$$(b,consts.id.UL,a),e=$$(b,consts.id.ICON,a),f=view.makeUlLineClass(a,b);0==f.length?d.removeClass(consts.line.LINE):d.addClass(f),c.attr("class",view.makeNodeLineClass(a,b)),b.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled"),e.removeAttr("style"),e.attr("style",view.makeNodeIcoStyle(a,b)),e.attr("class",view.makeNodeIcoClass(a,b))}},setNodeName:function(a,b){var c=data.getNodeTitle(a,b),d=$$(b,consts.id.SPAN,a);if(d.empty(),a.view.nameIsHTML?d.html(data.getNodeName(a,b)):d.text(data.getNodeName(a,b)),tools.apply(a.view.showTitle,[a.treeId,b],a.view.showTitle)){var e=$$(b,consts.id.A,a);e.attr("title",c?c:"")}},setNodeTarget:function(a,b){var c=$$(b,consts.id.A,a);c.attr("target",view.makeNodeTarget(b))},setNodeUrl:function(a,b){var c=$$(b,consts.id.A,a),d=view.makeNodeUrl(a,b);null==d||0==d.length?c.removeAttr("href"):c.attr("href",d)},switchNode:function(a,b){if(b.open||!tools.canAsync(a,b))view.expandCollapseNode(a,b,!b.open);else if(a.async.enable){if(!view.asyncNode(a,b))return void view.expandCollapseNode(a,b,!b.open)}else b&&view.expandCollapseNode(a,b,!b.open)}};window.cache=caches,$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(a){var b=data.getZTreeTools(a);return b?b:null},destroy:function(a){if(a&&a.length>0)view.destroy(data.getSetting(a));else for(var b in settings)view.destroy(settings[b])},init:function(a,b,c){var d=tools.clone(_setting);$.extend(!0,d,b),d.treeId=a.attr("id"),d.treeObj=a,d.treeObj.empty(),settings[d.treeId]=d,"undefined"==typeof document.body.style.maxHeight&&(d.view.expandSpeed=""),data.initRoot(d);var e=data.getRoot(d),f=d.data.key.children;c=c?tools.clone(tools.isArray(c)?c:[c]):[],e[f]=d.data.simpleData.enable?data.transformTozTreeFormat(d,c):c,data.initCache(d),event.unbindTree(d),event.bindTree(d),event.unbindEvent(d),event.bindEvent(d);var g={setting:d,addNodes:function(a,b,c){function e(){view.addNodes(d,a,f,1==c)}if(!b)return null;if(a||(a=null),a&&!a.isParent&&d.data.keep.leaf)return null;var f=tools.clone(tools.isArray(b)?b:[b]);return tools.canAsync(d,a)?view.asyncNode(d,a,c,e):e(),f},cancelSelectedNode:function(a){view.cancelPreSelectedNode(d,a)},destroy:function(){view.destroy(d)},expandAll:function(a){return a=!!a,view.expandCollapseSonNode(d,null,a,!0),a},expandNode:function(a,b,c,e,f){if(!a||!a.isParent)return null;if(b!==!0&&b!==!1&&(b=!a.open),f=!!f,f&&b&&0==tools.apply(d.callback.beforeExpand,[d.treeId,a],!0))return null;if(f&&!b&&0==tools.apply(d.callback.beforeCollapse,[d.treeId,a],!0))return null;if(b&&a.parentTId&&view.expandCollapseParentNode(d,a.getParentNode(),b,!1),b===a.open&&!c)return null;if(data.getRoot(d).expandTriggerFlag=f,!tools.canAsync(d,a)&&c)view.expandCollapseSonNode(d,a,b,!0,function(){if(e!==!1)try{$$(a,d).focus().blur()}catch(b){}});else if(a.open=!b,view.switchNode(this.setting,a),e!==!1)try{$$(a,d).focus().blur()}catch(g){}return b},getNodes:function(){return data.getNodes(d)},getNodeByParam:function(a,b,c){return a?data.getNodeByParam(d,c?c[d.data.key.children]:data.getNodes(d),a,b):null},getNodeByTId:function(a){return data.getNodeCache(d,a)},getNodesByParam:function(a,b,c){return a?data.getNodesByParam(d,c?c[d.data.key.children]:data.getNodes(d),a,b):null},getNodesByParamFuzzy:function(a,b,c){return a?data.getNodesByParamFuzzy(d,c?c[d.data.key.children]:data.getNodes(d),a,b):null},getNodesByFilter:function(a,b,c,e){return b=!!b,a&&"function"==typeof a?data.getNodesByFilter(d,c?c[d.data.key.children]:data.getNodes(d),a,b,e):b?null:[]},getNodeIndex:function(a){if(!a)return null;for(var b=d.data.key.children,c=a.parentTId?a.getParentNode():data.getRoot(d),e=0,f=c[b].length;f>e;e++)if(c[b][e]==a)return e;return-1},getSelectedNodes:function(){for(var a=[],b=data.getRoot(d).curSelectedList,c=0,e=b.length;e>c;c++)a.push(b[c]);return a},isSelectedNode:function(a){return data.isSelectedNode(d,a)},reAsyncChildNodes:function(a,b,c){if(this.setting.async.enable){var e=!a;if(e&&(a=data.getRoot(d)),"refresh"==b){for(var f=this.setting.data.key.children,g=0,h=a[f]?a[f].length:0;h>g;g++)data.removeNodeCache(d,a[f][g]);if(data.removeSelectedNode(d),a[f]=[],e)this.setting.treeObj.empty();else{var i=$$(a,consts.id.UL,d);i.empty()}}view.asyncNode(this.setting,e?null:a,!!c)}},refresh:function(){this.setting.treeObj.empty();var a=data.getRoot(d),b=a[d.data.key.children];data.initRoot(d),a[d.data.key.children]=b,data.initCache(d),view.createNodes(d,0,a[d.data.key.children])},removeChildNodes:function(a){if(!a)return null;var b=d.data.key.children,c=a[b];return view.removeChildNodes(d,a),c?c:null},removeNode:function(a,b){a&&(b=!!b,b&&0==tools.apply(d.callback.beforeRemove,[d.treeId,a],!0)||(view.removeNode(d,a),b&&this.setting.treeObj.trigger(consts.event.REMOVE,[d.treeId,a])))},selectNode:function(a,b){if(a&&tools.uCanDo(d)){if(b=d.view.selectedMulti&&b,a.parentTId)view.expandCollapseParentNode(d,a.getParentNode(),!0,!1,function(){try{$$(a,d).focus().blur()}catch(b){}});else try{$$(a,d).focus().blur()}catch(c){}view.selectNode(d,a,b)}},transformTozTreeNodes:function(a){return data.transformTozTreeFormat(d,a)},transformToArray:function(a){return data.transformToArrayFormat(d,a)},updateNode:function(a){if(a){var b=$$(a,d);b.get(0)&&tools.uCanDo(d)&&(view.setNodeName(d,a),view.setNodeTarget(d,a),view.setNodeUrl(d,a),view.setNodeLineIcos(d,a),view.setNodeFontCss(d,a))}}};return e.treeTools=g,data.setZTreeTools(d,g),e[f]&&e[f].length>0?view.createNodes(d,0,e[f]):d.async.enable&&d.async.url&&""!==d.async.url&&view.asyncNode(d),g}};var zt=$.fn.zTree,$$=tools.$,consts=zt.consts}(jQuery),function(a){var b={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},c={check:{enable:!1,autoCheckTrigger:!1,chkStyle:b.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:b.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},d=function(a){var b=v.getRoot(a);b.radioCheckedList=[]},e=function(){},f=function(a){var b=a.treeObj,c=t.event;b.bind(c.CHECK,function(b,c,d,e){s.apply(a.callback.onCheck,[c?c:b,d,e])})},g=function(a){var b=a.treeObj,c=t.event;b.unbind(c.CHECK)},h=function(a){var b=a.target,c=v.getSetting(a.data.treeId),d="",e=null,f="",g="",h=null,i=null;if(s.eqs(a.type,"mouseover")?c.check.enable&&s.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+t.id.CHECK)&&(d=s.getNodeMainDom(b).id,f="mouseoverCheck"):s.eqs(a.type,"mouseout")?c.check.enable&&s.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+t.id.CHECK)&&(d=s.getNodeMainDom(b).id,f="mouseoutCheck"):s.eqs(a.type,"click")&&c.check.enable&&s.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+t.id.CHECK)&&(d=s.getNodeMainDom(b).id,f="checkNode"),d.length>0)switch(e=v.getNodeCache(c,d),f){case"checkNode":h=n.onCheckNode;break;case"mouseoverCheck":h=n.onMouseoverCheck;break;case"mouseoutCheck":h=n.onMouseoutCheck}var j={stop:"checkNode"===f,node:e,nodeEventType:f,nodeEventCallback:h,treeEventType:g,treeEventCallback:i};return j},i=function(a,b,c,d){if(c){var e=a.data.key.checked;if("string"==typeof c[e]&&(c[e]=s.eqs(c[e],"true")),c[e]=!!c[e],c.checkedOld=c[e],"string"==typeof c.nocheck&&(c.nocheck=s.eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||a.check.nocheckInherit&&d&&!!d.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=s.eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||a.check.chkDisabledInherit&&d&&!!d.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=s.eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return v.getCheckStatus(a,c)},a.check.chkStyle==t.radio.STYLE&&a.check.radioType==t.radio.TYPE_ALL&&c[e]){var f=v.getRoot(a);f.radioCheckedList.push(c)}}},j=function(a,b,c){a.data.key.checked;a.check.enable&&(v.makeChkFlag(a,b),c.push("<span ID='",b.tId,t.id.CHECK,"' class='",u.makeChkClass(a,b),"' treeNode",t.id.CHECK,b.nocheck===!0?" style='display:none;'":"","></span>"))},k=function(a,b){b.checkNode=function(b,c,d,e){var f=a.data.key.checked;if(b.chkDisabled!==!0&&(c!==!0&&c!==!1&&(c=!b[f]),e=!!e,(b[f]!==c||d)&&(!e||0!=s.apply(this.setting.callback.beforeCheck,[a.treeId,b],!0))&&s.uCanDo(this.setting)&&a.check.enable&&b.nocheck!==!0)){b[f]=c;var g=w(b,t.id.CHECK,a);(d||a.check.chkStyle===t.radio.STYLE)&&u.checkNodeRelation(a,b),u.setChkClass(a,g,b),u.repairParentChkClassWithSelf(a,b),e&&a.treeObj.trigger(t.event.CHECK,[null,a.treeId,b])}},b.checkAllNodes=function(b){u.repairAllChk(a,!!b)},b.getCheckedNodes=function(b){var c=a.data.key.children;return b=b!==!1,v.getTreeCheckedNodes(a,v.getRoot(a)[c],b)},b.getChangeCheckedNodes=function(){var b=a.data.key.children;return v.getTreeChangeCheckedNodes(a,v.getRoot(a)[b])},b.setChkDisabled=function(b,c,d,e){c=!!c,d=!!d,e=!!e,u.repairSonChkDisabled(a,b,c,e),u.repairParentChkDisabled(a,b.getParentNode(),c,d)};var c=b.updateNode;b.updateNode=function(d,e){if(c&&c.apply(b,arguments),d&&a.check.enable){var f=w(d,a);if(f.get(0)&&s.uCanDo(a)){var g=w(d,t.id.CHECK,a);(1==e||a.check.chkStyle===t.radio.STYLE)&&u.checkNodeRelation(a,d),u.setChkClass(a,g,d),u.repairParentChkClassWithSelf(a,d)}}}},l={getRadioCheckedList:function(a){for(var b=v.getRoot(a).radioCheckedList,c=0,d=b.length;d>c;c++)v.getNodeCache(a,b[c].tId)||(b.splice(c,1),c--,d--);return b},getCheckStatus:function(a,b){if(!a.check.enable||b.nocheck||b.chkDisabled)return null;var c=a.data.key.checked,d={checked:b[c],half:b.halfCheck?b.halfCheck:a.check.chkStyle==t.radio.STYLE?2===b.check_Child_State:b[c]?b.check_Child_State>-1&&b.check_Child_State<2:b.check_Child_State>0};return d},getTreeCheckedNodes:function(a,b,c,d){if(!b)return[];var e=a.data.key.children,f=a.data.key.checked,g=c&&a.check.chkStyle==t.radio.STYLE&&a.check.radioType==t.radio.TYPE_ALL;d=d?d:[];for(var h=0,i=b.length;i>h&&(b[h].nocheck===!0||b[h].chkDisabled===!0||b[h][f]!=c||(d.push(b[h]),!g))&&(v.getTreeCheckedNodes(a,b[h][e],c,d),!(g&&d.length>0));h++);return d},getTreeChangeCheckedNodes:function(a,b,c){if(!b)return[];var d=a.data.key.children,e=a.data.key.checked;c=c?c:[];for(var f=0,g=b.length;g>f;f++)b[f].nocheck!==!0&&b[f].chkDisabled!==!0&&b[f][e]!=b[f].checkedOld&&c.push(b[f]),v.getTreeChangeCheckedNodes(a,b[f][d],c);return c},makeChkFlag:function(a,b){if(b){var c=a.data.key.children,d=a.data.key.checked,e=-1;if(b[c])for(var f=0,g=b[c].length;g>f;f++){var h=b[c][f],i=-1;if(a.check.chkStyle==t.radio.STYLE){if(i=h.nocheck===!0||h.chkDisabled===!0?h.check_Child_State:h.halfCheck===!0?2:h[d]?2:h.check_Child_State>0?2:0,2==i){e=2;break}0==i&&(e=0)}else if(a.check.chkStyle==t.checkbox.STYLE){if(i=h.nocheck===!0||h.chkDisabled===!0?h.check_Child_State:h.halfCheck===!0?1:h[d]?-1===h.check_Child_State||2===h.check_Child_State?2:1:h.check_Child_State>0?1:0,1===i){e=1;break}if(2===i&&e>-1&&f>0&&i!==e){e=1;break}if(2===e&&i>-1&&2>i){e=1;break}i>-1&&(e=i)}}b.check_Child_State=e}}},m={},n={onCheckNode:function(a,b){if(b.chkDisabled===!0)return!1;var c=v.getSetting(a.data.treeId),d=c.data.key.checked;if(0==s.apply(c.callback.beforeCheck,[c.treeId,b],!0))return!0;b[d]=!b[d],u.checkNodeRelation(c,b);var e=w(b,t.id.CHECK,c);return u.setChkClass(c,e,b),u.repairParentChkClassWithSelf(c,b),c.treeObj.trigger(t.event.CHECK,[a,c.treeId,b]),!0},onMouseoverCheck:function(a,b){if(b.chkDisabled===!0)return!1;var c=v.getSetting(a.data.treeId),d=w(b,t.id.CHECK,c);return b.check_Focus=!0,u.setChkClass(c,d,b),!0},onMouseoutCheck:function(a,b){if(b.chkDisabled===!0)return!1;var c=v.getSetting(a.data.treeId),d=w(b,t.id.CHECK,c);return b.check_Focus=!1,u.setChkClass(c,d,b),!0}},o={},p={checkNodeRelation:function(a,b){var c,d,e,f=a.data.key.children,g=a.data.key.checked,h=t.radio;if(a.check.chkStyle==h.STYLE){var i=v.getRadioCheckedList(a);if(b[g])if(a.check.radioType==h.TYPE_ALL){for(d=i.length-1;d>=0;d--)c=i[d],c[g]=!1,i.splice(d,1),u.setChkClass(a,w(c,t.id.CHECK,a),c),c.parentTId!=b.parentTId&&u.repairParentChkClassWithSelf(a,c);i.push(b)}else{var j=b.parentTId?b.getParentNode():v.getRoot(a);for(d=0,e=j[f].length;e>d;d++)c=j[f][d],c[g]&&c!=b&&(c[g]=!1,u.setChkClass(a,w(c,t.id.CHECK,a),c))}else if(a.check.radioType==h.TYPE_ALL)for(d=0,e=i.length;e>d;d++)if(b==i[d]){i.splice(d,1);break}}else b[g]&&(!b[f]||0==b[f].length||a.check.chkboxType.Y.indexOf("s")>-1)&&u.setSonNodeCheckBox(a,b,!0),b[g]||b[f]&&0!=b[f].length&&!(a.check.chkboxType.N.indexOf("s")>-1)||u.setSonNodeCheckBox(a,b,!1),b[g]&&a.check.chkboxType.Y.indexOf("p")>-1&&u.setParentNodeCheckBox(a,b,!0),!b[g]&&a.check.chkboxType.N.indexOf("p")>-1&&u.setParentNodeCheckBox(a,b,!1)},makeChkClass:function(a,b){var c=a.data.key.checked,d=t.checkbox,e=t.radio,f="";f=b.chkDisabled===!0?d.DISABLED:b.halfCheck?d.PART:a.check.chkStyle==e.STYLE?b.check_Child_State<1?d.FULL:d.PART:b[c]?2===b.check_Child_State||-1===b.check_Child_State?d.FULL:d.PART:b.check_Child_State<1?d.FULL:d.PART;var g=a.check.chkStyle+"_"+(b[c]?d.TRUE:d.FALSE)+"_"+f;return g=b.check_Focus&&b.chkDisabled!==!0?g+"_"+d.FOCUS:g,t.className.BUTTON+" "+d.DEFAULT+" "+g},repairAllChk:function(a,b){if(a.check.enable&&a.check.chkStyle===t.checkbox.STYLE)for(var c=a.data.key.checked,d=a.data.key.children,e=v.getRoot(a),f=0,g=e[d].length;g>f;f++){var h=e[d][f];h.nocheck!==!0&&h.chkDisabled!==!0&&(h[c]=b),u.setSonNodeCheckBox(a,h,b)}},repairChkClass:function(a,b){if(b&&(v.makeChkFlag(a,b),b.nocheck!==!0)){var c=w(b,t.id.CHECK,a);u.setChkClass(a,c,b)}},repairParentChkClass:function(a,b){if(b&&b.parentTId){var c=b.getParentNode();u.repairChkClass(a,c),u.repairParentChkClass(a,c)}},repairParentChkClassWithSelf:function(a,b){if(b){var c=a.data.key.children;b[c]&&b[c].length>0?u.repairParentChkClass(a,b[c][0]):u.repairParentChkClass(a,b)}},repairSonChkDisabled:function(a,b,c,d){if(b){var e=a.data.key.children;if(b.chkDisabled!=c&&(b.chkDisabled=c),u.repairChkClass(a,b),b[e]&&d)for(var f=0,g=b[e].length;g>f;f++){var h=b[e][f];u.repairSonChkDisabled(a,h,c,d)}}},repairParentChkDisabled:function(a,b,c,d){b&&(b.chkDisabled!=c&&d&&(b.chkDisabled=c),u.repairChkClass(a,b),u.repairParentChkDisabled(a,b.getParentNode(),c,d))},setChkClass:function(a,b,c){b&&(c.nocheck===!0?b.hide():b.show(),b.removeClass(),b.addClass(u.makeChkClass(a,c)))},setParentNodeCheckBox:function(a,b,c,d){var e=a.data.key.children,f=a.data.key.checked,g=w(b,t.id.CHECK,a);if(d||(d=b),v.makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0&&(b[f]=c,u.setChkClass(a,g,b),a.check.autoCheckTrigger&&b!=d&&a.treeObj.trigger(t.event.CHECK,[null,a.treeId,b])),b.parentTId){var h=!0;if(!c)for(var i=b.getParentNode()[e],j=0,k=i.length;k>j;j++)if(i[j].nocheck!==!0&&i[j].chkDisabled!==!0&&i[j][f]||(i[j].nocheck===!0||i[j].chkDisabled===!0)&&i[j].check_Child_State>0){h=!1;break}h&&u.setParentNodeCheckBox(a,b.getParentNode(),c,d)}},setSonNodeCheckBox:function(a,b,c,d){if(b){var e=a.data.key.children,f=a.data.key.checked,g=w(b,t.id.CHECK,a);d||(d=b);var h=!1;if(b[e])for(var i=0,j=b[e].length;j>i&&b.chkDisabled!==!0;i++){var k=b[e][i];u.setSonNodeCheckBox(a,k,c,d),k.chkDisabled===!0&&(h=!0)}b!=v.getRoot(a)&&b.chkDisabled!==!0&&(h&&b.nocheck!==!0&&v.makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0?(b[f]=c,h||(b.check_Child_State=b[e]&&b[e].length>0?c?2:0:-1)):b.check_Child_State=-1,u.setChkClass(a,g,b),a.check.autoCheckTrigger&&b!=d&&b.nocheck!==!0&&b.chkDisabled!==!0&&a.treeObj.trigger(t.event.CHECK,[null,a.treeId,b]))}}},q={tools:o,view:p,event:m,data:l};a.extend(!0,a.fn.zTree.consts,b),a.extend(!0,a.fn.zTree._z,q);var r=a.fn.zTree,s=r._z.tools,t=r.consts,u=r._z.view,v=r._z.data,w=(r._z.event,s.$);v.exSetting(c),v.addInitBind(f),v.addInitUnBind(g),v.addInitCache(e),v.addInitNode(i),v.addInitProxy(h,!0),v.addInitRoot(d),v.addBeforeA(j),v.addZTreeTools(k);var x=u.createNodes;u.createNodes=function(a,b,c,d){x&&x.apply(u,arguments),c&&u.repairParentChkClassWithSelf(a,d)
};var y=u.removeNode;u.removeNode=function(a,b){var c=b.getParentNode();y&&y.apply(u,arguments),b&&c&&(u.repairChkClass(a,c),u.repairParentChkClass(a,c))};var z=u.appendNodes;u.appendNodes=function(a,b,c,d){var e="";return z&&(e=z.apply(u,arguments)),d&&v.makeChkFlag(a,d),e}}(jQuery),function(a){var b={event:{DRAG:"ztree_drag",DROP:"ztree_drop",REMOVE:"ztree_remove",RENAME:"ztree_rename"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},c={edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDrop:null,onRename:null}},d=function(a){var b=u.getRoot(a),c=u.getRoots();b.curEditNode=null,b.curEditInput=null,b.curHoverNode=null,b.dragFlag=0,b.dragNodeShowBefore=[],b.dragMaskList=new Array,c.showHoverDom=!0},e=function(){},f=function(a){var b=a.treeObj,c=s.event;b.bind(c.RENAME,function(b,c,d,e){r.apply(a.callback.onRename,[b,c,d,e])}),b.bind(c.REMOVE,function(b,c,d){r.apply(a.callback.onRemove,[b,c,d])}),b.bind(c.DRAG,function(b,c,d,e){r.apply(a.callback.onDrag,[c,d,e])}),b.bind(c.DROP,function(b,c,d,e,f,g,h){r.apply(a.callback.onDrop,[c,d,e,f,g,h])})},g=function(a){var b=a.treeObj,c=s.event;b.unbind(c.RENAME),b.unbind(c.REMOVE),b.unbind(c.DRAG),b.unbind(c.DROP)},h=function(a){var b=a.target,c=u.getSetting(a.data.treeId),d=a.relatedTarget,e="",f=null,g="",h="",i=null,j=null,k=null;if(r.eqs(a.type,"mouseover")?(k=r.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+s.id.A}]),k&&(e=r.getNodeMainDom(k).id,g="hoverOverNode")):r.eqs(a.type,"mouseout")?(k=r.getMDom(c,d,[{tagName:"a",attrName:"treeNode"+s.id.A}]),k||(e="remove",g="hoverOutNode")):r.eqs(a.type,"mousedown")&&(k=r.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+s.id.A}]),k&&(e=r.getNodeMainDom(k).id,g="mousedownNode")),e.length>0)switch(f=u.getNodeCache(c,e),g){case"mousedownNode":i=m.onMousedownNode;break;case"hoverOverNode":i=m.onHoverOverNode;break;case"hoverOutNode":i=m.onHoverOutNode}var l={stop:!1,node:f,nodeEventType:g,nodeEventCallback:i,treeEventType:h,treeEventCallback:j};return l},i=function(a,b,c){c&&(c.isHover=!1,c.editNameFlag=!1)},j=function(a,b){b.cancelEditName=function(b){var c=u.getRoot(a),d=a.data.key.name,e=c.curEditNode;c.curEditNode&&t.cancelCurEditNode(a,b?b:e[d])},b.copyNode=function(b,c,d,e){function f(){t.addNodes(a,b,[g],e)}if(!c)return null;if(b&&!b.isParent&&a.data.keep.leaf&&d===s.move.TYPE_INNER)return null;var g=r.clone(c);return b||(b=null,d=s.move.TYPE_INNER),d==s.move.TYPE_INNER?r.canAsync(a,b)?t.asyncNode(a,b,e,f):f():(t.addNodes(a,b.parentNode,[g],e),t.moveNode(a,b,g,d,!1,e)),g},b.editName=function(b){b&&b.tId&&b===u.getNodeCache(a,b.tId)&&(b.parentTId&&t.expandCollapseParentNode(a,b.getParentNode(),!0),t.editNode(a,b))},b.moveNode=function(b,c,d,e){function f(){t.moveNode(a,b,c,d,!1,e)}return c?b&&!b.isParent&&a.data.keep.leaf&&d===s.move.TYPE_INNER?null:b&&(c.parentTId==b.tId&&d==s.move.TYPE_INNER||v(c,a).find("#"+b.tId).length>0)?null:(b||(b=null),r.canAsync(a,b)&&d===s.move.TYPE_INNER?t.asyncNode(a,b,e,f):f(),c):c},b.setEditable=function(b){return a.edit.enable=b,this.refresh()}},k={setSonNodeLevel:function(a,b,c){if(c){var d=a.data.key.children;if(c.level=b?b.level+1:0,c[d])for(var e=0,f=c[d].length;f>e;e++)c[d][e]&&u.setSonNodeLevel(a,c,c[d][e])}}},l={},m={onHoverOverNode:function(a,b){var c=u.getSetting(a.data.treeId),d=u.getRoot(c);d.curHoverNode!=b&&m.onHoverOutNode(a),d.curHoverNode=b,t.addHoverDom(c,b)},onHoverOutNode:function(a){var b=u.getSetting(a.data.treeId),c=u.getRoot(b);c.curHoverNode&&!u.isSelectedNode(b,c.curHoverNode)&&(t.removeTreeDom(b,c.curHoverNode),c.curHoverNode=null)},onMousedownNode:function(c,d){function e(c){if(0==k.dragFlag&&Math.abs(I-c.clientX)<j.edit.drag.minMoveSize&&Math.abs(J-c.clientY)<j.edit.drag.minMoveSize)return!0;var d,e,g,h,i,m=j.data.key.children;if(A.css("cursor","pointer"),0==k.dragFlag){if(0==r.apply(j.callback.beforeDrag,[j.treeId,o],!0))return f(c),!0;for(d=0,e=o.length;e>d;d++)0==d&&(k.dragNodeShowBefore=[]),g=o[d],g.isParent&&g.open?(t.expandCollapseNode(j,g,!g.open),k.dragNodeShowBefore[g.tId]=!0):k.dragNodeShowBefore[g.tId]=!1;k.dragFlag=1,l.showHoverDom=!1,r.showIfameMask(j,!0);var n=!0,D=-1;if(o.length>1){var L=o[0].parentTId?o[0].getParentNode()[m]:u.getNodes(j);for(i=[],d=0,e=L.length;e>d;d++)if(void 0!==k.dragNodeShowBefore[L[d].tId]&&(n&&D>-1&&D+1!==d&&(n=!1),i.push(L[d]),D=d),o.length===i.length){o=i;break}}for(n&&(x=o[0].getPreNode(),y=o[o.length-1].getNextNode()),p=v("<ul class='zTreeDragUL'></ul>",j),d=0,e=o.length;e>d;d++)if(g=o[d],g.editNameFlag=!1,t.selectNode(j,g,d>0),t.removeTreeDom(j,g),h=v("<li id='"+g.tId+"_tmp'></li>",j),h.append(v(g,s.id.A,j).clone()),h.css("padding","0"),h.children("#"+g.tId+s.id.A).removeClass(s.node.CURSELECTED),p.append(h),d==j.edit.drag.maxShowNodeNum-1){h=v("<li id='"+g.tId+"_moretmp'><a> ... </a></li>",j),p.append(h);break}p.attr("id",o[0].tId+s.id.UL+"_tmp"),p.addClass(j.treeObj.attr("class")),p.appendTo(A),q=v("<span class='tmpzTreeMove_arrow'></span>",j),q.attr("id","zTreeMove_arrow_tmp"),q.appendTo(A),j.treeObj.trigger(s.event.DRAG,[c,j.treeId,o])}if(1==k.dragFlag){if(w&&q.attr("id")==c.target.id&&G&&c.clientX+z.scrollLeft()+2>a("#"+G+s.id.A,w).offset().left){var M=a("#"+G+s.id.A,w);c.target=M.length>0?M.get(0):c.target}else w&&(w.removeClass(s.node.TMPTARGET_TREE),G&&a("#"+G+s.id.A,w).removeClass(s.node.TMPTARGET_NODE+"_"+s.move.TYPE_PREV).removeClass(s.node.TMPTARGET_NODE+"_"+b.move.TYPE_NEXT).removeClass(s.node.TMPTARGET_NODE+"_"+b.move.TYPE_INNER));w=null,G=null,B=!1,C=j;var N=u.getSettings();for(var O in N)N[O].treeId&&N[O].edit.enable&&N[O].treeId!=j.treeId&&(c.target.id==N[O].treeId||a(c.target).parents("#"+N[O].treeId).length>0)&&(B=!0,C=N[O]);var P=z.scrollTop(),Q=z.scrollLeft(),R=C.treeObj.offset(),S=C.treeObj.get(0).scrollHeight,T=C.treeObj.get(0).scrollWidth,U=c.clientY+P-R.top,V=C.treeObj.height()+R.top-c.clientY-P,W=c.clientX+Q-R.left,X=C.treeObj.width()+R.left-c.clientX-Q,Y=U<j.edit.drag.borderMax&&U>j.edit.drag.borderMin,Z=V<j.edit.drag.borderMax&&V>j.edit.drag.borderMin,$=W<j.edit.drag.borderMax&&W>j.edit.drag.borderMin,_=X<j.edit.drag.borderMax&&X>j.edit.drag.borderMin,ab=U>j.edit.drag.borderMin&&V>j.edit.drag.borderMin&&W>j.edit.drag.borderMin&&X>j.edit.drag.borderMin,bb=Y&&C.treeObj.scrollTop()<=0,cb=Z&&C.treeObj.scrollTop()+C.treeObj.height()+10>=S,db=$&&C.treeObj.scrollLeft()<=0,eb=_&&C.treeObj.scrollLeft()+C.treeObj.width()+10>=T;if(c.target.id&&C.treeObj.find("#"+c.target.id).length>0){for(var fb=c.target;fb&&fb.tagName&&!r.eqs(fb.tagName,"li")&&fb.id!=C.treeId;)fb=fb.parentNode;var gb=!0;for(d=0,e=o.length;e>d;d++){if(g=o[d],fb.id===g.tId){gb=!1;break}if(v(g,j).find("#"+fb.id).length>0){gb=!1;break}}gb&&c.target.id&&(c.target.id==fb.id+s.id.A||a(c.target).parents("#"+fb.id+s.id.A).length>0)&&(w=a(fb),G=fb.id)}g=o[0],ab&&(c.target.id==C.treeId||a(c.target).parents("#"+C.treeId).length>0)&&(!w&&(c.target.id==C.treeId||bb||cb||db||eb)&&(B||!B&&g.parentTId)&&(w=C.treeObj),Y?C.treeObj.scrollTop(C.treeObj.scrollTop()-10):Z&&C.treeObj.scrollTop(C.treeObj.scrollTop()+10),$?C.treeObj.scrollLeft(C.treeObj.scrollLeft()-10):_&&C.treeObj.scrollLeft(C.treeObj.scrollLeft()+10),w&&w!=C.treeObj&&w.offset().left<C.treeObj.offset().left&&C.treeObj.scrollLeft(C.treeObj.scrollLeft()+w.offset().left-C.treeObj.offset().left)),p.css({top:c.clientY+P+3+"px",left:c.clientX+Q+3+"px"});var hb=0,ib=0;if(w&&w.attr("id")!=C.treeId){var jb=null==G?null:u.getNodeCache(C,G),kb=c.ctrlKey&&j.edit.drag.isMove&&j.edit.drag.isCopy||!j.edit.drag.isMove&&j.edit.drag.isCopy,lb=!(!x||G!==x.tId),mb=!(!y||G!==y.tId),nb=g.parentTId&&g.parentTId==G,ob=(kb||!mb)&&r.apply(C.edit.drag.prev,[C.treeId,o,jb],!!C.edit.drag.prev),pb=(kb||!lb)&&r.apply(C.edit.drag.next,[C.treeId,o,jb],!!C.edit.drag.next),qb=!(!kb&&nb||C.data.keep.leaf&&!jb.isParent||!r.apply(C.edit.drag.inner,[C.treeId,o,jb],!!C.edit.drag.inner));if(ob||pb||qb){var rb=a("#"+G+s.id.A,w),sb=jb.isLastNode?null:a("#"+jb.getNextNode().tId+s.id.A,w.next()),tb=rb.offset().top,ub=rb.offset().left,vb=ob?qb?.25:pb?.5:1:-1,wb=pb?qb?.75:ob?.5:0:-1,xb=(c.clientY+P-tb)/rb.height();if((1==vb||vb>=xb&&xb>=-.2)&&ob?(hb=1-q.width(),ib=tb-q.height()/2,H=s.move.TYPE_PREV):(0==wb||xb>=wb&&1.2>=xb)&&pb?(hb=1-q.width(),ib=null==sb||jb.isParent&&jb.open?tb+rb.height()-q.height()/2:sb.offset().top-q.height()/2,H=s.move.TYPE_NEXT):(hb=5-q.width(),ib=tb,H=s.move.TYPE_INNER),q.css({display:"block",top:ib+"px",left:ub+hb+"px"}),rb.addClass(s.node.TMPTARGET_NODE+"_"+H),(E!=G||F!=H)&&(K=(new Date).getTime()),jb&&jb.isParent&&H==s.move.TYPE_INNER){var yb=!0;window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==jb.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===jb.tId&&(yb=!1),yb&&(window.zTreeMoveTimer=setTimeout(function(){H==s.move.TYPE_INNER&&jb&&jb.isParent&&!jb.open&&(new Date).getTime()-K>C.edit.drag.autoOpenTime&&r.apply(C.callback.beforeDragOpen,[C.treeId,jb],!0)&&(t.switchNode(C,jb),C.edit.drag.autoExpandTrigger&&C.treeObj.trigger(s.event.EXPAND,[C.treeId,jb]))},C.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=jb.tId)}}else w=null,G="",H=s.move.TYPE_INNER,q.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}else H=s.move.TYPE_INNER,w&&r.apply(C.edit.drag.inner,[C.treeId,o,null],!!C.edit.drag.inner)?w.addClass(s.node.TMPTARGET_TREE):w=null,q.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);E=G,F=H}return!1}function f(c){function d(){if(B){if(!n)for(var a=0,b=o.length;b>a;a++)t.removeNode(j,o[a]);if(H==s.move.TYPE_INNER)t.addNodes(C,x,y);else if(t.addNodes(C,x.getParentNode(),y),H==s.move.TYPE_PREV)for(a=0,b=y.length;b>a;a++)t.moveNode(C,x,y[a],H,!1);else for(a=-1,b=y.length-1;b>a;b--)t.moveNode(C,x,y[b],H,!1)}else if(n&&H==s.move.TYPE_INNER)t.addNodes(C,x,y);else if(n&&t.addNodes(C,x.getParentNode(),y),H!=s.move.TYPE_NEXT)for(a=0,b=y.length;b>a;a++)t.moveNode(C,x,y[a],H,!1);else for(a=-1,b=y.length-1;b>a;b--)t.moveNode(C,x,y[b],H,!1);t.selectNodes(C,y),v(y[0],j).focus().blur(),j.treeObj.trigger(s.event.DROP,[c,C.treeId,y,x,H,n])}if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),E=null,F=null,z.unbind("mousemove",e),z.unbind("mouseup",f),z.unbind("selectstart",g),A.css("cursor","auto"),w&&(w.removeClass(s.node.TMPTARGET_TREE),G&&a("#"+G+s.id.A,w).removeClass(s.node.TMPTARGET_NODE+"_"+s.move.TYPE_PREV).removeClass(s.node.TMPTARGET_NODE+"_"+b.move.TYPE_NEXT).removeClass(s.node.TMPTARGET_NODE+"_"+b.move.TYPE_INNER)),r.showIfameMask(j,!1),l.showHoverDom=!0,0!=k.dragFlag){k.dragFlag=0;var h,i,m;for(h=0,i=o.length;i>h;h++)m=o[h],m.isParent&&k.dragNodeShowBefore[m.tId]&&!m.open&&(t.expandCollapseNode(j,m,!m.open),delete k.dragNodeShowBefore[m.tId]);p&&p.remove(),q&&q.remove();var n=c.ctrlKey&&j.edit.drag.isMove&&j.edit.drag.isCopy||!j.edit.drag.isMove&&j.edit.drag.isCopy;if(!n&&w&&G&&o[0].parentTId&&G==o[0].parentTId&&H==s.move.TYPE_INNER&&(w=null),w){var x=null==G?null:u.getNodeCache(C,G);if(0==r.apply(j.callback.beforeDrop,[C.treeId,o,x,H,n],!0))return void t.selectNodes(D,o);var y=n?r.clone(o):o;H==s.move.TYPE_INNER&&r.canAsync(C,x)?t.asyncNode(C,x,!1,d):d()}else t.selectNodes(D,o),j.treeObj.trigger(s.event.DROP,[c,j.treeId,o,null,null,null])}}function g(){return!1}var h,i,j=u.getSetting(c.data.treeId),k=u.getRoot(j),l=u.getRoots();if(2==c.button||!j.edit.enable||!j.edit.drag.isCopy&&!j.edit.drag.isMove)return!0;var m=c.target,n=u.getRoot(j).curSelectedList,o=[];if(u.isSelectedNode(j,d))for(h=0,i=n.length;i>h;h++){if(n[h].editNameFlag&&r.eqs(m.tagName,"input")&&null!==m.getAttribute("treeNode"+s.id.INPUT))return!0;if(o.push(n[h]),o[0].parentTId!==n[h].parentTId){o=[d];break}}else o=[d];t.editNodeBlur=!0,t.cancelCurEditNode(j);var p,q,w,x,y,z=a(j.treeObj.get(0).ownerDocument),A=a(j.treeObj.get(0).ownerDocument.body),B=!1,C=j,D=j,E=null,F=null,G=null,H=s.move.TYPE_INNER,I=c.clientX,J=c.clientY,K=(new Date).getTime();return r.uCanDo(j)&&z.bind("mousemove",e),z.bind("mouseup",f),z.bind("selectstart",g),c.preventDefault&&c.preventDefault(),!0}},n={getAbs:function(a){var b=a.getBoundingClientRect(),c=document.body.scrollTop+document.documentElement.scrollTop,d=document.body.scrollLeft+document.documentElement.scrollLeft;return[b.left+d,b.top+c]},inputFocus:function(a){a.get(0)&&(a.focus(),r.setCursorPosition(a.get(0),a.val().length))},inputSelect:function(a){a.get(0)&&(a.focus(),a.select())},setCursorPosition:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},showIfameMask:function(a,b){for(var c=u.getRoot(a);c.dragMaskList.length>0;)c.dragMaskList[0].remove(),c.dragMaskList.shift();if(b)for(var d=v("iframe",a),e=0,f=d.length;f>e;e++){var g=d.get(e),h=r.getAbs(g),i=v("<div id='zTreeMask_"+e+"' class='zTreeMask' style='top:"+h[1]+"px; left:"+h[0]+"px; width:"+g.offsetWidth+"px; height:"+g.offsetHeight+"px;'></div>",a);i.appendTo(v("body",a)),c.dragMaskList.push(i)}}},o={addEditBtn:function(a,b){if(!(b.editNameFlag||v(b,s.id.EDIT,a).length>0)&&r.apply(a.edit.showRenameBtn,[a.treeId,b],a.edit.showRenameBtn)){var c=v(b,s.id.A,a),d="<span class='"+s.className.BUTTON+" edit' id='"+b.tId+s.id.EDIT+"' title='"+r.apply(a.edit.renameTitle,[a.treeId,b],a.edit.renameTitle)+"' treeNode"+s.id.EDIT+" style='display:none;'></span>";c.append(d),v(b,s.id.EDIT,a).bind("click",function(){return r.uCanDo(a)&&0!=r.apply(a.callback.beforeEditName,[a.treeId,b],!0)?(t.editNode(a,b),!1):!1}).show()}},addRemoveBtn:function(a,b){if(!(b.editNameFlag||v(b,s.id.REMOVE,a).length>0)&&r.apply(a.edit.showRemoveBtn,[a.treeId,b],a.edit.showRemoveBtn)){var c=v(b,s.id.A,a),d="<span class='"+s.className.BUTTON+" remove' id='"+b.tId+s.id.REMOVE+"' title='"+r.apply(a.edit.removeTitle,[a.treeId,b],a.edit.removeTitle)+"' treeNode"+s.id.REMOVE+" style='display:none;'></span>";c.append(d),v(b,s.id.REMOVE,a).bind("click",function(){return r.uCanDo(a)&&0!=r.apply(a.callback.beforeRemove,[a.treeId,b],!0)?(t.removeNode(a,b),a.treeObj.trigger(s.event.REMOVE,[a.treeId,b]),!1):!1}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(a,b){u.getRoots().showHoverDom&&(b.isHover=!0,a.edit.enable&&(t.addEditBtn(a,b),t.addRemoveBtn(a,b)),r.apply(a.view.addHoverDom,[a.treeId,b]))},cancelCurEditNode:function(a,b){var c=u.getRoot(a),d=a.data.key.name,e=c.curEditNode;if(e){var f=c.curEditInput,g=b?b:f.val(),h=!!b;if(r.apply(a.callback.beforeRename,[a.treeId,e,g,h],!0)===!1)return!1;e[d]=g?g:f.val(),a.treeObj.trigger(s.event.RENAME,[a.treeId,e,h]);var i=v(e,s.id.A,a);i.removeClass(s.node.CURSELECTED_EDIT),f.unbind(),t.setNodeName(a,e),e.editNameFlag=!1,c.curEditNode=null,c.curEditInput=null,t.selectNode(a,e,!1)}return c.noSelection=!0,!0},editNode:function(a,b){var c=u.getRoot(a);if(t.editNodeBlur=!1,u.isSelectedNode(a,b)&&c.curEditNode==b&&b.editNameFlag)return void setTimeout(function(){r.inputFocus(c.curEditInput)},0);var d=a.data.key.name;b.editNameFlag=!0,t.removeTreeDom(a,b),t.cancelCurEditNode(a),t.selectNode(a,b,!1),v(b,s.id.SPAN,a).html("<input type=text class='rename' id='"+b.tId+s.id.INPUT+"' treeNode"+s.id.INPUT+" >");var e=v(b,s.id.INPUT,a);e.attr("value",b[d]),a.edit.editNameSelectAll?r.inputSelect(e):r.inputFocus(e),e.bind("blur",function(){t.editNodeBlur||t.cancelCurEditNode(a)}).bind("keydown",function(c){"13"==c.keyCode?(t.editNodeBlur=!0,t.cancelCurEditNode(a)):"27"==c.keyCode&&t.cancelCurEditNode(a,b[d])}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),v(b,s.id.A,a).addClass(s.node.CURSELECTED_EDIT),c.curEditInput=e,c.noSelection=!1,c.curEditNode=b},moveNode:function(a,b,c,d,e,f){var g=u.getRoot(a),h=a.data.key.children;if(b!=c&&(!a.data.keep.leaf||!b||b.isParent||d!=s.move.TYPE_INNER)){var i=c.parentTId?c.getParentNode():g,j=null===b||b==g;j&&null===b&&(b=g),j&&(d=s.move.TYPE_INNER);var k=b.parentTId?b.getParentNode():g;d!=s.move.TYPE_PREV&&d!=s.move.TYPE_NEXT&&(d=s.move.TYPE_INNER),d==s.move.TYPE_INNER&&(j?c.parentTId=null:(b.isParent||(b.isParent=!0,b.open=!!b.open,t.setNodeLineIcos(a,b)),c.parentTId=b.tId));var l,m;if(j)l=a.treeObj,m=l;else{if(f||d!=s.move.TYPE_INNER?f||t.expandCollapseNode(a,b.getParentNode(),!0,!1):t.expandCollapseNode(a,b,!0,!1),l=v(b,a),m=v(b,s.id.UL,a),l.get(0)&&!m.get(0)){var n=[];t.makeUlHtml(a,b,n,""),l.append(n.join(""))}m=v(b,s.id.UL,a)}var o=v(c,a);o.get(0)?l.get(0)||o.remove():o=t.appendNodes(a,c.level,[c],null,!1,!0).join(""),m.get(0)&&d==s.move.TYPE_INNER?m.append(o):l.get(0)&&d==s.move.TYPE_PREV?l.before(o):l.get(0)&&d==s.move.TYPE_NEXT&&l.after(o);var p,q,r=-1,w=0,x=null,y=null,z=c.level;if(c.isFirstNode)r=0,i[h].length>1&&(x=i[h][1],x.isFirstNode=!0);else if(c.isLastNode)r=i[h].length-1,x=i[h][r-1],x.isLastNode=!0;else for(p=0,q=i[h].length;q>p;p++)if(i[h][p].tId==c.tId){r=p;break}if(r>=0&&i[h].splice(r,1),d!=s.move.TYPE_INNER)for(p=0,q=k[h].length;q>p;p++)k[h][p].tId==b.tId&&(w=p);if(d==s.move.TYPE_INNER?(b[h]||(b[h]=new Array),b[h].length>0&&(y=b[h][b[h].length-1],y.isLastNode=!1),b[h].splice(b[h].length,0,c),c.isLastNode=!0,c.isFirstNode=1==b[h].length):b.isFirstNode&&d==s.move.TYPE_PREV?(k[h].splice(w,0,c),y=b,y.isFirstNode=!1,c.parentTId=b.parentTId,c.isFirstNode=!0,c.isLastNode=!1):b.isLastNode&&d==s.move.TYPE_NEXT?(k[h].splice(w+1,0,c),y=b,y.isLastNode=!1,c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(d==s.move.TYPE_PREV?k[h].splice(w,0,c):k[h].splice(w+1,0,c),c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!1),u.fixPIdKeyValue(a,c),u.setSonNodeLevel(a,c.getParentNode(),c),t.setNodeLineIcos(a,c),t.repairNodeLevelClass(a,c,z),!a.data.keep.parent&&i[h].length<1){i.isParent=!1,i.open=!1;var A=v(i,s.id.UL,a),B=v(i,s.id.SWITCH,a),C=v(i,s.id.ICON,a);t.replaceSwitchClass(i,B,s.folder.DOCU),t.replaceIcoClass(i,C,s.folder.DOCU),A.css("display","none")}else x&&t.setNodeLineIcos(a,x);y&&t.setNodeLineIcos(a,y),a.check&&a.check.enable&&t.repairChkClass&&(t.repairChkClass(a,i),t.repairParentChkClassWithSelf(a,i),i!=c.parent&&t.repairParentChkClassWithSelf(a,c)),f||t.expandCollapseParentNode(a,c.getParentNode(),!0,e)}},removeEditBtn:function(a,b){v(b,s.id.EDIT,a).unbind().remove()},removeRemoveBtn:function(a,b){v(b,s.id.REMOVE,a).unbind().remove()},removeTreeDom:function(a,b){b.isHover=!1,t.removeEditBtn(a,b),t.removeRemoveBtn(a,b),r.apply(a.view.removeHoverDom,[a.treeId,b])},repairNodeLevelClass:function(a,b,c){if(c!==b.level){var d=v(b,a),e=v(b,s.id.A,a),f=v(b,s.id.UL,a),g=s.className.LEVEL+c,h=s.className.LEVEL+b.level;d.removeClass(g),d.addClass(h),e.removeClass(g),e.addClass(h),f.removeClass(g),f.addClass(h)}},selectNodes:function(a,b){for(var c=0,d=b.length;d>c;c++)t.selectNode(a,b[c],c>0)}},p={tools:n,view:o,event:l,data:k};a.extend(!0,a.fn.zTree.consts,b),a.extend(!0,a.fn.zTree._z,p);var q=a.fn.zTree,r=q._z.tools,s=q.consts,t=q._z.view,u=q._z.data,v=(q._z.event,r.$);u.exSetting(c),u.addInitBind(f),u.addInitUnBind(g),u.addInitCache(e),u.addInitNode(i),u.addInitProxy(h),u.addInitRoot(d),u.addZTreeTools(j);var w=t.cancelPreSelectedNode;t.cancelPreSelectedNode=function(a,b){for(var c=u.getRoot(a).curSelectedList,d=0,e=c.length;e>d&&(b&&b!==c[d]||(t.removeTreeDom(a,c[d]),!b));d++);w&&w.apply(t,arguments)};var x=t.createNodes;t.createNodes=function(a,b,c,d){x&&x.apply(t,arguments),c&&t.repairParentChkClassWithSelf&&t.repairParentChkClassWithSelf(a,d)};var y=t.makeNodeUrl;t.makeNodeUrl=function(a){return a.edit.enable?null:y.apply(t,arguments)};var z=t.removeNode;t.removeNode=function(a,b){var c=u.getRoot(a);c.curEditNode===b&&(c.curEditNode=null),z&&z.apply(t,arguments)};var A=t.selectNode;t.selectNode=function(a,b){var c=u.getRoot(a);return u.isSelectedNode(a,b)&&c.curEditNode==b&&b.editNameFlag?!1:(A&&A.apply(t,arguments),t.addHoverDom(a,b),!0)};var B=r.uCanDo;r.uCanDo=function(a,b){var c=u.getRoot(a);return b&&(r.eqs(b.type,"mouseover")||r.eqs(b.type,"mouseout")||r.eqs(b.type,"mousedown")||r.eqs(b.type,"mouseup"))?!0:!c.curEditNode&&(B?B.apply(t,arguments):!0)}}(jQuery)}),define("dist/app/get-staff",["$","./page","./common/pagenation","../lib/cmp/pagination/pagination","../lib/cmp/widget","../lib/util/base","../lib/util/class","../lib/util/event","../lib/util/aspect","../lib/util/attribute","../lib/cmp/daparser","../lib/cmp/auto-render","../lib/util/ajax","./common/ajax","./common/_ajax","../lib/util/json","./common/dialog/singleton","../lib/cmp/dialog/confirm-box","../lib/cmp/dialog/dialog","../lib/cmp/overlay","../lib/util/dom/position","../lib/util/bom/browser","../lib/util/dom/iframe-shim","../lib/cmp/mask","../lib/util/dom/sticky","../lib/util/dom/scroll","../lib/util/dom/wheel","../lib/cmp/dialog/tpl/dialog","../lib/cmp/dialog/tpl/button","./tpl/staff-list","./ctrl-table"],function(a,b,c){var d=a("$"),e=a("./page"),f={staffList:function(a,b){var c=a.attr("title");d("#selectTitle").attr("title",b).html(c),d("#pagination div").remove(),e.request(1,!0,b)},getSelectedNode:function(a,b){var c=a.closest("li").attr("id");return b.getNodeByTId(c)},getParentText:function(a){var b="",c=a.parent().attr("class").replace(/level/,"");b+=Global.unitname;for(var d=0;c>=d&&!(d>c);d++)d!==c&&(b+="/"),b+=a.parents("li.level"+d).find("a").attr("title");return b}};c.exports=f}),define("dist/app/page",["$","./common/pagenation","../lib/cmp/pagination/pagination","../lib/cmp/widget","../lib/util/base","../lib/util/class","../lib/util/event","../lib/util/aspect","../lib/util/attribute","../lib/cmp/daparser","../lib/cmp/auto-render","../lib/util/ajax","./common/ajax","./common/_ajax","../lib/util/json","./common/dialog/singleton","../lib/cmp/dialog/confirm-box","../lib/cmp/dialog/dialog","../lib/cmp/overlay","../lib/util/dom/position","../lib/util/bom/browser","../lib/util/dom/iframe-shim","../lib/cmp/mask","../lib/util/dom/sticky","../lib/util/dom/scroll","../lib/util/dom/wheel","../lib/cmp/dialog/tpl/dialog","../lib/cmp/dialog/tpl/button","./tpl/staff-list","./ctrl-table"],function(a,b,c){var d=a("$"),e=a("./common/pagenation"),f=a("./common/ajax"),g=a("./tpl/staff-list"),h=a("./ctrl-table"),i=10,j={page:function(a,b,c){new e({parentNode:"#pagination",showPN:!1,total:+a.total,size:i,success:function(a){b||j.request(a,!1,c)}}).render(),b=!1},request:function(a,b,c){var e="/staff/list?getsub=1&dept_id="+c+"&page="+a+"&size="+i;f({url:e,method:"GET"}).done(function(a){b&&j.page(a,b,c),d("#stu_list_tip div:first b").html(a.total),d("#dataList table, #dataList p").remove(),d("#dataList").append(g.render({slist:a})),0===a.total?d("#pagination").hide():d("#pagination").show(),h.init()})},pageSearch:function(a,b,c){new e({parentNode:"#pagination",showPN:!1,total:+a.total,size:i,success:function(a){b||j.requestSearch(a,!1,c)}}).render(),b=!1},requestSearch:function(a,b,c){var e="/staff/list?getsub=1&search="+c+"&page="+a+"&size="+i;f({url:e,method:"GET"}).done(function(a){b&&j.pageSearch(a,b,c),d("#stu_list_tip div:first b").html(a.total),d("#dataList table, #dataList p").remove(),d("#dataList").append(g.render({slist:a})),0===a.total?d("#pagination").hide():d("#pagination").show(),h.init()})}};c.exports=j}),define("dist/app/common/pagenation",["../../lib/cmp/pagination/pagination","$","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/event","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/util/ajax"],function(a,b,c){var d=a("../../lib/cmp/pagination/pagination"),e=d.extend({attrs:{initRun:!0},view:function(){var a='<input type="button" class="btn" value="<" data-action="prev"/>';return a+=this.classicHTML(),a+='<input type="button" class="btn" value=">" data-action="next"/>',this.element.html(a),this.reflow(),this.get("initRun")&&this.get("success")&&this.get("success").call(this,this.get("current")),this.set("initRun",!0),this}});c.exports=e}),define("dist/lib/cmp/pagination/pagination",["$","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","../../util/ajax"],function(a){var b=a("$"),c=a("../widget"),d=a("../../util/ajax"),e={tpl:function(a,b,c){var d='<a href="'+(c===!0?"#":a+b)+'" data-page="'+b+'" data-action="page">'+b+"</a>";return d}},f=c.extend({attrs:{url:"",type:"ajax",data:null,before:null,success:null,error:null,method:"get",pageName:"page",sizeName:"pagesize",totalName:"data.total",pageIndexOffset:0,size:12,current:{value:1,setter:function(a){if(a)return+a||0;var b=Math.ceil(this.get("total")/this.get("size"));return Math.min(Math.max(a,1),b)}},total:0,template:'<div class="widget-pagination"></div>'},setup:function(){f.superclass.setup.call(this),this._init=!0},events:{"click [data-action=prev]":function(a){"link"!==this.get("type")&&(b(a.target).hasClass("disabled")||this.prev(),a.preventDefault())},"click [data-action=page]":function(a){"link"!==this.get("type")&&(this.load(b(a.target).attr("data-page")),a.preventDefault())},"click [data-action=next]":function(a){"link"!==this.get("type")&&(b(a.target).hasClass("disabled")||this.next(),a.preventDefault())}},prev:function(){return this.set("current",Math.max(1,this.get("current")-1)),this},next:function(){var a=Math.ceil(this.get("total")/this.get("size"));return this.set("current",Math.min(a,this.get("current")+1)),this},load:function(a){return this.set("current",+a),this},classicHTML:function(){var a,c="post"===this.get("method").toLowerCase(),d=this.get("url"),f=(this.get("x")||2,this.get("y")||1,this.get("size")),g=Math.ceil(this.get("total")/f),h=this.get("current"),i=this.get("sizeName"),j=this.get("pageName"),k=[],l=["",""],m="<span>...</span>";if(c||(d+=-1===d.indexOf("?")?"?":"&",d+=b.param(this.get("data")||{}),-1===d.indexOf(i+"=")&&(d+=i+"="+f+"&"),-1===d.indexOf(j+"=")&&(d+=j+"=")),this.get("showPN")!==!1&&(l[0]='<a href="'+(c?"#":d+Math.max(1,h-1))+'" data-action="prev">上一页</a>',l[1]='<a href="'+(c?"#":d+Math.min(g,h+1))+'" data-action="next">下一页</a>'),5>=g)for(a=1;g>=a;a++)k.push(e.tpl(d,a,c));else if(3>=h){for(a=1;4>=a;a++)k.push(e.tpl(d,a,c));k.push(m,e.tpl(d,g,c))}else if(h>=g-2)for(k.push(e.tpl(d,1,c),m),a=g-2;g>=a;a++)k.push(e.tpl(d,a,c));else k.push(e.tpl(d,1,c),m,e.tpl(d,h-1,c),e.tpl(d,h,c),e.tpl(d,h+1,c),m,e.tpl(d,g,c));return l[0]+k.join("")+l[1]},view:function(a){var c=this.get("size"),d=this.get("current");return this.element.html(this.classicHTML()),this.reflow(),"ajax"===this.get("type")?a!==!1&&this.ajax():this.get("success")&&this.get("success").call(this,d,b.isArray(this.get("data"))?this.get("data").splice((d-1)*c,Math.min(this.get("data").length,d*c)):[]),this},reflow:function(){var a=this.get("current"),b=Math.ceil(this.get("total")/this.get("size"));return this.$("[data-action=prev]").toggleClass("disabled",1>=a),this.$("[data-action=next]").toggleClass("disabled",a>=b),this.$("[data-page]").removeClass("active"),this.$("[data-page="+a+"]").addClass("active"),this},ajax:function(){var a=this,c=d.single(this.cid),e={},f=["before","error","complete"],g={url:this.get("url"),success:function(b){for(var c=a.get("totalName").split("."),d=b,e=+a.get("total"),f=0,g=c.length;g>f;f++)d&&(d=d[c[f]]);a.checkTotal(d,e),a.get("success")&&a.get("success").call(a,a.get("current"),b)}},h=this.get("data");h=b.isFunction(h)?h.call(this):h,e[this.get("pageName")]=+this.get("current")+ +this.get("pageIndexOffset"),e[this.get("sizeName")]=this.get("size"),g.data="object"==typeof h?b.extend(e,h):h,g.type=this.get("method");for(var i=0,j=f.length;j>i;i++){var k=f[i];a.get(k)&&(g[k]=a.get(k).call(a))}return c.send(g)},checkTotal:function(a,b){var c=this.get("current"),d=this.get("size");if(a=+a||0,b!==a){var e=Math.ceil(a/d);this.set("total",a,{silent:!0}),c>e?this.set("current",e):this.view(!1)}},_onRenderCurrent:function(){this.view()},_onRenderTotal:function(){this._init!==!0?this.view():delete this._init}});return f}),define("dist/lib/util/ajax",["$"],function(a,b,c){var d=a("$"),e={},f={},g={loginPage:"/",noPermissionAction:function(){location.href=g.loginPage},errorAction:function(){}},h={success:function(a){return a&&200===+a.code},permission:function(a){return a&&401===+a.code}},i=function(a,b,c){var e;return e=b&&b.rule&&d.isFunction(b.rule[c])?b.rule[c]:h[c],e(a)===!0};d(document).keydown(function(a){return 27===a.keyCode?!1:void 0}),window.ActiveXObject&&d.ajaxSetup({cache:!1});var j={setSuccessRule:function(a){h.success=function(b){return a(b)},j.setSuccessRule=null},setPermissionRule:function(a){h.permission=function(b){return a(b)},j.setPermissionRule=null},setNoPermissionAction:function(a){g.noPermissionAction=a,j.setNoPermissionAction=null},setErrorAction:function(a){g.errorAction=a,j.setErrorAction=null},base:function(a){var b=d.extend({},a||{});return!b.before||b.before&&b.before()!==!1?(b.dataType="json",b.type=a.type||"GET",b.success=function(c){i(c,b,"success")?a.success&&a.success(c):i(c,b,"permission")?d.isFunction(a.permission)?a.permission(c):g.noPermissionAction():d.isFunction(a.error)?a.error(c):g.errorAction(c)},b.error=function(b,c){"abort"!==c&&(d.isFunction(a.error)?a.error(b,c):g.errorAction(b,c))},b.complete=function(b,c){d.isFunction(a.complete)&&a.complete(b,c)},d.ajax(b)):void 0},single:function(a){e[a]||(e[a]={});var b={send:function(b){var c=e[a].url&&b.url===e[a].url;if(c)if(typeof b.data==typeof e[a].data&&"object"==typeof b.data){for(var f in b.data)if(b.data[f]!==e[a].data[f]){c=!1;break}}else c=b.data===e[a].data;if(c)return!1;e[a].xhr&&e[a].xhr.abort();var g=b.complete;b.complete=function(b,c){e[a]={},d.isFunction(g)&&g(b,c)},e[a]={xhr:j.base(b),url:b.url,data:b.data}},abort:function(){e[a]&&e[a].xhr&&4!==e[a].xhr.readyState&&(e[a].xhr.abort(),e[a].xhr=null)}};return b},pool:function(a,b,c){if(!f[a]){var e=0;f[a]={};var g=f[a];b=Math.max(1,parseInt(b,10)||1),c=Math.max(1,parseInt(c,10)||1);for(var h=1;c>=h;h++)g[h]=[];var i={},k=function(){if(b>e)for(var a=1;c>=a;a++)if(g[a].length>0){var f=g[a].shift();if(f){var h=+new Date+"_"+Math.random(),l=f.complete;e++,f.complete=function(a){return function(b,c){e--,"success"!==c&&b&&b.abort(),d.isFunction(l)&&l(b,c),i[a]=null,delete i[a],k()}}(h),i[h]=j.base(f);break}}},l={add:function(a,b){b&&g[b]?g[b].push(a):g[c].push(a),k()},abort:function(){if(g){for(var a=1;c>=a;a++)g[a].length=0;for(var b in i)i[b].abort()}}};return l}}};c.exports=j}),define("dist/app/tpl/staff-list",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\'\');if (slist.total >= 1){_s.push(\' <table id="staffsInfo">  <tr>  <th class="first"><input type="checkbox" name="checkAll" id="checkAll" data-action="checkAll" /><span>姓名</span></th>  <th class="second">入司时间</th>  <th class="third">手机</th>  <th class="four">部门</th>  <th class="five">操作</th>  </tr>\');for(var key1=0; key1<slist.data.length;key1+=1){var msg=slist.data[key1];_s.push(\'  <tr name="\',msg.user_id,\'">  <td><input type="checkbox" name="singleStu" class="" />\',msg.name,\'</td>  <td>\',msg.joindate,\'</td>  <td><span class="cp" data-action="editStaff">\',msg.mobile,\'</span></td>  <td>\',msg.deptname,\'</td>  <td>  <span data-action="editStaff" class="edit_staff">修改</span>  <span data-action="delStaff" class="del_staff">删除</span>  </td>  </tr>\');}_s.push(\' </table>\');}else{_s.push(\' <p>暂无职员信息</p>\');} return _s;').apply(null,c).join("")}}}),define("dist/app/ctrl-table",["$"],function(a,b,c){function d(){for(var a=0,b=1,a=0;b<g.length;b++)e(g[b]).closest("tr").removeClass("current"),g[b].checked&&(a++,e(g[b]).closest("tr").addClass("current"));
g[0].checked=a==g.length-1}var e=a("$"),f=document.getElementById("dataList"),g=f.getElementsByTagName("input"),h={init:function(){if(!(g.length<1)){g[0].onclick=function(){for(var a=1;a<g.length;a++)g[a].checked=this.checked;d()};for(var a=1;a<g.length;a++)g[a].onclick=function(){d()}}}};Global.Helper=h,c.exports=h}),define("dist/app/operate-tree",["$","./get-staff","./page","./common/pagenation","../lib/cmp/pagination/pagination","../lib/cmp/widget","../lib/util/base","../lib/util/class","../lib/util/event","../lib/util/aspect","../lib/util/attribute","../lib/cmp/daparser","../lib/cmp/auto-render","../lib/util/ajax","./common/ajax","./common/_ajax","../lib/util/json","./common/dialog/singleton","../lib/cmp/dialog/confirm-box","../lib/cmp/dialog/dialog","../lib/cmp/overlay","../lib/util/dom/position","../lib/util/bom/browser","../lib/util/dom/iframe-shim","../lib/cmp/mask","../lib/util/dom/sticky","../lib/util/dom/scroll","../lib/util/dom/wheel","../lib/cmp/dialog/tpl/dialog","../lib/cmp/dialog/tpl/button","./tpl/staff-list","./ctrl-table","./tpl/operate-tree","./common/action/action","../lib/util/dom/action"],function(a,b,c){var d=a("$"),e=a("./get-staff"),f=a("./tpl/operate-tree"),g=a("./common/action/action"),h={init:function(){h.clickCompany(),h.clickNode(),h.hoverNode(),h.isButtonShow()},clickCompany:function(){d("#companyName").on("click",function(){d("#classTree a").removeClass("curSelectedNode"),d(this).addClass("curSelected"),e.staffList(d(this),-1)})},clickNode:function(){d("#classTree").on("click","a",function(){d("#companyName").removeClass("curSelected"),d("#classTree a").removeClass("curSelectedNode"),d(this).addClass("curSelectedNode"),Global.curA=d("#classTree a.curSelectedNode");var a=e.getSelectedNode(Global.curA,Global.treeObj).id;Global.curid=a,e.staffList(Global.curA,a),h.isButtonShow()})},hoverNode:function(){d("#classTree").on("mouseenter","a",function(){var a=d(this).hasClass("level6");d(this).addClass("current").append(f.render({isEightLevel:a})),a&&d("#winOptTree").css({width:"197px"}),g.treeStyle(d(this))}).on("mouseleave","a",function(){d("#winOptTree").remove(),d("#btnTree").remove(),d(this).closest("#classTree").find("a").removeClass("current")})},isButtonShow:function(){}};c.exports=h}),define("dist/app/tpl/operate-tree",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <b id="btnTree" class="win_opt_tree"></b> <div id="winOptTree">  <div class="opt_area">\');if (isEightLevel === false){_s.push(\'  <div class="add" data-action="add">新建下级</div>\');}_s.push(\'  <div class="edit" data-action="edit">编辑</div>  <div class="del" data-action="del">删除</div>  </div>  <i></i> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/action/action",["$","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button","../../../lib/util/dom/action"],function(a,b,c){var d=a("$"),e=a("../../../lib/cmp/dialog/confirm-box"),f=a("../../../lib/util/dom/action"),g=[];d(function(){f.listen({loginOut:function(){window.location.href="/login/loginout"}})});var h={mapData:function(a){for(var b=0;b<a.length;b++){var c={};c.id=a[b].dept_id,c.pId=a[b].parent_id,c.name=a[b].name,g.push(c)}return g},tipText:function(a){e.alert({title:"提示",repositionOnResize:!0,content:'<p class="del_text">'+a+"</p>",width:470,height:300,fixed:!0,hasMask:{hideOnClick:!0}})},getParentText:function(a){var b="",c=a.parent().attr("class").replace(/level/,"");b+=Global.unitname;for(var d=0;c>=d&&!(d>c);d++)d!==c&&(b+="/"),b+=a.parents("li.level"+d).find("a").attr("title");return b},editParentText:function(a){var b="",c=a.parent().attr("class").replace(/level/,"");b+=Global.unitname;for(var d=0;c-1>=d&&!(d>c);d++)d!==c&&(b+="/"),b+=a.parents("li.level"+d).find("a").attr("title");return b},stampToTime:function(a){var b=new Date(1e3*a);return b.getFullYear()},getCurrentNode:function(a){return d("#classTree a").removeClass("curSelectedNode"),a.closest("a").addClass("curSelectedNode"),d("#classTree a.curSelectedNode")},nodeValidator:function(a){return/^\s*$/.test(a.val())&&(a.val("不能为空").css({"border-color":"#f50",background:"#E9B7BF"}),a.focus(function(){a.val("").css({"border-color":"#ddd",background:"#fff"})})),"不能为空"===a.val()?!1:!0},treeStyle:function(a){var b=parseInt(a.closest("li").css("width"));a.find("span:last").css("width",b-18+"px"),a.find("span:first").hasClass("ico_docu")?(a.css("width",b+"px"),d("#winOptTree").css("left",b+12+"px")):(a.css("width",b+"px"),d("#winOptTree").css("left",b-6+"px"))},isCnNewID:function(a){var b=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],c=[1,0,"X",9,8,7,6,5,4,3,2];if(/^\d{17}\d|x$/i.test(a)){for(var d,e=0,f=0;f<a.length-1;f++)e+=parseInt(a.substr(f,1),10)*b[f];return d=e%11,c[d]==a.substr(17,1).toUpperCase()}return!1}};c.exports=h}),define("dist/lib/util/dom/action",["$"],function(a){var b=a("$"),c={dom:[],eventType:[],action:[]},d="data-action",e={setActionKey:function(a){d=a,e.setActionKey=null},listen:function(a,e,f){a=a||{},e=b(e?e:document),f=f||"click";var g=b.inArray(e[0],c.dom);if(-1!==g&&c.eventType[g]!==f&&(g=-1),-1===g)c.dom.push(e[0]),c.eventType.push(f),c.action.push(a),g=c.action.length-1,e[f](function(a){var e=b(a.target),f=e.attr(d),h=e;f||(h=e.closest("["+d+"]"),f=h.attr(d));var i=!0,j=c.action[g],k=j[f];if(k)if(b.isFunction(k.not)&&(k.node&&k.node[0]!==h[0]&&k.not.call(k.scope||e,a,k.node,f),k.node=h,k.using=!0),b.isFunction(k))i=k.call(e,a,h,f);else if(b.isFunction(k.is)||b.isFunction(k.action)){var l=k.is||k.action;i=l.call(k.scope||e,a,h,f)}for(var m=0,n=c.action.length;n>m;m++){var o=c.action[m];for(var p in o)p!==f&&o[p]&&o[p].not&&b.isFunction(o[p].not)&&o[p].using&&(o[p].using=!!o[p].not.call(o[p].scope||e,a,o[p].node,f))}if(-1===i)a.stopPropagation();else{if(i===!0)return!0;if(i===!1)return!1;a.preventDefault()}});else{var h=c.action[g];for(var i in a)h[i]=a[i]}return e}};return e}),define("dist/lib/util/dom/placeholder",["$","./position","../bom/browser","./inputor","../timer"],function(a,b,c){var d=a("$"),e=a("./position"),f=(a("./inputor"),function(){var a=0;return function(){return 0===a&&(a="placeholder"in document.createElement("input")),a}}()),g=function(a,b){if(!f()&&(a=d(a),!a.data("placeholder"))){b=b||a.attr("placeholder");var c=d('<span class="placeholder">'+b+"</span>"),g=parseInt(a.css("line-height")),h=parseInt(a.css("padding-left")),i=parseInt(a.css("padding-top"))+2;a.after(c),c.css({color:"#bbb",height:g,lineHeight:g+"px",paddingLeft:h+"px",paddingTop:i+"px"}),e.pin({element:c},{element:a}),a.timer(function(a){c[a.length?"hide":"show"]()}),c.bind("focus click",function(){a.focus()}),a.val().length&&c.hide(),a.data("placeholder",!0)}};g.render=function(){d("[placeholder]").placehoder()},d.fn.placehoder=function(){this.each(function(){g(this)})},d(function(){f()||d(window).bind("resize.placeholder",function(){d("[placeholder]").each(function(a,b){b=d(b);var c=b.nextAll(".placeholder").eq(0);e.pin({element:c},{element:b})})})}),c.exports=g}),define("dist/lib/util/dom/inputor",["$","../timer"],function(a,b,c){var d=a("$"),e=a("../timer"),f=function(a,b,c){a=d(a),c=c||{};var f=a.val(),g=!1,h=e.debounce(function(d){if(g){var e=a.val();(c.keep===!0||d===!0||e!==f)&&(b(e,a),f=e),g&&h()}},c.timer||128);a.bind("focus.timer",function(){g=!0,h(!0)}),a.bind("blur.timer",function(){c.silentBlur||b(a.val(),a),g=!1})};d.fn.timer=function(a,b){this.each(function(){f(this,a,b)})},c.exports=f}),define("dist/lib/util/timer",[],function(a,b,c){var d={throttle:function(a,b){var c,d,e,f,g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)};return function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},debounce:function(a,b,c){var d,e;return function(){var f=this,g=arguments,h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d;return clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}}};c.exports=d}),define("dist/app/common/dialog/add-node",["$","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button","../../../lib/util/dom/action","../controller","../ajax","../_ajax","../../../lib/util/json","./singleton","../../get-staff","../../page","../pagenation","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../../tpl/staff-list","../../ctrl-table","./tpl/add","../action/action","./counselor","./tpl/search"],function(a){var b=a("$"),c=a("../../../lib/cmp/dialog/confirm-box"),d=a("../../../lib/util/dom/action"),e=a("../controller"),f=a("../../get-staff"),g=a("./tpl/add"),h=a("../action/action"),i=a("./counselor");b(function(){d.listen({add:function(a,d){var j,k,l=b(this),m="",n=0;Global.curA=j=h.getCurrentNode(l);var o=!1;b(d[0]).hasClass("btn_add")?m=Global.unitname:(m=h.getParentText(j),n=f.getSelectedNode(j,Global.treeObj).id,k=f.getSelectedNode(Global.curA,Global.treeObj).id);var p=c.show({title:"新增节点",repositionOnResize:!0,content:g.render({parentText:m,isLastNode:o}),width:470,height:365,buttons:[{text:"确定",action:"send"},{text:"取消",action:"cancel"}],fixed:!0,hasMask:{hideOnClick:!0}}).on("send",function(){var a=b("#nodename"),c=h.nodeValidator(a);if(c!==!1){var d=a.val(),g=b("#fdy").attr("title"),i=b("#deptseq").val(),j={parent_id:+n,name:d,shortname:d,chief_uid:+g,seq:i?i:0};e.orgManager.add(j,function(a){return a.errMsg?void h.tipText(a.errMsg):(p.hide(),void Global.treeObj.addNodes(f.getSelectedNode(Global.curA,Global.treeObj),{id:a.dept_id,pId:a.parent_id,name:a.name,seq:a.seq}))})}}).on("cancel",function(){this.hide()});i.getSelor()}})})}),define("dist/app/common/dialog/tpl/add",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="input_box">  <div>  <label for="parentnode">父节点</label>  <input type="text" name="parentnode" value="\',parentText,\'" id="parentnode" title="\',parentText,\'" disabled="disabled" />  </div>  <div>  <label for="nodename"><b>*</b>名称</label>  <input type="text" name="nodename" id="nodename" placeholder="请填写节点名称" class="gbox" />  </div>  <div>  <label for="deptseq">序号</label>  <input type="text" name="seq" value="1000" id="deptseq" placeholder="请填写节点序号" />  </div>\');if (isLastNode){_s.push(\'  <div>  <label for="fdy">部门长</label>  <input type="text" name="fdy" id="fdy" />  <ul id="searchList"></ul>  </div>\');}_s.push(\' </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/counselor",["$","../controller","../ajax","../_ajax","../../../lib/util/event","../../../lib/util/json","./singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button","./tpl/search"],function(a,b,c){var d=a("$"),e=a("../controller"),f=a("./tpl/search");c.exports={getSelor:function(){d("#fdy").keyup(function(a){var b=d(this).val();return""===b?void d("#searchList").hide():void(/^[\u4e00-\u9fa5a-zA-Z0-9]+$/.test(b)&&(a.keyCode<37||a.keyCode>40)&&(d("#searchList li").remove(),e.staff.search(encodeURI(b),function(a){0!==a.total?(d("#searchList").show().append(f.render({sinfo:a.data})),d("#searchList li").eq(0).addClass("current")):d("#searchList").hide()})))}),d("#fdy").focus(function(a){d("#searchList li").length>=1&&d("#searchList").show(),a.stopPropagation()}).click(function(a){a.stopPropagation()}),d("#searchList").on("click","li",function(){d("#fdy").val(d(this).text()),d("#fdy").attr("title",d(this).attr("name")),d("#searchList").hide()}),d(document).click(function(){d("#searchList").hide()});var a=0;d(document).keydown(function(b){38===b.keyCode&&(0===a&&(a=d("#searchList li").length),a--),40===b.keyCode&&(a++,a===d("#searchList li").length&&(a=0)),d("#searchList li").eq(a).addClass("current").siblings().removeClass("current"),d("#fdy").val(d.trim(d("#searchList li").eq(a).text())),d("#searchList").scrollTop(d("#searchList li").outerHeight()*a)})}}}),define("dist/app/common/dialog/tpl/search",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push('');for(var key=0; key<sinfo.length;key+=1){var msg=sinfo[key];_s.push(' <li name=\"',msg.user_id,'\">',msg.name);if (msg.deptname !== \"\"){_s.push('  - ',msg.deptname);}_s.push(' </li>');} return _s;").apply(null,c).join("")}}}),define("dist/app/common/dialog/edit-node",["$","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button","../../../lib/util/dom/action","../controller","../ajax","../_ajax","../../../lib/util/json","./singleton","../../get-staff","../../page","../pagenation","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../../tpl/staff-list","../../ctrl-table","./tpl/edit","../action/action","./counselor","./tpl/search"],function(a){var b=a("$"),c=a("../../../lib/cmp/dialog/confirm-box"),d=a("../../../lib/util/dom/action"),e=a("../controller"),f=a("../../get-staff"),g=a("./tpl/edit"),h=a("../action/action"),i=a("./counselor");b(function(){d.listen({edit:function(){var a=b(this),d=!1,j=f.getSelectedNode(h.getCurrentNode(a),Global.treeObj),k=h.getCurrentNode(a),l=h.editParentText(h.getCurrentNode(a)),m=0;h.getCurrentNode(a).closest("ul").siblings("a").hasClass("btn_add")||(m=f.getSelectedNode(h.getCurrentNode(a).closest("ul").siblings("a"),Global.treeObj).id);var n=a.closest("a").attr("title");e.orgManager.deptInfo(j.id,function(a){var f=a.manager_name,o=a.chief_uid,p=c.show({title:"编辑节点",repositionOnResize:!0,content:g.render({isLastNode:d,parentText:l,curTitle:n,curSeq:j.seq,managerName:f}),width:470,height:365,buttons:[{text:"确定",action:"send"},{text:"取消",action:"cancel"}],fixed:!0,hasMask:{hideOnClick:!0}}).on("send",function(){var a=b("#nodename"),c=h.nodeValidator(a);if(c!==!1){var d=a.val(),f=b("#fdy").attr("title"),g=b("#deptseq").val(),i={dept_id:+j.id,parent_id:b("#parentnode").attr("title")||+m,name:d,shortname:d,chief_uid:+f||o,seq:g};e.orgManager.edit(i,function(){j.seq=g,p.hide(),k.find("span:last").text(d),k.attr("title",d)})}}).on("cancel",function(){this.hide()});i.getSelor()})}})})}),define("dist/app/common/dialog/tpl/edit",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="input_box">  <div>  <label for="parentnode">父节点：</label>  <input type="text" name="parentnode" value="\',parentText,\'" id="parentnode" disabled="disabled" />  </div>  <div>  <label for="nodename"><b>*</b>名称：</label>  <input type="text" name="nodename" id="nodename" value="\',curTitle,\'" />  </div>  <div>  <label for="deptseq">序号</label>  <input type="text" name="seq" id="deptseq" value="\',curSeq,\'" />  </div>\');if (isLastNode){_s.push(\'  <div>  <label for="fdy">部门长：</label>  <input type="text" name="fdy" id="fdy" value="\',managerName,\'" />  <ul id="searchList"></ul>  </div>\');}_s.push(\' </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/del-node",["$","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button","../../../lib/util/dom/action","../controller","../ajax","../_ajax","../../../lib/util/json","./singleton","../../get-staff","../../page","../pagenation","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../../tpl/staff-list","../../ctrl-table","../action/action"],function(a){function b(a,b){var c=[{buttons:[{text:"确定",action:"send"},{text:"取消",action:"cancel"}],tipText:"是否确定删除该节点？"},{buttons:[{text:"取消",action:"cancel"}],tipText:"该节点下还有数据，无法进行删除操作！"}];return h.getCurrentNode(a).find("span:first").hasClass("ico_docu")&&0===b?c[0]:c[1]}var c=a("$"),d=a("../../../lib/cmp/dialog/confirm-box"),e=a("../../../lib/util/dom/action"),f=a("../controller"),g=a("../../get-staff"),h=a("../action/action");e.listen({del:function(){var a=c(this),e=g.getSelectedNode(h.getCurrentNode(a),Global.treeObj),i=e.id;f.orgManager.getStaffList(i,function(c){var g=c.total,h=b(a,g),j=d.show({title:"删除节点",repositionOnResize:!0,content:'<p class="del_text">'+h.tipText+"</p>",width:470,height:300,buttons:h.buttons,fixed:!0,hasMask:{hideOnClick:!0}}).on("send",function(){var a={dept_id:+i};f.orgManager.del(a,function(){j.hide(),Global.treeObj.removeNode(e)})}).on("cancel",function(){this.hide()})})}})}),define("dist/app/common/dialog/add-staff",["$","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/util/date","../../../lib/cmp/calendar/calendar","../../../lib/cmp/calendar/date-panel","../../../lib/cmp/calendar/month-panel","../../../lib/cmp/calendar/year-panel","../../../lib/cmp/calendar/time-panel","../../../lib/cmp/calendar/tpl/time","../../../lib/cmp/calendar/tpl/calendar","../../../lib/cmp/calendar/tpl/bar","../../../lib/util/dom/action","../controller","../ajax","../_ajax","../../../lib/util/json","./singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/tpl/button","./tpl/add-staff","./checker","../../../lib/cmp/validator/validator","../../../lib/cmp/validator/core","../../../lib/cmp/validator/async","../../../lib/cmp/validator/utils","../../../lib/cmp/validator/rule","../../../lib/cmp/validator/item","./idcard-done","../action/action","../fresh","../../../lib/cmp/tree/ztree/ztree","../../get-staff","../../page","../pagenation","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../../tpl/staff-list","../../ctrl-table"],function(a){var b=a("$"),c=a("../../../lib/cmp/dialog/dialog"),d=a("../../../lib/util/date"),e=a("../../../lib/cmp/calendar/calendar"),f=a("../../../lib/util/dom/action"),g=a("../controller"),h=a("./tpl/add-staff"),i=a("./checker"),j=a("./idcard-done"),k=a("../fresh");f.listen({addStaff:function(){var a=new Date,f=new c({title:"新增职员",repositionOnResize:!0,content:h.render({joindate:d.format(a)}),width:850,height:650,fixed:!0,hasMask:{hideOnClick:!1}});f.show(),f.after("hide",function(){this.destroy()}),new e({zIndex:f.attrs.zIndex.value+1,fixed:!0,trigger:"#joindate"});var l=a.getFullYear()-18;new e({zIndex:f.attrs.zIndex.value+1,fixed:!0,date:l-5+"-12-31",trigger:"#birthday",disabled:{date:function(a){return a.getFullYear()>l}}});var m=b("#selectTitle").text(),n=b("#selectTitle").attr("title");f.element.find("#classW").attr("title",n).val(m).attr("disabled",!0);var o=i.init(f.element.find("form")),p=b("#cardSelectBox");j.idSelect(p);var q=p.parent().find("input[id*=idcard]");j.inputBlur(q),f.element.find('input[data-action="nextAdd"]').click(function(){var a=b("#username").val(),c=b("#sex").val(),d=b("#mobile").val(),e=b("#mail").val(),h=b("#classW").attr("title"),l=b("#title").val(),m=j.getCardNumber().idcardno,n=j.getCardNumber().xcardno,p=b("#joindate").val(),r=b("#birthday").val(),s=b("#seat").val(),t=(""===m?j.validator(q,n):j.validator(q,m),{name:a,password:"",gender:c,dept_id:h>0?h:0,title:l,mobile:d,email:e,idcardno:m,xcardno:n,birthday:r,joindate:p,seat:s});i.execute(o)&&g.staff.add(t,function(){f.hide(),k.staffList()})}),f.element.find('input[data-action="cancel"]').click(function(){f.hide()})}})}),define("dist/lib/util/date",[],function(a,b,c){var d=["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"],f=function(a){return(0>a||a>9?"":"0")+a},g=function(a,b,c,d){for(var e=d;e>=c;e--){var f=a.substring(b,b+e);if(f.length<c)return null;if(/^\d+$/.test(f))return f}return null},h={isLeap:function(a){return a%4===0&&a%100!==0||a%400===0},check:function(a,b){var c=h.stringToDate(a,b);return 0!==c},compare:function(a,b){var c=a.getTime(),d=b.getTime();return c>d?-1:d>c?1:0},stringCompare:function(a,b,c,d){var e=h.stringToDate(a,b),f=h.stringToDate(c,d);return h.compare(e,f)},stringToDate:function(a,b){a+="",b=b||"yyyy-MM-dd";for(var c,f,i,j=0,k=0,l="",m="",n=1970,o=1,p=1,q=0,r=0,s=0,t="";k<b.length;){for(l=b.charAt(k),m="";b.charAt(k)===l&&k<b.length;)m+=b.charAt(k++);if("yyyy"===m||"yy"===m||"y"===m){if("yyyy"===m&&(c=4,f=4),"yy"===m&&(c=2,f=2),"y"===m&&(c=2,f=4),n=g(a,j,c,f),null===n)return 0;j+=n.length,2===n.length&&(n=n>70?1900+(n-0):2e3+(n-0))}else if("MMM"===m||"NNN"===m){for(o=0,i=0;i<d.length;i++){var u=d[i];if(a.substring(j,j+u.length).toLowerCase()===u.toLowerCase()&&("MMM"===m||"NNN"===m&&i>11)){o=i+1,o>12&&(o-=12),j+=u.length;break}}if(1>o||o>12)return 0}else if("EE"===m||"E"===m)for(i=0;i<e.length;i++){var v=e[i];if(a.substring(j,j+v.length).toLowerCase()===v.toLowerCase()){j+=v.length;break}}else if("MM"===m||"M"===m){if(o=g(a,j,m.length,2),null===o||1>o||o>12)return 0;j+=o.length}else if("dd"===m||"d"===m){if(p=g(a,j,m.length,2),null===p||1>p||p>31)return 0;j+=p.length}else if("hh"===m||"h"===m){if(q=g(a,j,m.length,2),null===q||1>q||q>12)return 0;j+=q.length}else if("HH"===m||"H"===m){if(q=g(a,j,m.length,2),null===q||0>q||q>23)return 0;j+=q.length}else if("KK"===m||"K"===m){if(q=g(a,j,m.length,2),null===q||0>q||q>11)return 0;j+=q.length}else if("kk"===m||"k"===m){if(q=g(a,j,m.length,2),null===q||1>q||q>24)return 0;j+=q.length,q--}else if("mm"===m||"m"===m){if(r=g(a,j,m.length,2),null===r||0>r||r>59)return 0;j+=r.length}else if("ss"===m||"s"===m){if(s=g(a,j,m.length,2),null===s||0>s||s>59)return 0;j+=s.length}else if("a"===m){if("am"===a.substring(j,j+2).toLowerCase())t="AM";else{if("pm"!==a.substring(j,j+2).toLowerCase())return 0;t="PM"}j+=2}else{if(a.substring(j,j+m.length)!==m)return 0;j+=m.length}}if(j!==a.length)return 0;if(2===o)if(h.isLeap(n)){if(p>29)return 0}else if(p>28)return 0;return(4===o||6===o||9===o||11===o)&&p>30?0:(12>q&&"PM"===t?q=q-0+12:q>11&&"AM"===t&&(q-=12),new Date(n,o-1,p,q,r,s))},format:function(a,b){b=b||"yyyy-MM-dd";var c,g="",h=0,i="",j="",k=a.getYear()+"",l=a.getMonth()+1,m=a.getDate(),n=a.getDay(),o=a.getHours(),p=a.getMinutes(),q=a.getSeconds(),r={};for(k.length<4&&(k=""+(k-0+1900)),r.y=""+k,r.yyyy=k,r.yy=k.substring(2,4),r.M=l,r.MM=f(l),r.MMM=d[l-1],r.NNN=d[l+11],r.d=m,r.dd=f(m),r.E=e[n+7],r.EE=e[n],r.H=o,r.HH=f(o),r.h=0===o?12:o>12?o-12:o,r.hh=f(r.h),r.K=o>11?o-12:o,r.k=o+1,r.KK=f(r.K),r.kk=f(r.k),r.a=o>11?"PM":"AM",r.m=p,r.mm=f(p),r.s=q,r.ss=f(q);h<b.length;){for(i=b.charAt(h),j="";b.charAt(h)===i&&h<b.length;)j+=b.charAt(h++);g+=null!==r[j]&&r[j]!==c?r[j]:j}return g},distance:function(a,b,c){var d,e,g=0;if("y"===c)return d=h.format(a,"yyyy-MM-dd HH:mm:ss").split("-"),e=d[0]-0+b,h.stringToDate(e+"-"+d[1]+"-"+d[2],"yyyy-MM-dd HH:mm:ss");if("q"===c||"M"===c){"q"===c&&(b*=3);var i=b%12,j=(b-i)/12;d=h.format(a,"yyyy-MM-dd HH:mm:ss").split("-"),e=d[0]-0+j;var k=d[1]-0+i,l=d[2].split(" "),m=l[0];return 0>=k?(k+=12,e-=1):k>12&&(k-=12,e+=1),m=2===k?h.isLeap(e)?m>29?29:m:m>28?28:m:4===k||6===k||9===k||11===k?m>30?30:m:m>31?31:m,h.stringToDate(e+"-"+f(k)+"-"+m+" "+l[1],"yyyy-MM-dd HH:mm:ss")}return g="h"===c?36e5*b:"m"===c?6e4*b:"s"===c?1e3*b:"w"===c?6048e5*b:864e5*b,new Date(a.getTime()+g)}};c.exports=h}),define("dist/lib/cmp/calendar/calendar",["$","../../util/date","../overlay","../../util/dom/position","../../util/bom/browser","../../util/dom/iframe-shim","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","./date-panel","./month-panel","./year-panel","./time-panel","../../util/dom/wheel","./tpl/time","./tpl/calendar","./tpl/bar"],function(a,b,c){var d=a("$"),e=a("../../util/date"),f=a("../overlay"),g=a("./date-panel"),h=a("./month-panel"),i=a("./year-panel"),j=a("./time-panel"),k={calendar:a("./tpl/calendar"),bar:a("./tpl/bar")},l="yyyy-MM-dd",m={display:{clear:!0,ok:!0},text:{clear:"清除",ok:"确定"}},n={setDate:function(a){var b,c=function(a,b,c){return a===c?b:a},d=this.get("date");if(a.date){var f=a.date,g=l;this.times&&(f+=" "+this.times.output(),g+=" HH:mm:ss"),b=e.stringToDate(f,g)}else b=this.times?new Date(c(a.year,d.getFullYear()),c(a.month,d.getMonth()),d.getDate(),c(a.hour,this.times.get("hour")),c(a.minute,this.times.get("minute")),c(a.second,this.times.get("second"))):new Date(c(a.year,d.getFullYear()),c(a.month,d.getMonth()),d.getDate());return this.set("date",b),b},output:function(){var a=d(this.get("output")),b=a.val()||a.text();return b?e.stringToDate(b,this.get("format")):void 0}},o=f.extend({attrs:{date:{value:"",getter:function(a){return a||n.output.call(this)||new Date},setter:function(a){return a?"string"==typeof a&&(a=e.stringToDate(a,this.get("format"))||a):a=new Date,a}},trigger:null,triggerType:"click",output:{value:"",getter:function(a){return a=a?a:this.get("trigger"),d(a)}},mode:"dates",hideOnSelect:!0,time:!1,format:l,template:k.calendar.render(),align:{getter:function(){var a,b=d(this.get("trigger")),c=d(this.get("parentNode")),e=[0,0];return b&&b[0]?(a=b,e=[0,b.height()+10]):c&&c[0]&&(a=c),{selfXY:[0,0],baseElement:a,baseXY:e}}},bar:{display:!1,text:m.text},disabled:{date:function(){return!1},month:function(){return!1},year:function(){return!1}},i18n:{},view:"date"},events:{"click [data-role=current-month]":function(){this.renderContainer("months"===this.get("mode")?this.get("view")+"s":"months")},"click [data-role=current-year]":function(){this.renderContainer("years"===this.get("mode")?this.get("view")+"s":"years")},"click [data-role=prev-year]":function(){this.years.prev(),this.renderContainer(this.get("mode"))},"click [data-role=next-year]":function(){this.years.next(),this.renderContainer(this.get("mode"))},"click [data-role=prev-month]":function(){this.months.prev(),this.renderContainer(this.get("mode"))},"click [data-role=next-month]":function(){this.months.next(),this.renderContainer(this.get("mode"))},'click [data-role="btn-clear"]':function(){this.output(""),this.hide()},'click [data-role="btn-ok"]':function(){this.output(),this.hide()}},setup:function(){o.superclass.setup.call(this);var a=this,b=this.element.find("[data-role=container]"),c=this.get("date"),d=this.get("bar"),f=this.get("view"),p=f+"s";(function(a){if(a){if(this.get("format")===l)if(a===!0)this.set("time",{hour:!0,minute:!0}),this.set("format",l+" HH:mm");else{var b=[];a.hour=a.hour!==!1,a.minute=a.minute!==!1,a.second=a.second===!0,a.hour&&b.push("HH"),a.minute&&b.push("mm"),a.second&&b.push("ss"),this.set("format",l+" "+b.join(":"))}d.display=!0}}).call(this,this.get("time")),function(a){a===!0&&(this.set("bar",m),a=this.get("bar")),a.display===!0&&(a.display=m.display),a.display&&(this.set("hideOnSelect",!1),b.after(k.bar.render({bar:a})))}.call(this,d),function(a){this.get("format")===l&&("month"===a?this.set("format","yyyy-MM"):"year"===a&&this.set("format","yyyy")),"string"==typeof this.get("date")&&this.set("date",e.stringToDate(this.get("date"),this.get("format")))}.call(this,f),this._setPosition(),this.enable();var q=this.get("disabled");this.set("mode",p),this.dates=new g({date:c,week:this.get("i18n").week,weekStart:this.get("weekStart"),disabled:function(b){return q.date.call(a,b)||q.month.call(a,b)||q.year.call(a,b)},parentNode:b}).render(),this.months=new h({date:c,months:this.get("i18n").months,disabled:function(b){return q.month.call(a,b)||q.year.call(a,b)},parentNode:b}).render(),this.years=new i({date:c,prevPlaceholder:this.get("i18n").prevPlaceholder,nextPlaceholder:this.get("i18n").nextPlaceholder,disabled:function(b){return q.year.call(a,b)},parentNode:b}).render(),this.get("time")&&(this.times=new j({parentNode:b,display:this.get("time")}).render(),this.times.on("change",function(b,c,d){n.setDate.call(a,{hour:b,minute:c,second:d})})),this.dates.on("select",function(b,c,d){var e=n.setDate.call(a,{date:b});return a.renderPannel(),d&&(a.renderContainer(p),a.get("hideOnSelect")&&"dates"===p?a.output():a.trigger("selectDate",e)),!1}),this.months.on("select",function(b,c,d){var e=n.setDate.call(a,{year:b.getFullYear(),month:b.getMonth()});a.renderPannel(),d&&"set-month"===d.attr("data-role")&&(a.renderContainer(p),a.get("hideOnSelect")&&"months"===p?a.output():a.trigger("selectMonth",e))}),this.years.on("select",function(b,c,d){var e=n.setDate.call(a,{year:b.getFullYear()});a.renderPannel(),d&&"set-year"===d.attr("data-role")&&(a.renderContainer(p),a.get("hideOnSelect")&&"years"===p?a.output():a.trigger("selectYear",e))})},show:function(){this.rendered||this.render();var a=n.output.call(this)||this.get("date");return this.set("date",a),this.renderPannel(),this.renderContainer(this.get("mode")),o.superclass.show.call(this),this.trigger("show"),this},renderPannel:function(){var a=this.element.find("[data-role=current-month]"),b=this.element.find("[data-role=current-year]"),c=this.get("date"),d=c.getMonth(),e=c.getFullYear();a.text(this.months.get("months")[d]),b.text(e)},renderContainer:function(a){var b=this.$("[data-role=bar]"),c=this.get("date");return this.set("mode",a),this.dates.element.hide(),this.months.element.hide(),this.years.element.hide(),this.times&&this.times.element.hide(),b.hide(),this.dates.set("date",c),this.months.set("date",c),this.years.set("date",c),"dates"===a?(this.dates.show(),this.times&&this.times.show(),b.show()):"months"===a?this.months.show():"years"===a&&this.years.show(),this
},refresh:function(){return this.renderPannel(),this.renderContainer(this.get("mode")),this},enable:function(){var a=d(this.get("trigger"));if(a&&a[0]){var b=this,c=this.get("triggerType")+".calendar";a.on(c,function(a){b.show(),a.preventDefault()}),this._blurHide(this.get("trigger"))}},disable:function(){var a=d(this.get("trigger"));if(a&&a[0]){var b=this.get("triggerType")+".calendar";a.off(b)}},output:function(a,b){var c=this.get("output"),d=this.get("view");if(c.length){var f=c[0].tagName.toLowerCase();a=null===a||a===b?this.get("date"):a;var g=a.getDate?e.format(a,this.get("format")):a;c["input"===f||"textarea"===f?"val":"text"](g),this.get("hideOnSelect")&&this.hide(),this.trigger("select"+d.replace(/[a-z]/,function(a){return a.toUpperCase()}),"string"==typeof a?e.stringToDate(a)||"":a)}}});c.exports=o}),define("dist/lib/cmp/calendar/date-panel",["$","../../util/date","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render"],function(a,b,c){var d=a("$"),e=a("../../util/date"),f=a("../widget"),g={getMonthDayCount:function(a,b){var c=31;return 1==a?c=e.isLeap(b.getFullYear())?29:28:(3==a||5==a||8==a||10==a)&&(c=30),c}},h="yyyy-MM-dd",i=f.extend({attrs:{date:new Date,week:["一","二","三","四","五","六","日"],weekStart:1,showWeek:!1,format:h,disabled:function(){return!1}},events:{"click [data-role=set-date]":function(a){var b=d(a.target),c=e.format(this.get("date"),this.get("format")),f=b.attr("data-val");this.set("date",e.stringToDate(f,this.get("format"))),this.trigger("select",f,c,b)},"click .date-disabled":function(a){var b=d(a.target),c=e.format(this.get("date"),this.get("format")),f=b.attr("data-val");this.trigger("selectDisabled",f,c,b)}},prev:function(){var a=this.get("date"),b=e.distance(this.get("date"),-1);return this.set("date",b),this.trigger("select",b,a),this},next:function(){var a=this.get("date"),b=e.distance(this.get("date"),1);return this.set("date",b),this.trigger("select",b,a),this},show:function(){var a,b=this.get("date"),c=(this.get("week"),b.getMonth()),f=b.getDate(),h=[],i=[],j=[];for(a=0;7>a;a++){var k=this.get("weekStart")+a-1;k=k>=7?k-7:k,j[a]=k,i[a]=this.get("week")[k]}for(h.push('<tr class="widget-calendar-date-column">'),this.get("showWeek")&&h.push("<th></th>"),a=0;7>a;a++)h.push('<th class="widget-calendar-date widget-calendar-date-'+j[a]+'">'+i[a]+"</th>");h.push("</tr>");var l=new Date(b.getFullYear(),c,1),m=l.getDay(),n=d.inArray(m,j);n=0===n?7:n;var o=e.distance(l,-n+1),p=e.distance(l,g.getMonthDayCount(c,b)-1),q=p.getDay();n=d.inArray(q,j);var r=e.distance(p,7-n),s=[],t=((+r-o)/864e5+1)/7;for(a=0;t>a;a++){for(var u=['<tr class="widget-calendar-date-panel">'],v=0;7>v;v++){var w=e.distance(o,7*a+v),x=w.getMonth(),y=e.format(w,this.get("format")),z=w.getDate();u.push('<td data-val="'+y+'" '),this.get("disabled").call(this,w)===!0?(u.push('class="date-disabled '),u.push(x===c?"curr-month":c>x?"prev-month":"next-month")):(u.push('data-role="set-date"'),u.push(' class="'),x===c&&z===f&&u.push("curr-date "),u.push(x===c?"curr-month":c>x?"prev-month":"next-month")),u.push('">'+z+"</td>")}u.push("</tr>"),s[a]=u.join("")}return s.unshift(h.join("")),s.unshift('<table class="widget-calendar-date" data-role="date-panel">'),s.push("</table>"),this.element.html(s.join("")).show(),this}});c.exports=i}),define("dist/lib/cmp/calendar/month-panel",["$","../../util/date","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render"],function(a,b,c){var d=a("$"),e=a("../../util/date"),f=a("../widget"),g={patchZero:function(a){return 10>a?"0"+a:a}},h="yyyy-MM",i=f.extend({attrs:{date:new Date,months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],disabled:function(){return!1}},events:{"click [data-role=set-month]":function(a){var b=d(a.target),c=this.get("date"),f=e.stringToDate(b.attr("data-val"),h);this.set("date",f),this.trigger("select",f,c,b)},"click .month-disabled":function(a){var b=d(a.target),c=this.get("date"),f=e.stringToDate(b.attr("data-val"),h);this.trigger("selectDisabled",f,c,b)}},prev:function(){var a=this.get("date"),b=new Date(a.getFullYear(),a.getMonth()-1,1);return this.set("date",b),this.trigger("select",b,a),this},next:function(){var a=this.get("date"),b=new Date(a.getFullYear(),a.getMonth()+1,1);return this.set("date",b),this.trigger("select",b,a),this},show:function(){for(var a=this.get("date"),b=a.getFullYear(),c=a.getMonth(),d=this.get("months"),e=[],f=0,h=0;4>h;h++){for(var i=['<tr class="widget-calendar-month-column">'],j=f,k=f+3;k>j;j++,f++)i.push("<td "),this.get("disabled").call(this,new Date(b,f,1))===!0?i.push('class="month-disabled"'):(i.push('data-role="set-month"'),f===c&&i.push(' class="month-curr"')),i.push(' data-val="'+(b+"-"+g.patchZero(f+1))+'"'),i.push(">",d[f],"</td>");i.push("</tr>"),e[h]=i.join("")}return e.unshift('<table class="widget-calendar-month" data-role="month-panel">'),e.push("</table>"),this.element.html(e.join("")).show(),this}});c.exports=i}),define("dist/lib/cmp/calendar/year-panel",["$","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render"],function(a,b,c){var d=a("$"),e=a("../widget"),f={getDate:function(a){return new Date(+a,0,1)}},g=e.extend({attrs:{date:new Date,n:10,m:3,disabled:function(){return!1},prevPlaceholder:". . .",nextPlaceholder:". . ."},events:{"click [data-role=set-year]":function(a){var b=d(a.target),c=this.get("date"),e=f.getDate(b.attr("data-val"));this.set("date",e),this.trigger("select",e,c,b)},"click .year-disabled":function(a){var b=d(a.target),c=this.get("date"),e=f.getDate(b.attr("data-val"));this.trigger("selectDisabled",e,c,b)},"click [data-role=get-prev-page]":function(){var a=this.get("date"),b=f.getDate(a.getFullYear()-this.get("n"));this.set("date",b),this.show(),this.trigger("select",b,a)},"click [data-role=get-next-page]":function(){var a=this.get("date"),b=f.getDate(a.getFullYear()+this.get("n"));this.set("date",b),this.show(),this.trigger("select",b,a)}},prev:function(){var a=this.get("date"),b=f.getDate(a.getFullYear()-1);return this.set("date",b),this.trigger("select",b,a),this},next:function(){var a=this.get("date"),b=f.getDate(a.getFullYear()+1);return this.set("date",b),this.trigger("select",b,a),this},show:function(){for(var a=this.get("date").getFullYear(),b=this.get("n"),c=this.get("m"),d=Math.ceil((b+2)/c),e=a-a%b,g=[],h=0;b>h;h++)g[h]={role:"set-year",value:e+h,disabled:this.get("disabled").call(this,f.getDate(e+h))};g.unshift({role:"get-prev-page",value:this.get("prevPlaceholder")}),g.push({role:"get-next-page",value:this.get("nextPlaceholder")});var i=[],j=0;for(h=0;d>h;h++){for(var k=['<tr class="widget-calendar-year-column">'],l=j,m=Math.min(j+c,g.length);m>l;l++,j++){var n=g[j];k.push("<td "),n.disabled===!0?k.push('class="year-disabled"'):(k.push('data-role="'+n.role+'"'),n.value===a&&k.push(' class="year-curr"')),k.push(' data-val="'+n.value+'"'),k.push(">",n.value,"</td>")}k.push("</tr>"),i[h]=k.join("")}return i.unshift('<table class="widget-calendar-year" data-role="year-panel">'),i.push("</table>"),this.element.html(i.join("")).show(),this}});c.exports=g}),define("dist/lib/cmp/calendar/time-panel",["$","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","../../util/dom/wheel","../../util/bom/browser","./tpl/time"],function(a,b,c){var d=a("$"),e=a("../widget"),f=a("../../util/dom/wheel"),g=a("./tpl/time"),h={patchZero:function(a){return 10>a?"0"+a:a},change:function(a,b){var c=a.attr("data-input");b=+b,b=isNaN(b)?+d.trim(a.val())||0:b,"hour"===c?(b=(b+24)%24,this._change(b,this.get("minute"),this.get("second"))):(b=(b+60)%60,"minute"===c?this._change(this.get("hour"),b,this.get("second")):this._change(this.get("hour"),this.get("minute"),b)),a.val(h.patchZero(b))}},i=e.extend({attrs:{hour:(new Date).getHours(),minute:(new Date).getMinutes(),second:(new Date).getSeconds(),display:{hour:!0,minute:!0,second:!1}},events:{"click [data-action]":function(a){var b=d(a.target),c=/prev/.test(b.attr("data-action")),e=b.parent().find("[data-input]"),f=+d.trim(e.val())||0;f+=c?-1:1,h.change.call(this,e,f)},"blur [data-input]":function(a){var b=d(a.target);h.change.call(this,b)}},show:function(){var a=this;return this.element.html(g.render({hour:h.patchZero(this.get("hour")),minute:h.patchZero(this.get("minute")),second:h.patchZero(this.get("second")),display:this.get("display")})).show(),this.$("[data-input]").each(function(b,c){c=d(c),f(c,function(b,d,e){e(),"up"===d?h.change.call(a,c,a.get(c.attr("data-input"))+1):"down"===d&&h.change.call(a,c,a.get(c.attr("data-input"))-1),c.select()}),c.hover(function(){this.select()},function(){this.blur()})}),this},output:function(){return h.patchZero(this.get("hour"))+":"+h.patchZero(this.get("minute"))+":"+h.patchZero(this.get("second"))},_change:function(a,b,c){var d=!1,e=this.get("hour"),f=this.get("minute"),g=this.get("second");e!==a&&(this.set("hour",a),d=!0),f!==b&&(this.set("minute",b),d=!0),g!==c&&(this.set("second",c),d=!0),d&&this.trigger("change",a,b,c,e,f,g)}});c.exports=i}),define("dist/lib/cmp/calendar/tpl/time",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\'\');if(display.hour){_s.push(\' <div class="widget-calendar-time widget-calendar-hour"> <input type="text" value="\',hour,\'" data-input="hour"/> <span data-action="nextHour"> + </span> <span data-action="prevHour"> - </span> </div>\');}if(display.minute){_s.push(\' <div class="widget-calendar-time widget-calendar-minute"> <input type="text" value="\',minute,\'" data-input="minute"/> <span data-action="nextMinute"> + </span> <span data-action="prevMinute"> - </span> </div>\');}if(display.second){_s.push(\' <div class="widget-calendar-time widget-calendar-second"> <input type="text" value="\',second,\'" data-input="second"/> <span data-action="nextSecond"> + </span> <span data-action="prevSecond"> - </span> </div>\');} return _s;').apply(null,c).join("")}}}),define("dist/lib/cmp/calendar/tpl/calendar",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="widget-calendar"> <div class="widget-calendar-pannel" data-role="pannel"> <span class="widget-calendar-control" data-role="prev-year">&lt;&lt;</span> <span class="widget-calendar-control" data-role="prev-month">&lt;</span> <span class="widget-calendar-control month" data-role="current-month"></span> <span class="widget-calendar-control year" data-role="current-year"></span> <span class="widget-calendar-control" data-role="next-month">&gt;</span> <span class="widget-calendar-control" data-role="next-year">&gt;&gt;</span> </div> <div class="widget-calendar-container" data-role="container"> </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/lib/cmp/calendar/tpl/bar",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="widget-calendar-bar" data-role="bar">\');if(bar.display.clear){_s.push(\' <input class="btn" type="button" value="\',bar.text.clear,\'" data-role="btn-clear"/>\');}if(bar.display.ok){_s.push(\' <input class="btn" type="button" value="\',bar.text.ok,\'" data-role="btn-ok"/>\');}_s.push(\' </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/tpl/add-staff",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <form action="" id="addForm">  <div class="basic_info">  <h2>职员信息</h2>  <ul class="input_box">  <li class="ui-form-item">  <label for="username"><b>*</b>姓名</label>  <input type="text" name="username" id="username" />  </li>  <li class="ui-form-item">  <label for="sex"><b>*</b>性别</label>  <select name="sex" id="sex" style="margin-top: 6px;">  <option value="1">男</option>  <option value="2">女</option>  </select>  </li>  <li class="ui-form-item">  <label for="mobile"><b>*</b>手机</label>  <input type="text" name="mobile" id="mobile" />  </li>  <li class="ui-form-item">  <label for="mail">邮箱</label>  <input type="text" name="mail" id="mail" />  </li>  <li>  <label for="classW">部门</label>  <input type="text" name="classW" id="classW" class="gbox" />  <a href="javascript:;" data-action="selectDept" class="select_class">选择</a>  </li>  <li class="ui-form-item">  <label for="title">职务</label>  <input type="text" name="title" id="title" />  </li>  <li>  <label for="idcard1">证件号</label>  <select name="cardSelectBox" id="cardSelectBox">  <option value="1" selected="selected">身份证号</option>  <option value="2">其他证件号</option>  </select>  <input type="text" name="证件号" id="idcard1" />  </li>  <li class="ui-form-item">  <label for="joindate"><b>*</b>入司时间</label>  <input type="text" name="joindate" value="\',joindate,\'" readonly="true" id="joindate" />  </li>  <li>  <label for="birthday">生日</label>  <input type="text" name="birthday" disabled="disabled" readonly="true" id="birthday" />  </li>  <li>  <label for="seat">座位</label>  <input type="text" name="seat" id="seat" />  </li>  </ul>  </div>  <div class="footer">  <input type="button" data-action="nextAdd" value="确定" />  <input type="button" data-action="cancel" value="取消" />  </div> </form>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/checker",["$","../../../lib/cmp/validator/validator","../../../lib/cmp/validator/core","../../../lib/cmp/validator/async","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/validator/utils","../../../lib/cmp/validator/rule","../../../lib/cmp/validator/item"],function(a,b,c){var d=(a("$"),a("../../../lib/cmp/validator/validator")),e={init:function(a){var b=new d({element:a,failSilently:!0});return d.addRule("username",/^[\u4e00-\u9fa5a-zA-Z]{1}[\u4e00-\u9fa50-9a-zA-Z_]{1,}$/,"{{display}}的格式不正确,请以字母或汉字开头"),d.addRule("date",/^\d{4}-\d{2}-\d{2}$/,"{{display}}的格式不正确"),b.addItem({element:"#username",required:!0,rule:'maxlength{"max": 12} minlength{"min": 2} username'}).addItem({element:"#mobile",required:!0,rule:"mobile"}).addItem({element:"#mail",rule:"email"}).addItem({element:"#sex",required:!0}).addItem({element:"#joindate",required:!0,rule:"date"}),b},execute:function(a){var b=!1;return a.execute(function(a){b=!a}),b}};c.exports=e}),define("dist/lib/cmp/validator/validator",["./core","$","./async","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","./utils","./rule","./item"],function(a,b,c){var d=a("./core"),e=a("$"),f=d.extend({events:{"mouseenter .{{attrs.inputClass}}":"mouseenter","mouseleave .{{attrs.inputClass}}":"mouseleave","mouseenter .{{attrs.textareaClass}}":"mouseenter","mouseleave .{{attrs.textareaClass}}":"mouseleave","focus .{{attrs.itemClass}} input,textarea,select":"focus","blur .{{attrs.itemClass}} input,textarea,select":"blur"},attrs:{explainClass:"ui-form-explain",itemClass:"ui-form-item",itemHoverClass:"ui-form-item-hover",itemFocusClass:"ui-form-item-focus",itemErrorClass:"ui-form-item-error",inputClass:"ui-input",textareaClass:"ui-textarea",showMessage:function(a,b){this.getExplain(b).html(a),this.getItem(b).addClass(this.get("itemErrorClass"))},hideMessage:function(a,b){this.getExplain(b).html(b.attr("data-explain")||" "),this.getItem(b).removeClass(this.get("itemErrorClass"))}},setup:function(){f.superclass.setup.call(this);var a=this;this.on("autoFocus",function(b){a.set("autoFocusEle",b)})},addItem:function(a){f.superclass.addItem.apply(this,[].slice.call(arguments));var b=this.query(a.element);return b&&this._saveExplainMessage(b),this},_saveExplainMessage:function(a){var b=a.element,c=b.attr("data-explain");void 0!==c||this.getItem(b).hasClass(this.get("itemErrorClass"))||b.attr("data-explain",this.getExplain(b).html())},getExplain:function(a){var b=this.getItem(a),c=b.find("."+this.get("explainClass"));return 0==c.length&&(c=e('<div class="'+this.get("explainClass")+'"></div>').appendTo(b)),c},getItem:function(a){a=e(a);var b=a.parents("."+this.get("itemClass"));return b},mouseenter:function(a){this.getItem(a.target).addClass(this.get("itemHoverClass"))},mouseleave:function(a){this.getItem(a.target).removeClass(this.get("itemHoverClass"))},focus:function(a){var b=a.target,c=this.get("autoFocusEle");if(c&&c.has(b)){var d=this;return void e(b).keyup(function(){d.set("autoFocusEle",null),d.focus({target:b})})}this.getItem(b).removeClass(this.get("itemErrorClass")),this.getItem(b).addClass(this.get("itemFocusClass")),this.getExplain(b).html(e(b).attr("data-explain")||"")},blur:function(a){this.getItem(a.target).removeClass(this.get("itemFocusClass"))}});c.exports=f}),define("dist/lib/cmp/validator/core",["$","./async","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","./utils","./rule","./item"],function(a,b,c){function d(a,b){for(var c=0;c<b.length;c++)if(a===b[c])return b.splice(c,1),b}function e(a,b){var c;return f.each(b,function(b,d){return a.get(0)===d.element.get(0)?(c=d,!1):void 0}),c}var f=a("$"),g=a("./async"),h=a("../widget"),i=a("./utils"),j=a("./item"),k=[],l={value:f.noop,setter:function(a){return f.isFunction(a)?a:i.helper(a)}},m=h.extend({attrs:{triggerType:"blur",checkOnSubmit:!0,stopOnError:!1,autoSubmit:!0,checkNull:!0,onItemValidate:l,onItemValidated:l,onFormValidate:l,onFormValidated:l,displayHelper:function(a){var b,c,d=a.element.attr("id");return d&&(b=f("label[for="+d+"]").text(),b&&(b=b.replace(/^[\*\s\:\：]*/,"").replace(/[\*\s\:\：]*$/,""))),c=a.element.attr("name"),b||c},showMessage:l,hideMessage:l,autoFocus:!0,failSilently:!1,skipHidden:!1},setup:function(){var a=this;if(a.items=[],a.element.is("form")){a._novalidate_old=a.element.attr("novalidate");try{a.element.attr("novalidate","novalidate")}catch(b){}a.get("checkOnSubmit")&&a.element.on("submit.validator",function(b){b.preventDefault(),a.execute(function(b){!b&&a.get("autoSubmit")&&a.element.get(0).submit()})})}a.on("itemValidated",function(a,b,c,d){this.query(c).get(a?"showMessage":"hideMessage").call(this,b,c,d)}),k.push(a)},Statics:f.extend({helper:i.helper},a("./rule"),{autoRender:function(a){var b=new this(a);f("input, textarea, select",b.element).each(function(a,c){c=f(c);var d=c.attr("type");if("button"==d||"submit"==d||"reset"==d)return!0;var e={};if(e.element="radio"==d||"checkbox"==d?f("[type="+d+"][name="+c.attr("name")+"]",b.element):c,!b.query(e.element)){var g=i.parseDom(c);if(!g.rule)return!0;f.extend(e,g),b.addItem(e)}})},query:function(a){return h.query(a)},validate:function(a){var b=f(a.element),c=new m({element:b.parents()});c.addItem(a),c.query(b).execute(),c.destroy()}}),addItem:function(a){var b=this;if(f.isArray(a))return f.each(a,function(a,c){b.addItem(c)}),this;if(a=f.extend({triggerType:b.get("triggerType"),checkNull:b.get("checkNull"),displayHelper:b.get("displayHelper"),showMessage:b.get("showMessage"),hideMessage:b.get("hideMessage"),failSilently:b.get("failSilently"),skipHidden:b.get("skipHidden")},a),"string"==typeof a.element&&(a.element=this.$(a.element)),!f(a.element).length){if(a.failSilently)return b;throw new Error("element does not exist")}var c=new j(a);return b.items.push(c),c._validator=b,c.delegateEvents(c.get("triggerType"),function(a){(this.get("checkNull")||this.element.val())&&this.execute(null,{event:a})}),c.on("all",function(){this.trigger.apply(this,[].slice.call(arguments))},b),b},removeItem:function(a){var b=this,c=a instanceof j?a:b.query(a);return c&&(c.get("hideMessage").call(b,null,c.element),d(c,b.items),c.destroy()),b},execute:function(a){var b=this,c=[],d=!1,e=null;return f.each(b.items,function(a,c){c.get("hideMessage").call(b,null,c.element)}),b.trigger("formValidate",b.element),g[b.get("stopOnError")?"forEachSeries":"forEach"](b.items,function(a,f){a.execute(function(a,g,h){a&&!d&&(d=!0,e=h),c.push([].slice.call(arguments,0)),f(b.get("stopOnError")?a:null)})},function(){b.get("autoFocus")&&d&&(b.trigger("autoFocus",e),e.focus()),b.trigger("formValidated",d,c,b.element),a&&a(d,c,b.element)}),b},destroy:function(){var a=this,b=a.items.length;if(a.element.is("form")){try{void 0==a._novalidate_old?a.element.removeAttr("novalidate"):a.element.attr("novalidate",a._novalidate_old)}catch(c){}a.element.off("submit.validator")}for(var e=b-1;e>=0;e--)a.removeItem(a.items[e]);d(a,k),m.superclass.destroy.call(this)},query:function(a){return e(this.$(a),this.items)}});c.exports=m}),define("dist/lib/cmp/validator/async",[],function(a,b,c){var d={};c.exports=d;var e=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},f=function(a,b){if(a.map)return a.map(b);var c=[];return e(a,function(a,d,e){c.push(b(a,d,e))}),c},g=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};d.forEach=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0;e(a,function(e){b(e,function(b){b?(c(b),c=function(){}):(d+=1,d===a.length&&c(null))})})},d.forEachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d===a.length?c(null):e())})};e()};var h=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.forEach].concat(b))}},i=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.forEachSeries].concat(b))}},j=function(a,b,c,d){var e=[];b=f(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})};d.map=h(j),d.mapSeries=i(j),d.series=function(a,b){if(b=b||function(){},a.constructor===Array)d.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};d.forEachSeries(g(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}}}),define("dist/lib/cmp/validator/utils",["$","./rule"],function(require,exports,module){function unique(){return"__anonymous__"+u_count++}function parseRules(a){return a?a.match(/[a-zA-Z0-9\-\_]+(\{[^\{\}]*\})?/g):null}function parseDom(a){var a=$(a),b={},c=[],d=a.attr("required");d&&(c.push("required"),b.required=!0);var e=a.attr("type");if(e&&"submit"!=e&&"cancel"!=e&&"checkbox"!=e&&"radio"!=e&&"select"!=e&&"select-one"!=e&&"file"!=e&&"hidden"!=e&&"textarea"!=e){if(!Rule.getRule(e))throw new Error('Form field with type "'+e+'" not supported!');c.push(e)}var f=a.attr("min");f&&c.push('min{"min":"'+f+'"}');var g=a.attr("max");g&&c.push("max{max:"+g+"}");var h=a.attr("minlength");h&&c.push("minlength{min:"+h+"}");var i=a.attr("maxlength");i&&c.push("maxlength{max:"+i+"}");var j=a.attr("pattern");if(j){var k=new RegExp(j),l=unique();Rule.addRule(l,k),c.push(l)}var m=a.attr("data-rule");return m=m&&parseRules(m),m&&(c=c.concat(m)),b.rule=0==c.length?null:c.join(" "),b}function parseJSON(str){function getValue(str){return'"'==str.charAt(0)&&'"'==str.charAt(str.length-1)||"'"==str.charAt(0)&&"'"==str.charAt(str.length-1)?eval(str):str}if(!str)return null;var NOTICE='Invalid option object "'+str+'".';str=str.slice(1,-1);var result={},arr=str.split(",");return $.each(arr,function(a,b){if(arr[a]=$.trim(b),!arr[a])throw new Error(NOTICE);var c=arr[a].split(":"),d=$.trim(c[0]),e=$.trim(c[1]);if(!d||!e)throw new Error(NOTICE);result[getValue(d)]=$.trim(getValue(e))}),result}function isHidden(a){var b=a[0].offsetWidth,c=a[0].offsetHeight,d="TR"===a.prop("tagName");return 0!==b||0!==c||d?0===b||0===c||d?"none"===a.css("display"):!1:!0}var $=require("$"),Rule=require("./rule"),u_count=0,helpers={};module.exports={parseRule:function(a){var b=a.match(/([^{}:\s]*)(\{[^\{\}]*\})?/);return{name:b[1],param:parseJSON(b[2])}},parseRules:parseRules,parseDom:parseDom,isHidden:isHidden,helper:function(a,b){return b?(helpers[a]=b,this):helpers[a]}}}),define("dist/lib/cmp/validator/rule",["$"],function(a,b,c){function d(a,b){var c=this;if(c.name=a,b instanceof RegExp)c.operator=function(a,c){var d=b.test(j(a.element).val());c(d?null:a.rule,f(a,d))};else{if(!j.isFunction(b))throw new Error("The second argument must be a regexp or a function.");c.operator=function(a,c){var d=b.call(this,a,function(b,d){c(b?null:a.rule,d||f(a,b))});void 0!==d&&c(d?null:a.rule,f(a,d))}}}function e(a,b,c){return j.isPlainObject(a)?(j.each(a,function(a,b){j.isArray(b)?e(a,b[0],b[1]):e(a,b)}),this):(k[a]=b instanceof d?new d(a,b.operator):new d(a,b),g(a,c),this)}function f(a,b){var c,d=a.rule;return a.message?j.isPlainObject(a.message)?(c=a.message[b?"success":"failure"],"undefined"==typeof c&&(c=l[d][b?"success":"failure"])):c=b?"":a.message:c=l[d][b?"success":"failure"],c?i(a,c):c}function g(a,b){return j.isPlainObject(a)?(j.each(a,function(a,b){g(a,b)}),this):(l[a]=j.isPlainObject(b)?b:{failure:b},this)}function h(a,b){if(b){var c=k[a];return new d(null,function(a,d){c.operator(j.extend(null,a,b),d)})}return k[a]}function i(a,b){var c=b,d=/\{\{[^\{\}]*\}\}/g,e=/\{\{(.*)\}\}/,f=b.match(d);return f&&j.each(f,function(b,d){var f=d.match(e)[1],g=a[j.trim(f)];c=c.replace(d,g)}),c}var j=a("$"),k={},l={};d.prototype.and=function(a,b){var c=a instanceof d?a:h(a,b);if(!c)throw new Error('No rule with name "'+a+'" found.');var e=this,g=function(a,b){e.operator.call(this,a,function(d){d?b(d,f(a,!d)):c.operator.call(this,a,b)})};return new d(null,g)},d.prototype.or=function(a,b){var c=a instanceof d?a:h(a,b);if(!c)throw new Error('No rule with name "'+a+'" found.');var e=this,g=function(a,b){e.operator.call(this,a,function(d){d?c.operator.call(this,a,b):b(null,f(a,!0))})};return new d(null,g)},d.prototype.not=function(a){var b=h(this.name,a),c=function(a,c){b.operator.call(this,a,function(b){b?c(null,f(a,!0)):c(!0,f(a,!1))})};return new d(null,c)},e("required",function(a){var b=j(a.element),c=b.attr("type");switch(c){case"checkbox":case"radio":var d=!1;return b.each(function(a,b){return j(b).prop("checked")?(d=!0,!1):void 0}),d;default:return Boolean(j.trim(b.val()))}},"请输入{{display}}"),e("email",/^\s*([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,20})\s*$/,"{{display}}的格式不正确"),e("text",/.*/),e("password",/.*/),e("radio",/.*/),e("checkbox",/.*/),e("url",/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,"{{display}}的格式不正确"),e("number",/^[+-]?[1-9][0-9]*(\.[0-9]+)?([eE][+-][1-9][0-9]*)?$|^[+-]?0?\.[0-9]+([eE][+-][1-9][0-9]*)?$/,"{{display}}的格式不正确"),e("int",/^0$|^([1-9][0-9]{0,10})$/,"{{display}}不是有效的自然数"),e("pint",/^([1-9][0-9]{0,10})$/,"{{display}}不是有效的正整数"),e("digits",/^\s*\d+\s*$/,"{{display}}的格式不正确"),e("date",/^\d{4}\-[01]?\d\-[0-3]?\d$|^[01]\d\/[0-3]\d\/\d{4}$|^\d{4}年[01]?\d月[0-3]?\d[日号]$/,"{{display}}的格式不正确"),e("min",function(a){var b=a.element,c=a.min;return Number(b.val())>=Number(c)},"{{display}}必须大于或者等于{{min}}"),e("max",function(a){var b=a.element,c=a.max;return Number(b.val())<=Number(c)},"{{display}}必须小于或者等于{{max}}"),e("minlength",function(a){var b=a.element,c=b.val().length;return c>=Number(a.min)},"{{display}}的长度必须大于或等于{{min}}"),e("maxlength",function(a){var b=a.element,c=b.val().length;return c<=Number(a.max)},"{{display}}的长度必须小于或等于{{max}}"),e("mobile",/^1\d{10}$/,"请输入正确的{{display}}"),e("confirmation",function(a){var b=a.element,c=j(a.target);return b.val()==c.val()},"两次输入的{{display}}不一致，请重新输入"),c.exports={addRule:e,setMessage:g,getMessage:function(a,b){return f(a,b)},getRule:h,getOperator:function(a){return k[a].operator}}}),define("dist/lib/cmp/validator/item",["$","./utils","./rule","../widget","../../util/base","../../util/class","../../util/event","../../util/aspect","../../util/attribute","../daparser","../auto-render","./async"],function(a,b,c){function d(a){return(" "+a+" ").indexOf(" required ")>=0}function e(a,b,c){var d=h.extend({},a,{element:c.element,display:a&&a.display||c.get("display"),rule:b}),e=c.get("errormessage")||c.get("errormessage"+f(b));return e&&!d.message&&(d.message={failure:e}),d}function f(a){return a+="",a.charAt(0).toUpperCase()+a.slice(1)}function g(a,b,c){var d=a.element;if(!a.get("required")){var f=!1,g=d.attr("type");switch(g){case"checkbox":case"radio":var j=!1;d.each(function(a,b){return h(b).prop("checked")?(j=!0,!1):void 0}),f=j;break;default:f=!!d.val()}if(!f)return void(c&&c(null,null))}if(!h.isArray(b))throw new Error("No validation rule specified or not specified as an array.");var m=[];h.each(b,function(b,c){var d=i.parseRule(c),f=d.name,g=d.param,h=l.getOperator(f);if(!h)throw new Error('Validation rule with name "'+f+'" cannot be found.');var j=e(g,f,a);m.push(function(b){h.call(a._validator,j,b)})}),k.series(m,function(a,b){c&&c(a,b[b.length-1])})}var h=a("$"),i=a("./utils"),j=a("../widget"),k=a("./async"),l=a("./rule"),m={value:h.noop,setter:function(a){return h.isFunction(a)?a:i.helper(a)}},n=j.extend({attrs:{rule:{value:"",getter:function(a){return a=h.trim(a),this.get("required")?a&&d(a)||(a=h.trim("required "+a)):d(a)&&(a=h.trim((" "+a+" ").replace(" required "," "))),a}},display:null,displayHelper:null,triggerType:{getter:function(a){if(!a)return a;var b=this.element,c=b.attr("type"),d=b.is("select")||"radio"==c||"checkbox"==c;return d&&(a.indexOf("blur")>-1||a.indexOf("key")>-1)?"change":a}},required:{value:!1,getter:function(a){return h.isFunction(a)?a():a}},checkNull:!0,errormessage:null,onItemValidate:m,onItemValidated:m,showMessage:m,hideMessage:m},setup:function(){!this.get("display")&&h.isFunction(this.get("displayHelper"))&&this.set("display",this.get("displayHelper")(this))},execute:function(a,b){var c=this,d=!!c.element.attr("disabled");if(b=b||{},c.get("skipHidden")&&i.isHidden(c.element)||d)return a&&a(null,"",c.element),c;c.trigger("itemValidate",c.element,b.event);var e=i.parseRules(c.get("rule"));return e?g(c,e,function(d,e){c.trigger("itemValidated",d,e,c.element,b.event),a&&a(d,e,c.element)}):a&&a(null,"",c.element),c},getMessage:function(a,b,c){var d="",f=this,g=i.parseRules(f.get("rule"));return b=!!b,h.each(g,function(g,j){var k=i.parseRule(j),m=k.name,n=k.param;a===m&&(d=l.getMessage(h.extend(c||{},e(n,m,f)),b))}),d}});c.exports=n}),define("dist/app/common/dialog/idcard-done",["$","../action/action","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button","../../../lib/util/dom/action"],function(a,b,c){var d=a("$"),e=a("../action/action"),f={idcard:/^[1-9][0-9]{5}19[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/,othercard:/^[a-zA-Z0-9]{1,}/},g={format:"证件号的格式不正确",len:"证件号的长度"},h={attr:{idcardno:"",xcardno:""},idSelect:function(a){var b=this;a.change(function(){b.showRelObj(a)})},showRelObj:function(a){var b=a.val();a.parent().find("input").val("").attr("id","idcard"+b),d("#birthday").val("");var c=a.parent().find("input");this.inputBlur(c)},inputBlur:function(a){var b=this;a.blur(function(){var c=a.val(),e=[];b.validator(a,c);var f=a.attr("id").replace("idcard",""),g=b.getErrorMsg(+f,c);
switch(+f){case 1:""===g?(""!==c&&(e.push(c.substr(6,4),c.substr(10,2),c.substr(12,2)),d("#birthday").val(e.join("-")).attr("disabled",!0)),b.attr.idcardno=c,b.attr.xcardno=""):(b.attr.idcardno=c,b.attr.xcardno="");break;case 2:""===g?(d("#birthday").attr("disabled",!1),b.attr.idcardno="",b.attr.xcardno=c):(b.attr.idcardno="",b.attr.xcardno=c)}}),a.focus(function(){a.closest("li").removeClass("ui-form-item-error"),a.siblings("div").remove()})},getCardNumber:function(){return this.attr},getErrorMsg:function(a,b){switch(a){case 1:return 0===b.length?"":18!==b.length?g.len+"应该是18位":e.isCnNewID(b)?"":g.format;case 2:return 0===b.length?"":f.othercard.test(b)?"":g.format}},validator:function(a,b){a.closest("li").removeClass("ui-form-item-error"),a.closest("li").find("div").remove();var c=a.attr("id").replace("idcard",""),d=this.getErrorMsg(+c,b);return""!==d?(a.closest("li").addClass("ui-form-item-error"),a.closest("li").append('<div class="ui-form-explain">'+d+" </div>"),!1):!0}};c.exports=h}),define("dist/app/common/fresh",["$","./controller","./ajax","./_ajax","../../lib/util/event","../../lib/util/json","./dialog/singleton","../../lib/cmp/dialog/confirm-box","../../lib/cmp/dialog/dialog","../../lib/cmp/overlay","../../lib/util/dom/position","../../lib/util/bom/browser","../../lib/util/dom/iframe-shim","../../lib/cmp/widget","../../lib/util/base","../../lib/util/class","../../lib/util/aspect","../../lib/util/attribute","../../lib/cmp/daparser","../../lib/cmp/auto-render","../../lib/cmp/mask","../../lib/util/dom/sticky","../../lib/util/dom/scroll","../../lib/util/dom/wheel","../../lib/cmp/dialog/tpl/dialog","../../lib/cmp/dialog/tpl/button","../../lib/cmp/tree/ztree/ztree","../get-staff","../page","./pagenation","../../lib/cmp/pagination/pagination","../../lib/util/ajax","../tpl/staff-list","../ctrl-table","./action/action","../../lib/util/dom/action"],function(a,b,c){{var d=a("$");a("./controller")}a("../../lib/cmp/tree/ztree/ztree");var e=a("../get-staff"),f=(a("./action/action"),a("../page")),g={staffList:function(){if(d("#pagination div").remove(),d("#companyName").hasClass("curSelected"))f.request(1,!0,-1);else{Global.curA=d("#classTree a.curSelectedNode");var a=e.getSelectedNode(Global.curA,Global.treeObj).id;f.request(1,!0,a)}}};c.exports=g}),define("dist/app/common/dialog/edit-staff",["$","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/calendar/calendar","../../../lib/util/date","../../../lib/cmp/calendar/date-panel","../../../lib/cmp/calendar/month-panel","../../../lib/cmp/calendar/year-panel","../../../lib/cmp/calendar/time-panel","../../../lib/cmp/calendar/tpl/time","../../../lib/cmp/calendar/tpl/calendar","../../../lib/cmp/calendar/tpl/bar","../../../lib/util/dom/action","../controller","../ajax","../_ajax","../../../lib/util/json","./singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/tpl/button","./tpl/edit-staff","./tpl/select-dept","./tpl/reset-pwd","./checker","../../../lib/cmp/validator/validator","../../../lib/cmp/validator/core","../../../lib/cmp/validator/async","../../../lib/cmp/validator/utils","../../../lib/cmp/validator/rule","../../../lib/cmp/validator/item","./idcard-done","../action/action","../../get-staff","../../page","../pagenation","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../../tpl/staff-list","../../ctrl-table","../fresh","../../../lib/cmp/tree/ztree/ztree"],function(a){var b,c,d=a("$"),e=a("../../../lib/cmp/dialog/dialog"),f=a("../../../lib/cmp/calendar/calendar"),g=a("../../../lib/util/dom/action"),h=a("../controller"),i=a("./tpl/edit-staff"),j=a("./tpl/select-dept"),k=a("./tpl/reset-pwd"),l=a("./checker"),m=a("./idcard-done"),n=a("../../get-staff"),o=a("../action/action"),p=a("../fresh");g.listen({editStaff:function(){c=d(this).closest("tr").attr("name");var a=d(this).closest("tr").find("td").eq(3).text();h.orgManager.getSingleInfo(c,function(b){var g=new e({title:"编辑职员信息",repositionOnResize:!0,content:i.render({info:b,deptname:a}),width:850,height:650,fixed:!0,hasMask:{hideOnClick:!1}});g.show(),g.after("hide",function(){this.destroy()}),new f({zIndex:g.attrs.zIndex.value+1,fixed:!0,trigger:"#joindate"});var j=(new Date).getFullYear()-18;new f({zIndex:g.attrs.zIndex.value+1,fixed:!0,date:j-5+"-12-31",trigger:"#birthday",disabled:{date:function(a){return a.getFullYear()>j}}}),d("#sex option[value="+b.gender+"]").attr("selected",!0),d("#status option[value="+b.status+"]").attr("selected",!0),""===b.idcardno?d("#cardSelectBox option:last").attr("selected",!0):d("#cardSelectBox option:first").attr("selected",!0);var k=l.init(g.element.find("form")),n=d("#cardSelectBox");m.idSelect(n);var o=n.parent().find("input[id*=idcard]");m.inputBlur(o),g.element.find('input[data-action="nextEdit"]').click(function(){o.trigger("blur");var a=d("#username").val(),b=d("#sex").val(),e=d("#mobile").val(),f=d("#mail").val(),i=d("#classW").attr("title"),j=d("#title").val(),n=m.getCardNumber().idcardno,q=m.getCardNumber().xcardno,r=d("#joindate").val(),s=d("#birthday").val(),t=d("#seat").val(),u=d("#status").val(),v=""===n?m.validator(o,q):m.validator(o,n),w={user_id:c,name:a,gender:b,dept_id:i,title:j,mobile:e,email:f,idcardno:n,xcardno:q,birthday:s,joindate:r,seat:t,status:u};l.execute(k)&&v===!0&&h.staff.edit(w).done(function(){g.hide(),p.staffList()})}),g.element.find('input[data-action="cancel"]').click(function(){g.hide()})})},selectDept:function(){b||(b=new e({title:"选择部门",repositionOnResize:!0,content:j.render(),width:320,height:400,fixed:!0,hasMask:{hideOnClick:!0}})),b.show();var a={data:{simpleData:{enable:!0}}},c=d.fn.zTree.init(d("#selectDept"),a,Global.treeObj.getNodes());d("#selectDept a:first").addClass("curSelectedNode"),d("#selectDept").on("click",'a span[id*="span"]',function(){d("#selectDept a").removeClass("curSelectedNode"),d(this).parent().addClass("curSelectedNode");var a=d("#selectDept a.curSelectedNode");Global.plaintext=n.getParentText(a),Global.selId=n.getSelectedNode(a,c).id}),b.element.find('input[data-action="cancel"]').click(function(){b.hide()})},nextSC:function(){d("#addForm #classW").attr("title",Global.selId),d("#addForm #classW").val(Global.plaintext),b.hide()},resetPwd:function(a,b){var f=[],g="";if("rpwd"===d(b).attr("class")){for(var i=0,j=0,l=d("#dataList tr").length;l>j;j++)d("#dataList tr").eq(j).hasClass("current")&&(i++,f.push(d("#dataList tr").eq(j).attr("name")));if(0===i)return o.tipText("没有选中的职员"),!1;d.ajax({url:Global.req_url+"/org/getInitialpwd",async:!1,dataType:"json"}).done(function(a){g=a.password})}else f.push(c);var m=new e({title:"密码重置",repositionOnResize:!0,content:k.render({initialPwd:g}),width:470,height:270,fixed:!0,hasMask:{hideOnClick:!0}});m.show(),m.after("hide",function(){this.destroy()}),m.element.find('input[data-action="reset"]').click(function(){var a=d("#pwd").val();if(!/^\w{6,12}$/.test(a))return void d(".tip-error").show();d(".tip-error").hide();var b={uids:f,password:a};h.staff.resetPwd(b).done(function(){for(var a=0,b=d("#dataList tr").length;b>a;a++)d("#dataList tr").eq(a).removeClass("current"),d("#dataList tr").eq(a).find("input").prop("checked",!1);m.hide()})}),m.element.find('input[data-action="cancel"]').click(function(){m.hide()}),d("#showPwd").on("click",function(){d(this).prop("checked")?d("#pwd").attr("type","text"):d("#pwd").attr("type","password")})}})}),define("dist/app/common/dialog/tpl/edit-staff",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <form action="" id="addForm">  <div class="basic_info">  <h2>职员信息</h2>  <ul class="input_box">  <li class="ui-form-item">  <label for="username"><b>*</b>姓名</label>  <input type="text" value="\',info.name,\'" name="username" id="username" />  </li>  <li class="ui-form-item">  <label for="sex">性别</label>  <select name="sex" id="sex" style="margin-top: 6px;">  <option value="1">男</option>  <option value="2">女</option>  </select>  </li>  <li class="ui-form-item">  <label for="mobile"><b>*</b>手机</label>  <input type="text" value="\',info.mobile,\'" name="mobile" id="mobile" />  </li>  <li class="ui-form-item">  <label for="mail">邮箱</label>  <input type="text" value="\',info.email,\'" name="mail" id="mail" />  </li>  <li>  <label for="classW">部门</label>  <input type="text" value="\',deptname,\'" name="classW" id="classW" class="gbox" disabled />  <a href="javascript:;" data-action="selectDept" class="select_class">选择</a>  </li>  <li class="ui-form-item">  <label for="title">职务</label>  <input type="text" value="\',info.title,\'" name="title" id="title" />  </li>  <li>  <label for="idcard1"><b>*</b>证件号</label>  <select name="cardSelectBox" id="cardSelectBox">  <option value="1" selected="selected">身份证号</option>  <option value="2">其他证件号</option>  </select>\');if (info.idcardno === \'\'){_s.push(\'  <input type="text" value="\',info.xcardno,\'" name="证件号" id="idcard2" />\');}else{_s.push(\'  <input type="text" value="\',info.idcardno,\'" name="证件号" id="idcard1" />\');}_s.push(\'  </li>  <li class="ui-form-item">  <label for="joindate"><b>*</b>入司时间</label>  <input type="text" value="\',info.joindate,\'" name="joindate" readonly="true" id="joindate" />  </li>  <li>  <label for="birthday">生日</label>  <input type="text" disabled="disabled" readonly="true" name="birthday" id="birthday" value="\');if (info.birthday !== \'0000-00-00\'){_s.push(info.birthday);}_s.push(\' " />  </li>  <li>  <label for="seat">座位</label>  <input type="text" value="\',info.seat,\'" name="seat" id="seat" />  </li>  <li>  <label for="status">状态</label>  <select name="status" id="status" style="margin-top: 6px;">  <option value="0">禁用</option>  <option value="1">正常</option>  </select>  </li>  </ul>  </div>  <div class="footer">  <input type="button" data-action="nextEdit" value="确定" />  <input type="button" data-action="cancel" value="取消" />  </div> </form>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/tpl/select-dept",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <ul id="selectDept" class="ztree"></ul> <div class="sc_footer footer">  <input type="button" value="确定" data-action="nextSC">  <input type="button" value="取消" data-action="cancel"> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/tpl/reset-pwd",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="input_box">  <div>  <label for="pwd">重置密码</label>  <input type="password" value="\',initialPwd,\'" name="pwd" id="pwd" class="srbox" style="width: 160px;" />  <input type="checkbox" id="showPwd" style="width: auto;margin-left: 8px;" /> <span class="v">显示密码</span>  </div>  <div class="tip-error dn">密码必须6~12位</div> </div> <div class="footer" style="bottom: 43px;">  <input type="button" value="确定" data-action="reset">  <input type="button" value="取消" data-action="cancel"> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/common/dialog/del-staff",["$","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/cmp/dialog/tpl/button","../../../lib/util/dom/action","../controller","../ajax","../_ajax","../../../lib/util/json","./singleton","../fresh","../../../lib/cmp/tree/ztree/ztree","../../get-staff","../../page","../pagenation","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../../tpl/staff-list","../../ctrl-table","../action/action"],function(a){var b=a("$"),c=a("../../../lib/cmp/dialog/confirm-box"),d=a("../../../lib/util/dom/action"),e=a("../controller"),f=a("../fresh"),g=a("../action/action");d.listen({delStaff:function(a,d){var h=[];if("del"===d[0].className){for(var i=0,j=0,k=b("#dataList tr").length;k>j;j++)b("#dataList tr").eq(j).hasClass("current")&&(i++,h.push(b("#dataList tr").eq(j).attr("name")));if(0===i)return g.tipText("没有选中的职员"),!1}else h.push(b(this).closest("tr").attr("name"));var l=c.show({title:"删除职员",repositionOnResize:!0,content:'<p class="del_text">确定删除该职员信息吗？</p>',width:470,height:300,buttons:[{text:"确定",action:"send"},{text:"取消",action:"cancel"}],fixed:!0,hasMask:{hideOnClick:!0}}).on("send",function(){var a={uids:h};e.staff.del(a,function(){l.hide(),f.staffList()})}).on("cancel",function(){this.hide()})}})}),define("dist/app/common/dialog/xls-import",["$","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/util/dom/action","./tpl/ag_empl_import2","../../import/excelToJson","../../import/import","./tpl/import-list"],function(a){var b=a("$"),c=a("../../../lib/cmp/dialog/dialog"),d=a("../../../lib/util/dom/action"),e=a("./tpl/ag_empl_import2"),f=a("../../import/excelToJson"),g=a("../../import/import");d.listen({ipt:function(){var a=new c({title:"导入",repositionOnResize:!0,content:e.render({base_url:Global.base_url}),width:850,height:650,fixed:!1,hasMask:{hideOnClick:!0}});a.show(),a.after("hide",function(){this.destroy()}),a.element.find(".noBtn").click(function(){a.hide()}),f.initExcelFlash(Global.base_url+"/static/js/src/app/import/excelToJson.swf","","importBtn"),g.__init(Global.req_url+"/staff/import",function(a,b){return{record:a[b]}},5),b(".widget-dialog").on("click",".nav li",function(){b(this).addClass("current").siblings().removeClass("current"),b("#importMsg .cnt ul").eq(b(this).index()).show().siblings().hide()})}})}),define("dist/app/common/dialog/tpl/ag_empl_import2",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <div class="globalBody">  <div class="dtMainBody">  <div class="dtSmallBody">  <form id="importEmployee" action="\',base_url,\'/api/staff/import" method="post" name="importEmployee" enctype="multipart/form-data">  <div class="bigForm divContentTable">  <table width="100%">  <tr>  <td>  <h3 class="first">步骤一：准备职员信息</h3>  <p>使用模板文件录入信息。</p>  <p>为保证正确导入，请按照模板内的要求进行填写</p>  <div class="btn_area" style="margin-bottom: 30px;">  <a href="\',base_url,\'/static/excel/template.xls" class="btn">下载模板</a>  <p>若已准备好数据文件，请直接进行步骤二</p>  </div>  </td>  </tr>  <tr>  <td>  <h3>步骤二：上传数据文件</h3>  <p>点击下方按钮选择文件即可上传。目前支持类型为*.xls。</p>  <div class="btn_area">  <div id="importBtn" class="btn" style="width: auto;background: transparent;">选择文件</div>  <p id="fileLj"></p>  </div>  </td>  </tr>  <tr>  <td class="footer">  <span class="aBtn yesBtn"><input type="button" value="开始导入" onclick="startImport()"  /></span>  <span class="aBtn noBtn"><input type="button" value="取消" /></span>  </td>  </tr>  </table>  </div>  </form>  </div>  <div id="processContent" style="display: none;">  <div style="margin-bottom: 20px;">完成时间：<span id="importResultTime"></span></div>  <div class="process ovh">  <div class="gc">完成：<strong>0%</strong></div>  <div id="processBar" class="ovh">  <div id="curProcess"></div>  </div>  </div>  </div>  <div id="importResult" style="display: none; padding: 20px 20px 20px 50px;">  <div>共读取<span class="" id="processData"></span>条记录，其中：成功<span id="importSuccNum"></span>条，失败<span id="importFailNum" style="color: red;"></span>条</div>  <div id="importMsg">  <div class="nav_box">  <ul class="nav">  <li>全部</li>  <li class="current">失败</li>  <li>成功</li>  </ul>  </div>  <div class="cnt">  <ul id="allList" class="dn"></ul>  <ul id="errList"></ul>  <ul id="successList" class="dn"></ul>  </div>  </div>  <div id="showExport">  <p class="cp dn" onclick="exportErrorData()">将日志保存到本地</p>  <div class="footer">  <span class="aBtn noBtn"><input type="button" value="确定" /></span>  </div>  </div>  </div>  <div id="timeout">  <div>抱歉，由于网络问题导入未成功</div>  <div class="footer">  <span class="aBtn yesBtn"><input type="button" value="重新导入" onclick="startImport()" /></span>  <span class="aBtn noBtn"><input type="button" value="取消" /></span>  </div>  </div>  </div> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/import/excelToJson",[],function(a,b,c){var d={};d.initExcelFlash=function(a,b,c){_excelGetParam=b;var d=DetectFlashVer(10,0,0);if(d)AC_FL_RunContent("src",a.replace(".swf",""),"container",c,"width","300","height","22","align","middle","id","excelFlash_2012","quality","high","bgcolor","#ffffff","name","excelFlash_2012","allowScriptAccess","sameDomain","type","application/x-shockwave-flash","pluginspage","http://www.adobe.com/go/getflashplayer");else{var e="需要flash player10.0及以上版本，<a href=http://www.adobe.com/go/getflash/>点击升级Flash播放器</a>";c?document.getElementById(c).innerHTML=e:document.write(e)}},c.exports=d});var _excelGetParam="id,name,count",isIE=-1!=navigator.appVersion.indexOf("MSIE")?!0:!1,isWin=-1!=navigator.appVersion.toLowerCase().indexOf("win")?!0:!1,isOpera=-1!=navigator.userAgent.indexOf("Opera")?!0:!1;define("dist/app/import/import",["$","../common/dialog/tpl/import-list"],function(require,exports,module){var $=require("$"),ImportList=require("../common/dialog/tpl/import-list"),ImportXsl={SUCCESS_NUM:0,FAIL_NUM:0,START_INDEX:2,CURR_INDEX:2,LIST_DATA:null,ERROR_DATA:[null,null],_CALLBACK:null,_URL:"",_ACTIVE:!0,__init:function(a,b,c){var d=this;d._CALLBACK=b,d._URL=a,"undefined"!=typeof c&&(d.START_INDEX=c),window.onbeforeunload=function(a){if(""!=$("#process").html()){if(a=a||window.event,!a)return"切换、刷新或关闭页面将终止导入功能！";var b=$(window.document.activeElement).html();b.replace("模板")==b&&(a.returnValue="切换、刷新或关闭页面将终止导入功能！")}},window.excelToJson=function(a){return d.SUCCESS_NUM=0,d.FAIL_NUM=0,d.CURR_INDEX=d.START_INDEX,d.LIST_DATA=a,d.ERROR_DATA=[],d._ACTIVE&&d.LIST_DATA.length<=2?void alert("Excel文件格式读取失败，请检查文件后重试。"):void 0},window.startImport=function(){return d.LIST_DATA&&d.LIST_DATA.length?d.LIST_DATA.length<=d.START_INDEX?void alert("Excel文件没有可导入数据，请检查文件后重试。"):($(".dtSmallBody").hide(),$("#timeout").hide(),$("#importResult").show(),$("#processContent").show(),void d.sendExcelList(d.CURR_INDEX,d.LIST_DATA)):void alert("请点击“选择文件”上传文件")},window.exportErrorData=function(){var a=$("#exportForm");if(a.length)a.find(":hidden").attr("value",JSON.stringify(d.ERROR_DATA));else{a=$("<form>"),a.attr("id","exportForm"),a.attr("style","display:none"),a.attr("method","post"),a.attr("action",Global.req_url+"/staff/import/error");var b=$("<input>");b.attr("type","hidden"),b.attr("name","content"),b.attr("value",JSON.stringify(d.ERROR_DATA)),$("body").append(a),a.append(b)}a.submit()},window.excelToJsonError=function(){d._ACTIVE=!1,alert("Excel文件格式读取失败，请检查文件后重试。")},window.excelToJsonStart=function(){$("#pocess").html("正在读取数据文件..")}},getCurrTime:function(){var a=new Date;return a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()},sendExcelList:function(i,list){var me=this;me.CURR_INDEX=i+1;var beforeDataObj=me._CALLBACK(me.LIST_DATA,i).record,data={deptname:beforeDataObj[0],username:beforeDataObj[2],workid:beforeDataObj[1],joindate:beforeDataObj[3],mobilephone:beforeDataObj[5]||"",email:beforeDataObj[6]||"",cardno:beforeDataObj[7],gender:beforeDataObj[4]};$.ajax({url:me._URL,type:"POST",dataType:"json",data:data,timeout:3e4,success:function(a){me.dealBackData(i,"success",a)},error:function(XMLHttpRequest,textStatus,errorThrown){try{if("timeout"==textStatus)i==me.START_INDEX?(me.CURR_INDEX--,$(".dtSmallBody").hide(),$("#processContent").hide(),$("#importResult").hide(),$("#timeout").show()):me.dealBackData(i,"timeout","导入超时！");else{var data=eval("("+XMLHttpRequest.responseText+")");me.dealBackData(i,"error",data,data.stop)}}catch(e){i==me.START_INDEX?(me.CURR_INDEX--,$(".dtSmallBody").hide(),$("#processContent").hide(),$("#importResult").hide(),$("#timeout").show()):me.dealBackData(i,"error","服务器异常！")}data&&data.errMsg&&(me.LIST_DATA[i].msg=data.errMsg,me.ERROR_DATA.push(data))},complete:function(XMLHttpRequest,throwError){var data=eval("("+XMLHttpRequest.responseText+")");if("object"==typeof data){if(200==data.code)$("#allList").append(ImportList.render({msglist:data.data,type:data.msg}));else{var errArr=[];for(var j in data.errMsg)errArr.push(data.errMsg[j]);var errmsg=errArr.join("、");$("#allList").append(ImportList.render({msglist:data,type:data.errMsg,errmsg:errmsg}))}(i==list.length-1||list.length===me.START_INDEX)&&($(".dtSmallBody").hide(),$("#timeout").hide(),$("#importResult").show(),$("#importResultTime").text((new Date).toLocaleString()),$("#importSuccNum").text(me.SUCCESS_NUM),$("#importFailNum").text(me.FAIL_NUM),me.FAIL_NUM>0?$("#showExport p").show():($("#showExport p").hide(),$("#errList").append('<li class="err">恭喜您，全部导入成功！</li>')))}else $("#allList").append('<li class="err">服务器出错！</li>')}})},dealBackData:function(a,b,c,d){var e=this,f="";switch(b){case"error":var g=[];for(var h in c.errMsg)g.push(c.errMsg[h]);var i=g.join("、");f="red",$("#errList").append(ImportList.render({msglist:c,type:c.errMsg,errmsg:i})),e.FAIL_NUM++,$("#importFailNum").text(e.FAIL_NUM);break;case"timeout":var g=[];for(var h in c.errMsg)g.push(c.errMsg[h]);var i=g.join("、");f="red",$("#errList").append(ImportList.render({msglist:c,type:c.errMsg,errmsg:i})),f="red",e.FAIL_NUM++,$("#importFailNum").text(e.FAIL_NUM);break;case"success":f="green",$("#successList").append(ImportList.render({msglist:c.data,type:c.msg})),e.SUCCESS_NUM++,$("#importSuccNum").text(e.SUCCESS_NUM);break;case"empty":f="red",e.FAIL_NUM++,$("#importFailNum").text(e.FAIL_NUM)}$("#processData").html(e.LIST_DATA.length-e.START_INDEX),$(".gc strong").html(Math.ceil(100*((a-(e.START_INDEX-1))/(e.LIST_DATA.length-e.START_INDEX)))+"%"),$("#curProcess").width($("#processBar").width()*((a-(e.START_INDEX-1))/(e.LIST_DATA.length-e.START_INDEX))),a<e.LIST_DATA.length-1&&!d&&e.sendExcelList(++a,e.LIST_DATA)}};module.exports=ImportXsl}),define("dist/app/common/dialog/tpl/import-list",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,"var _s=[];_s.push('');if (typeof type == 'object'){_s.push(' <li class=\"err\">  <span>',msglist.workid,'</span>  <span>',msglist.username,'</span>  <span>',msglist.joindate,'</span>  <span>',msglist.mobilephone,'</span>  <span>',msglist.cardno,'</span>  <span>FALSE（',errmsg,'）!</span> </li>');}else{_s.push(' <li>  <span>',msglist.workid,'</span>  <span>',msglist.username,'</span>  <span>',msglist.joindate,'</span>  <span>',msglist.mobilephone,'</span>  <span>',msglist.cardno,'</span>  <span>',type,'</span> </li>');} return _s;").apply(null,c).join("")}}}),define("dist/app/common/dialog/xls-outport",["$","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/util/dom/action","../../get-staff","../../page","../pagenation","../../../lib/cmp/pagination/pagination","../../../lib/util/ajax","../ajax","../_ajax","../../../lib/util/json","./singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/tpl/button","../../tpl/staff-list","../../ctrl-table","./tpl/xls-outport"],function(a){var b,c,d=a("$"),e=a("../../../lib/cmp/dialog/dialog"),f=a("../../../lib/util/dom/action"),g=a("../../get-staff"),h=a("./tpl/xls-outport");f.listen({opt:function(){b||(b=new e({title:"导出",repositionOnResize:!0,content:h.render(),width:400,height:450,fixed:!1,hasMask:{hideOnClick:!0}})),b.show();var a={data:{simpleData:{enable:!0}}},f=d.fn.zTree.init(d("#outputTree"),a,Global.treeObj.getNodes());d("#outputTree a:first").addClass("curSelectedNode"),d("#outputTree").on("click",'a span[id*="span"]',function(){d("#outputTree a").removeClass("curSelectedNode"),d(this).parent().addClass("curSelectedNode")}),b.element.find('a[data-action="startOutport"]').click(function(){var a=d("#outputTree a.curSelectedNode");c=g.getSelectedNode(a,f).id,d(this).attr("href",Global.req_url+"/staff/export?dept_id="+c),b.hide()}),b.element.find('input[data-action="cancel"]').click(function(){b.hide()})}})}),define("dist/app/common/dialog/tpl/xls-outport",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <p class="sdata">请选择要导出的数据目录：</p> <ul id="outputTree" class="ztree"></ul> <div class="sc_footer footer">  <a href="javascript:;" data-action="startOutport" class="exportBtn">开始导出</a>  <input type="button" value="取消" data-action="cancel" /> </div>\'); return _s;').apply(null,c).join("")}}}),define("dist/app/search",["$","../lib/util/dom/action","./page","./common/pagenation","../lib/cmp/pagination/pagination","../lib/cmp/widget","../lib/util/base","../lib/util/class","../lib/util/event","../lib/util/aspect","../lib/util/attribute","../lib/cmp/daparser","../lib/cmp/auto-render","../lib/util/ajax","./common/ajax","./common/_ajax","../lib/util/json","./common/dialog/singleton","../lib/cmp/dialog/confirm-box","../lib/cmp/dialog/dialog","../lib/cmp/overlay","../lib/util/dom/position","../lib/util/bom/browser","../lib/util/dom/iframe-shim","../lib/cmp/mask","../lib/util/dom/sticky","../lib/util/dom/scroll","../lib/util/dom/wheel","../lib/cmp/dialog/tpl/dialog","../lib/cmp/dialog/tpl/button","./tpl/staff-list","./ctrl-table"],function(a){var b=a("$"),c=a("../lib/util/dom/action"),d=a("./page");c.listen({searchBtn:function(){var a=b("#searchText").val();return""===a||/^\s+$/.test(a)?!1:(b("#pagination").empty(),d.requestSearch(1,!0,encodeURI(a)),void b("#searchText").val(""))}}),b("body").on("keydown",function(a){13==a.keyCode&&b(".search_btn").click()})}),define("dist/app/common/dialog/set-pwd",["$","../../../lib/cmp/dialog/dialog","../../../lib/cmp/overlay","../../../lib/util/dom/position","../../../lib/util/bom/browser","../../../lib/util/dom/iframe-shim","../../../lib/cmp/widget","../../../lib/util/base","../../../lib/util/class","../../../lib/util/event","../../../lib/util/aspect","../../../lib/util/attribute","../../../lib/cmp/daparser","../../../lib/cmp/auto-render","../../../lib/cmp/mask","../../../lib/util/dom/sticky","../../../lib/util/dom/scroll","../../../lib/util/dom/wheel","../../../lib/cmp/dialog/tpl/dialog","../../../lib/util/dom/action","./tpl/set-pwd","../controller","../ajax","../_ajax","../../../lib/util/json","./singleton","../../../lib/cmp/dialog/confirm-box","../../../lib/cmp/dialog/tpl/button","../action/action"],function(a){var b=a("$"),c=a("../../../lib/cmp/dialog/dialog"),d=a("../../../lib/util/dom/action"),e=a("./tpl/set-pwd"),f=a("../controller"),g=a("../action/action");b(function(){d.listen({setPwd:function(){var a="";b.ajax({url:Global.req_url+"/org/getInitialpwd?type=0",async:!1,dataType:"json"}).done(function(b){a=b.password});var d=new c({title:"默认密码配置",repositionOnResize:!0,content:e.render(),width:650,height:350,fixed:!0,hasMask:{hideOnClick:!0}});d.show(),d.after("hide",function(){this.destroy()});var h=b('input[type="radio"]');""==+a||1==+a?h.eq(0).prop("checked",!0):-1==+a?h.eq(1).prop("checked",!0):-2==+a?h.eq(2).prop("checked",!0):(h.eq(3).prop("checked",!0),b("#pwd").val(a)),d.element.find('button[data-action="save"]').click(function(){var a={type:b('input[name="setpwd"]:checked').val(),password:b('input[name="pwd"]').val()};return 0==a.type&&""==b.trim(a.password)?void g.tipText("密码必须为6~12字符"):void f.staff.setStaffPwd(a).done(function(){d.hide()})}),d.element.find('input[data-action="cancel"]').click(function(){d.hide()}),b("#showPwd").on("click",function(){b(this).prop("checked")?b("#pwd").attr("type","text"):b("#pwd").attr("type","password")})}})})}),define("dist/app/common/dialog/tpl/set-pwd",[],function(){return{render:function(a){var b=[],c=[];for(var d in a)b.push(d),c.push(a[d]);return new Function(b,'var _s=[];_s.push(\' <ul id="setPwdBox">  <li>  <input type="radio" value="1" name="setpwd" id="randomPwd" /><label for="randomPwd">随机密码</label>  </li>  <li>  <input type="radio" value="-1" name="setpwd" id="birthdayPwd" /><label for="birthdayPwd">身份证上的8位出生年月日</label>  </li>  <li>  <input type="radio" value="-2" name="setpwd" id="idcardLastSixthPwd" /><label for="idcardLastSixthPwd">身份证上的后6位数</label>  </li>  <li>  <input type="radio" value="0" name="setpwd" id="fixedPwd" /><label for="fixedPwd">固定密码</label>  <input type="password" name="pwd" id="pwd" />  <input type="checkbox" name="show_pwd" id="showPwd" /><label for="showPwd">显示密码</label>  </li>  <li class="footer">  <button type="button" name="save" data-action="save">保存</button>  <input type="button" data-action="cancel" value="取消" />  </li> </ul>\'); return _s;').apply(null,c).join("")}}});